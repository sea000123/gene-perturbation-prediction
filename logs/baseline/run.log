2025-12-11 01:08:32,924 - ZeroShotPerturbation - INFO - Starting Perturbation Pipeline with baseline model
2025-12-11 01:08:32,924 - ZeroShotPerturbation - INFO - Model directory: model/scGPT
2025-12-11 01:08:32,924 - ZeroShotPerturbation - INFO - Results will be saved to: results/baseline
2025-12-11 01:08:32,924 - ZeroShotPerturbation - INFO - Initializing Baseline Model Wrapper...
2025-12-11 01:08:33,073 - ZeroShotPerturbation - INFO - Loaded vocab from model/scGPT/vocab.json
2025-12-11 01:08:33,073 - ZeroShotPerturbation - INFO - Initializing Data Loader...
2025-12-11 01:08:33,073 - ZeroShotPerturbation - INFO - Loading training data from data/processed/train.h5ad
2025-12-11 01:08:47,677 - ZeroShotPerturbation - INFO - Loading test data from data/processed/test.h5ad
2025-12-11 01:08:50,381 - ZeroShotPerturbation - INFO - Found 38176 control cells.
2025-12-11 01:08:50,381 - ZeroShotPerturbation - INFO - Fitting baseline model on training data...
2025-12-11 01:08:50,381 - ZeroShotPerturbation - INFO - Fitting baseline from AnnData: computing mean perturbed expression...
2025-12-11 01:09:13,830 - ZeroShotPerturbation - INFO - Baseline fitted: mean expression computed from 153002 perturbed samples, 18080 genes
2025-12-11 01:09:22,164 - ZeroShotPerturbation - INFO - Processing 30 target genes...
2025-12-11 01:09:22,165 - ZeroShotPerturbation - INFO - Predicting for target: AKT2
2025-12-11 01:09:22,169 - ZeroShotPerturbation - INFO - Processing 938 cells in batches of 16
2025-12-11 01:10:06,476 - ZeroShotPerturbation - INFO - Target AKT2 - DES: 0.0991, MAE_top2k: 0.0631, n_DE: 343
2025-12-11 01:10:06,477 - ZeroShotPerturbation - INFO - Predicting for target: MAP3K7
2025-12-11 01:10:06,479 - ZeroShotPerturbation - INFO - Processing 2019 cells in batches of 16
2025-12-11 01:11:09,792 - ZeroShotPerturbation - INFO - Target MAP3K7 - DES: 0.0702, MAE_top2k: 0.0356, n_DE: 114
2025-12-11 01:11:09,792 - ZeroShotPerturbation - INFO - Predicting for target: ZNF426
2025-12-11 01:11:09,795 - ZeroShotPerturbation - INFO - Processing 1132 cells in batches of 16
2025-12-11 01:11:57,541 - ZeroShotPerturbation - INFO - Target ZNF426 - DES: 0.0000, MAE_top2k: 0.0284, n_DE: 15
2025-12-11 01:11:57,542 - ZeroShotPerturbation - INFO - Predicting for target: DNMT1
2025-12-11 01:11:57,545 - ZeroShotPerturbation - INFO - Processing 893 cells in batches of 16
2025-12-11 01:12:44,409 - ZeroShotPerturbation - INFO - Target DNMT1 - DES: 0.5816, MAE_top2k: 0.2786, n_DE: 8262
2025-12-11 01:12:44,410 - ZeroShotPerturbation - INFO - Predicting for target: SRC
2025-12-11 01:12:44,415 - ZeroShotPerturbation - INFO - Processing 2403 cells in batches of 16
2025-12-11 01:13:54,715 - ZeroShotPerturbation - INFO - Target SRC - DES: 0.1943, MAE_top2k: 0.0275, n_DE: 211
2025-12-11 01:13:54,716 - ZeroShotPerturbation - INFO - Predicting for target: MED13
2025-12-11 01:13:54,720 - ZeroShotPerturbation - INFO - Processing 2787 cells in batches of 16
2025-12-11 01:15:14,058 - ZeroShotPerturbation - INFO - Target MED13 - DES: 0.4472, MAE_top2k: 0.0838, n_DE: 4334
2025-12-11 01:15:14,058 - ZeroShotPerturbation - INFO - Predicting for target: KDR
2025-12-11 01:15:14,063 - ZeroShotPerturbation - INFO - Processing 2056 cells in batches of 16
2025-12-11 01:16:21,554 - ZeroShotPerturbation - INFO - Target KDR - DES: 0.0000, MAE_top2k: 0.0329, n_DE: 19
2025-12-11 01:16:21,554 - ZeroShotPerturbation - INFO - Predicting for target: EIF4B
2025-12-11 01:16:21,558 - ZeroShotPerturbation - INFO - Processing 1585 cells in batches of 16
2025-12-11 01:17:18,842 - ZeroShotPerturbation - INFO - Target EIF4B - DES: 0.3704, MAE_top2k: 0.1126, n_DE: 4123
2025-12-11 01:17:18,842 - ZeroShotPerturbation - INFO - Predicting for target: SIX4
2025-12-11 01:17:18,846 - ZeroShotPerturbation - INFO - Processing 642 cells in batches of 16
2025-12-11 01:17:58,975 - ZeroShotPerturbation - INFO - Target SIX4 - DES: 0.0875, MAE_top2k: 0.0535, n_DE: 80
2025-12-11 01:17:58,975 - ZeroShotPerturbation - INFO - Predicting for target: TFAM
2025-12-11 01:17:58,978 - ZeroShotPerturbation - INFO - Processing 1105 cells in batches of 16
2025-12-11 01:18:47,647 - ZeroShotPerturbation - INFO - Target TFAM - DES: 0.5710, MAE_top2k: 0.1084, n_DE: 4779
2025-12-11 01:18:47,648 - ZeroShotPerturbation - INFO - Predicting for target: MAST2
2025-12-11 01:18:47,650 - ZeroShotPerturbation - INFO - Processing 1029 cells in batches of 16
2025-12-11 01:19:34,102 - ZeroShotPerturbation - INFO - Target MAST2 - DES: 0.0000, MAE_top2k: 0.0384, n_DE: 22
2025-12-11 01:19:34,103 - ZeroShotPerturbation - INFO - Predicting for target: SMAGP
2025-12-11 01:19:34,106 - ZeroShotPerturbation - INFO - Processing 788 cells in batches of 16
2025-12-11 01:20:16,267 - ZeroShotPerturbation - INFO - Target SMAGP - DES: 0.2164, MAE_top2k: 0.0809, n_DE: 795
2025-12-11 01:20:16,268 - ZeroShotPerturbation - INFO - Predicting for target: XRCC4
2025-12-11 01:20:16,271 - ZeroShotPerturbation - INFO - Processing 591 cells in batches of 16
2025-12-11 01:20:54,971 - ZeroShotPerturbation - INFO - Target XRCC4 - DES: 0.5369, MAE_top2k: 0.0899, n_DE: 2930
2025-12-11 01:20:54,971 - ZeroShotPerturbation - INFO - Predicting for target: HMGN1
2025-12-11 01:20:54,974 - ZeroShotPerturbation - INFO - Processing 2004 cells in batches of 16
2025-12-11 01:21:57,990 - ZeroShotPerturbation - INFO - Target HMGN1 - DES: 0.0000, MAE_top2k: 0.0334, n_DE: 16
2025-12-11 01:21:57,991 - ZeroShotPerturbation - INFO - Predicting for target: GSK3B
2025-12-11 01:21:57,994 - ZeroShotPerturbation - INFO - Processing 1059 cells in batches of 16
2025-12-11 01:22:44,249 - ZeroShotPerturbation - INFO - Target GSK3B - DES: 0.2473, MAE_top2k: 0.1114, n_DE: 2127
2025-12-11 01:22:44,250 - ZeroShotPerturbation - INFO - Predicting for target: TMBIM6
2025-12-11 01:22:44,254 - ZeroShotPerturbation - INFO - Processing 505 cells in batches of 16
2025-12-11 01:23:20,943 - ZeroShotPerturbation - INFO - Target TMBIM6 - DES: 0.0000, MAE_top2k: 0.0668, n_DE: 35
2025-12-11 01:23:20,944 - ZeroShotPerturbation - INFO - Predicting for target: PMEL
2025-12-11 01:23:20,948 - ZeroShotPerturbation - INFO - Processing 356 cells in batches of 16
2025-12-11 01:23:55,532 - ZeroShotPerturbation - INFO - Target PMEL - DES: 0.0333, MAE_top2k: 0.0805, n_DE: 30
2025-12-11 01:23:55,532 - ZeroShotPerturbation - INFO - Predicting for target: DAXX
2025-12-11 01:23:55,535 - ZeroShotPerturbation - INFO - Processing 1332 cells in batches of 16
2025-12-11 01:24:46,895 - ZeroShotPerturbation - INFO - Target DAXX - DES: 0.1627, MAE_top2k: 0.0563, n_DE: 756
2025-12-11 01:24:46,895 - ZeroShotPerturbation - INFO - Predicting for target: METTL14
2025-12-11 01:24:46,899 - ZeroShotPerturbation - INFO - Processing 468 cells in batches of 16
2025-12-11 01:25:23,642 - ZeroShotPerturbation - INFO - Target METTL14 - DES: 0.6683, MAE_top2k: 0.4973, n_DE: 9515
2025-12-11 01:25:23,642 - ZeroShotPerturbation - INFO - Predicting for target: MAU2
2025-12-11 01:25:23,646 - ZeroShotPerturbation - INFO - Processing 1021 cells in batches of 16
2025-12-11 01:26:09,589 - ZeroShotPerturbation - INFO - Target MAU2 - DES: 0.5793, MAE_top2k: 0.2298, n_DE: 6952
2025-12-11 01:26:09,590 - ZeroShotPerturbation - INFO - Predicting for target: NDUFB4
2025-12-11 01:26:09,593 - ZeroShotPerturbation - INFO - Processing 1413 cells in batches of 16
2025-12-11 01:27:02,412 - ZeroShotPerturbation - INFO - Target NDUFB4 - DES: 0.1588, MAE_top2k: 0.0703, n_DE: 1297
2025-12-11 01:27:02,413 - ZeroShotPerturbation - INFO - Predicting for target: KDM1A
2025-12-11 01:27:02,416 - ZeroShotPerturbation - INFO - Processing 352 cells in batches of 16
2025-12-11 01:27:37,073 - ZeroShotPerturbation - INFO - Target KDM1A - DES: 0.6684, MAE_top2k: 0.4818, n_DE: 10272
2025-12-11 01:27:37,074 - ZeroShotPerturbation - INFO - Predicting for target: TXNDC9
2025-12-11 01:27:37,078 - ZeroShotPerturbation - INFO - Processing 514 cells in batches of 16
2025-12-11 01:28:15,816 - ZeroShotPerturbation - INFO - Target TXNDC9 - DES: 0.2158, MAE_top2k: 0.0707, n_DE: 417
2025-12-11 01:28:15,816 - ZeroShotPerturbation - INFO - Predicting for target: CALM3
2025-12-11 01:28:15,818 - ZeroShotPerturbation - INFO - Processing 681 cells in batches of 16
2025-12-11 01:28:56,114 - ZeroShotPerturbation - INFO - Target CALM3 - DES: 0.0543, MAE_top2k: 0.0796, n_DE: 129
2025-12-11 01:28:56,115 - ZeroShotPerturbation - INFO - Predicting for target: C1QBP
2025-12-11 01:28:56,117 - ZeroShotPerturbation - INFO - Processing 711 cells in batches of 16
2025-12-11 01:29:37,695 - ZeroShotPerturbation - INFO - Target C1QBP - DES: 0.5357, MAE_top2k: 0.1106, n_DE: 4073
2025-12-11 01:29:37,696 - ZeroShotPerturbation - INFO - Predicting for target: MBTPS1
2025-12-11 01:29:37,699 - ZeroShotPerturbation - INFO - Processing 626 cells in batches of 16
2025-12-11 01:30:18,184 - ZeroShotPerturbation - INFO - Target MBTPS1 - DES: 0.3901, MAE_top2k: 0.1764, n_DE: 3794
2025-12-11 01:30:18,185 - ZeroShotPerturbation - INFO - Predicting for target: ZNF562
2025-12-11 01:30:18,188 - ZeroShotPerturbation - INFO - Processing 418 cells in batches of 16
2025-12-11 01:30:55,479 - ZeroShotPerturbation - INFO - Target ZNF562 - DES: 0.0000, MAE_top2k: 0.0499, n_DE: 19
2025-12-11 01:30:55,479 - ZeroShotPerturbation - INFO - Predicting for target: PHF10
2025-12-11 01:30:55,482 - ZeroShotPerturbation - INFO - Processing 450 cells in batches of 16
2025-12-11 01:31:32,092 - ZeroShotPerturbation - INFO - Target PHF10 - DES: 0.1602, MAE_top2k: 0.1028, n_DE: 749
2025-12-11 01:31:32,092 - ZeroShotPerturbation - INFO - Predicting for target: FDPS
2025-12-11 01:31:32,096 - ZeroShotPerturbation - INFO - Processing 154 cells in batches of 16
2025-12-11 01:32:03,022 - ZeroShotPerturbation - INFO - Target FDPS - DES: 0.3689, MAE_top2k: 0.2557, n_DE: 2331
2025-12-11 01:32:03,023 - ZeroShotPerturbation - INFO - Predicting for target: OXA1L
2025-12-11 01:32:03,025 - ZeroShotPerturbation - INFO - Processing 63 cells in batches of 16
2025-12-11 01:32:32,500 - ZeroShotPerturbation - INFO - Target OXA1L - DES: 0.1830, MAE_top2k: 0.2681, n_DE: 918
2025-12-11 01:32:32,559 - ZeroShotPerturbation - INFO - Results saved to results/baseline/perturbation_metrics.csv
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO - ==================================================
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO - Final Test Metrics (per eval_metrics.md Section 4.2.2):
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO - Three DE Metrics (raw, averaged):
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO -   pds:                   0.4833
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO -   mae:                   0.1258
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO -   des:                   0.2534
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO - Overall Score (0-100, averaged from per-perturbation):
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO -   overall_score:         27.22
2025-12-11 01:32:32,560 - ZeroShotPerturbation - INFO - ==================================================
