/public/home/wangar2023/VCC_Project/scGPT/scgpt/model/model.py:21: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/public/home/wangar2023/VCC_Project/scGPT/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/torchtext/vocab/__init__.py:4: UserWarning: 
/!\ IMPORTANT WARNING ABOUT TORCHTEXT STATUS /!\ 
Torchtext is deprecated and the last released version will be 0.18 (this one). You can silence this warning by calling the following at the beginnign of your scripts: `import torchtext; torchtext.disable_torchtext_deprecation_warning()`
  warnings.warn(torchtext._TORCHTEXT_DEPRECATION_MSG)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/torchtext/utils.py:4: UserWarning: 
/!\ IMPORTANT WARNING ABOUT TORCHTEXT STATUS /!\ 
Torchtext is deprecated and the last released version will be 0.18 (this one). You can silence this warning by calling the following at the beginnign of your scripts: `import torchtext; torchtext.disable_torchtext_deprecation_warning()`
  warnings.warn(torchtext._TORCHTEXT_DEPRECATION_MSG)
INFO:ZeroShotPerturbation:Starting Perturbation Pipeline with baseline model
INFO:ZeroShotPerturbation:Model directory: model/scGPT
INFO:ZeroShotPerturbation:Results will be saved to: results/baseline
INFO:ZeroShotPerturbation:Initializing Baseline Model Wrapper...
INFO:ZeroShotPerturbation:Loaded vocab from model/scGPT/vocab.json
INFO:ZeroShotPerturbation:Initializing Data Loader...
INFO:ZeroShotPerturbation:Loading training data from data/processed/train.h5ad
INFO:ZeroShotPerturbation:Loading test data from data/processed/test.h5ad
INFO:ZeroShotPerturbation:Found 38176 control cells.
INFO:ZeroShotPerturbation:Fitting baseline model on training data...
INFO:ZeroShotPerturbation:Fitting baseline from AnnData: computing mean perturbed expression...
INFO:ZeroShotPerturbation:Baseline fitted: mean expression computed from 153002 perturbed samples, 18080 genes
INFO:ZeroShotPerturbation:Processing 30 target genes...
INFO:ZeroShotPerturbation:Predicting for target: AKT2
INFO:ZeroShotPerturbation:Processing 938 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4561.51it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3413134.23it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  12%|█▏        | 43/362 [00:00<00:00, 426.67it/s]Processing batches:  28%|██▊       | 102/362 [00:00<00:00, 516.67it/s]Processing batches:  43%|████▎     | 154/362 [00:00<00:00, 397.40it/s]Processing batches:  54%|█████▍    | 197/362 [00:02<00:02, 59.12it/s] Processing batches:  62%|██████▏   | 224/362 [00:05<00:05, 25.26it/s]Processing batches:  67%|██████▋   | 242/362 [00:07<00:06, 18.85it/s]Processing batches:  70%|███████   | 254/362 [00:08<00:06, 16.17it/s]Processing batches:  73%|███████▎  | 263/362 [00:09<00:06, 14.53it/s]Processing batches:  74%|███████▍  | 269/362 [00:10<00:06, 13.53it/s]Processing batches:  76%|███████▌  | 274/362 [00:10<00:06, 12.72it/s]Processing batches:  77%|███████▋  | 278/362 [00:11<00:06, 12.13it/s]Processing batches:  78%|███████▊  | 281/362 [00:11<00:06, 11.67it/s]Processing batches:  78%|███████▊  | 284/362 [00:11<00:06, 11.20it/s]Processing batches:  79%|███████▉  | 286/362 [00:12<00:07, 10.85it/s]Processing batches:  80%|███████▉  | 288/362 [00:12<00:06, 10.60it/s]Processing batches:  80%|████████  | 290/362 [00:12<00:07, 10.27it/s]Processing batches:  81%|████████  | 292/362 [00:12<00:07,  9.98it/s]Processing batches:  81%|████████  | 294/362 [00:13<00:07,  9.64it/s]Processing batches:  82%|████████▏ | 296/362 [00:13<00:07,  9.38it/s]Processing batches:  82%|████████▏ | 297/362 [00:13<00:06,  9.29it/s]Processing batches:  82%|████████▏ | 298/362 [00:13<00:06,  9.22it/s]Processing batches:  83%|████████▎ | 299/362 [00:13<00:06,  9.21it/s]Processing batches:  83%|████████▎ | 300/362 [00:13<00:06,  9.15it/s]Processing batches:  83%|████████▎ | 301/362 [00:13<00:06,  9.03it/s]Processing batches:  83%|████████▎ | 302/362 [00:14<00:06,  8.97it/s]Processing batches:  84%|████████▎ | 303/362 [00:14<00:06,  8.94it/s]Processing batches:  84%|████████▍ | 304/362 [00:14<00:06,  8.99it/s]Processing batches:  84%|████████▍ | 305/362 [00:14<00:06,  8.93it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:06,  8.92it/s]Processing batches:  85%|████████▍ | 307/362 [00:14<00:06,  8.89it/s]Processing batches:  85%|████████▌ | 308/362 [00:14<00:06,  8.93it/s]Processing batches:  85%|████████▌ | 309/362 [00:14<00:05,  8.87it/s]Processing batches:  86%|████████▌ | 310/362 [00:14<00:05,  8.86it/s]Processing batches:  86%|████████▌ | 311/362 [00:15<00:05,  8.88it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:05,  8.89it/s]Processing batches:  86%|████████▋ | 313/362 [00:15<00:05,  8.89it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:05,  8.90it/s]Processing batches:  87%|████████▋ | 315/362 [00:15<00:05,  8.91it/s]Processing batches:  87%|████████▋ | 316/362 [00:15<00:05,  8.90it/s]Processing batches:  88%|████████▊ | 317/362 [00:15<00:05,  8.90it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:04,  8.91it/s]Processing batches:  88%|████████▊ | 319/362 [00:15<00:04,  8.93it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04,  8.92it/s]Processing batches:  89%|████████▊ | 321/362 [00:16<00:04,  8.95it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  9.01it/s]Processing batches:  89%|████████▉ | 323/362 [00:16<00:04,  9.04it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:04,  9.05it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:04,  9.02it/s]Processing batches:  90%|█████████ | 326/362 [00:16<00:04,  8.99it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:03,  8.96it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03,  8.90it/s]Processing batches:  91%|█████████ | 329/362 [00:17<00:03,  8.90it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  8.96it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  8.93it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  8.92it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  8.92it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  8.90it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:03,  8.95it/s]Processing batches:  93%|█████████▎| 336/362 [00:17<00:02,  8.93it/s]Processing batches:  93%|█████████▎| 337/362 [00:17<00:02,  8.91it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.91it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.92it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.92it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  8.92it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  8.93it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  8.96it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:02,  8.95it/s]Processing batches:  95%|█████████▌| 345/362 [00:18<00:01,  9.00it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01,  8.96it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.95it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.94it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  8.99it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  8.97it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  8.96it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  8.93it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:01,  8.96it/s]Processing batches:  98%|█████████▊| 354/362 [00:19<00:00,  8.86it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  8.87it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  8.93it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.91it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00,  8.98it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  8.93it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  8.99it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  9.02it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.50it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4554.08it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3448522.80it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   9%|▉         | 34/362 [00:00<00:00, 328.91it/s]Processing batches:  23%|██▎       | 83/362 [00:00<00:00, 406.52it/s]Processing batches:  36%|███▋      | 132/362 [00:00<00:00, 417.01it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 415.89it/s]Processing batches:  62%|██████▏   | 223/362 [00:05<00:05, 26.16it/s] Processing batches:  69%|██████▉   | 250/362 [00:07<00:06, 18.17it/s]Processing batches:  74%|███████▍  | 269/362 [00:10<00:06, 15.28it/s]Processing batches:  78%|███████▊  | 282/362 [00:11<00:05, 13.82it/s]Processing batches:  80%|████████  | 291/362 [00:12<00:05, 12.94it/s]Processing batches:  82%|████████▏ | 298/362 [00:13<00:05, 12.26it/s]Processing batches:  84%|████████▎ | 303/362 [00:13<00:05, 11.80it/s]Processing batches:  85%|████████▍ | 307/362 [00:14<00:04, 11.42it/s]Processing batches:  86%|████████▌ | 310/362 [00:14<00:04, 11.10it/s]Processing batches:  86%|████████▋ | 313/362 [00:14<00:04, 10.78it/s]Processing batches:  87%|████████▋ | 315/362 [00:15<00:04, 10.57it/s]Processing batches:  88%|████████▊ | 317/362 [00:15<00:04, 10.34it/s]Processing batches:  88%|████████▊ | 319/362 [00:15<00:04, 10.12it/s]Processing batches:  89%|████████▊ | 321/362 [00:15<00:04,  9.91it/s]Processing batches:  89%|████████▉ | 323/362 [00:15<00:04,  9.71it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:03,  9.54it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:03,  9.42it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03,  9.34it/s]Processing batches:  91%|█████████ | 329/362 [00:16<00:03,  9.31it/s]Processing batches:  91%|█████████ | 330/362 [00:16<00:03,  9.27it/s]Processing batches:  91%|█████████▏| 331/362 [00:16<00:03,  9.24it/s]Processing batches:  92%|█████████▏| 332/362 [00:16<00:03,  9.22it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  9.22it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  9.21it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:02,  9.26it/s]Processing batches:  93%|█████████▎| 336/362 [00:17<00:02,  9.20it/s]Processing batches:  93%|█████████▎| 337/362 [00:17<00:02,  9.20it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:02,  9.25it/s]Processing batches:  94%|█████████▎| 339/362 [00:17<00:02,  9.24it/s]Processing batches:  94%|█████████▍| 340/362 [00:17<00:02,  9.19it/s]Processing batches:  94%|█████████▍| 341/362 [00:17<00:02,  9.20it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  9.24it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  9.18it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:01,  9.17it/s]Processing batches:  95%|█████████▌| 345/362 [00:18<00:01,  9.06it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01,  9.03it/s]Processing batches:  96%|█████████▌| 347/362 [00:18<00:01,  9.08it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01,  9.01it/s]Processing batches:  96%|█████████▋| 349/362 [00:18<00:01,  9.09it/s]Processing batches:  97%|█████████▋| 350/362 [00:18<00:01,  9.05it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  9.09it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  9.02it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:01,  8.95it/s]Processing batches:  98%|█████████▊| 354/362 [00:19<00:00,  9.01it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  9.01it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  9.04it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00,  9.08it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00,  9.11it/s]Processing batches:  99%|█████████▉| 359/362 [00:19<00:00,  9.09it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  9.10it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  9.06it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.90it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target AKT2 - DES: 0.0000, MAE_top2k: 0.0631, n_DE: 337
INFO:ZeroShotPerturbation:Predicting for target: MAP3K7
INFO:ZeroShotPerturbation:Processing 2019 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3242.60it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3343460.00it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▌        | 56/362 [00:00<00:00, 521.71it/s]Processing batches:  44%|████▍     | 161/362 [00:00<00:00, 811.44it/s]Processing batches:  67%|██████▋   | 243/362 [00:08<00:05, 21.26it/s] Processing batches:  80%|███████▉  | 288/362 [00:14<00:05, 14.32it/s]Processing batches:  87%|████████▋ | 316/362 [00:18<00:03, 12.16it/s]Processing batches:  92%|█████████▏| 334/362 [00:21<00:02, 11.09it/s]Processing batches:  96%|█████████▌| 346/362 [00:22<00:01, 10.46it/s]Processing batches:  98%|█████████▊| 355/362 [00:23<00:00,  9.98it/s]Processing batches: 100%|█████████▉| 361/362 [00:24<00:00,  9.66it/s]Processing batches: 100%|██████████| 362/362 [00:24<00:00, 14.64it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3198.10it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3429651.14it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  11%|█         | 40/362 [00:00<00:00, 359.06it/s]Processing batches:  21%|██▏       | 77/362 [00:00<00:00, 363.20it/s]Processing batches:  31%|███▏      | 114/362 [00:00<00:00, 352.02it/s]Processing batches:  48%|████▊     | 173/362 [00:00<00:00, 427.79it/s]Processing batches:  60%|█████▉    | 216/362 [00:05<00:05, 26.05it/s] Processing batches:  67%|██████▋   | 244/362 [00:08<00:07, 16.48it/s]Processing batches:  73%|███████▎  | 263/362 [00:11<00:07, 13.51it/s]Processing batches:  76%|███████▌  | 276/362 [00:12<00:07, 12.07it/s]Processing batches:  79%|███████▊  | 285/362 [00:14<00:06, 11.23it/s]Processing batches:  81%|████████  | 292/362 [00:14<00:06, 10.60it/s]Processing batches:  82%|████████▏ | 297/362 [00:15<00:06, 10.14it/s]Processing batches:  83%|████████▎ | 301/362 [00:16<00:06,  9.76it/s]Processing batches:  84%|████████▍ | 304/362 [00:16<00:06,  9.49it/s]Processing batches:  85%|████████▍ | 307/362 [00:16<00:05,  9.17it/s]Processing batches:  85%|████████▌ | 309/362 [00:17<00:05,  8.94it/s]Processing batches:  86%|████████▌ | 311/362 [00:17<00:05,  8.80it/s]Processing batches:  86%|████████▋ | 313/362 [00:17<00:05,  8.60it/s]Processing batches:  87%|████████▋ | 315/362 [00:17<00:05,  8.41it/s]Processing batches:  87%|████████▋ | 316/362 [00:18<00:05,  8.32it/s]Processing batches:  88%|████████▊ | 317/362 [00:18<00:05,  8.20it/s]Processing batches:  88%|████████▊ | 318/362 [00:18<00:05,  8.14it/s]Processing batches:  88%|████████▊ | 319/362 [00:18<00:05,  8.06it/s]Processing batches:  88%|████████▊ | 320/362 [00:18<00:05,  7.94it/s]Processing batches:  89%|████████▊ | 321/362 [00:18<00:05,  7.86it/s]Processing batches:  89%|████████▉ | 322/362 [00:18<00:05,  7.90it/s]Processing batches:  89%|████████▉ | 323/362 [00:18<00:04,  7.82it/s]Processing batches:  90%|████████▉ | 324/362 [00:19<00:04,  7.76it/s]Processing batches:  90%|████████▉ | 325/362 [00:19<00:04,  7.69it/s]Processing batches:  90%|█████████ | 326/362 [00:19<00:04,  7.73it/s]Processing batches:  90%|█████████ | 327/362 [00:19<00:04,  7.80it/s]Processing batches:  91%|█████████ | 328/362 [00:19<00:04,  7.75it/s]Processing batches:  91%|█████████ | 329/362 [00:19<00:04,  7.72it/s]Processing batches:  91%|█████████ | 330/362 [00:19<00:04,  7.73it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:04,  7.69it/s]Processing batches:  92%|█████████▏| 332/362 [00:20<00:03,  7.60it/s]Processing batches:  92%|█████████▏| 333/362 [00:20<00:03,  7.61it/s]Processing batches:  92%|█████████▏| 334/362 [00:20<00:03,  7.75it/s]Processing batches:  93%|█████████▎| 335/362 [00:20<00:03,  7.74it/s]Processing batches:  93%|█████████▎| 336/362 [00:20<00:03,  7.80it/s]Processing batches:  93%|█████████▎| 337/362 [00:20<00:03,  7.85it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:03,  7.69it/s]Processing batches:  94%|█████████▎| 339/362 [00:21<00:02,  7.81it/s]Processing batches:  94%|█████████▍| 340/362 [00:21<00:02,  7.82it/s]Processing batches:  94%|█████████▍| 341/362 [00:21<00:02,  7.73it/s]Processing batches:  94%|█████████▍| 342/362 [00:21<00:02,  7.89it/s]Processing batches:  95%|█████████▍| 343/362 [00:21<00:02,  7.92it/s]Processing batches:  95%|█████████▌| 344/362 [00:21<00:02,  7.85it/s]Processing batches:  95%|█████████▌| 345/362 [00:21<00:02,  7.84it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:02,  7.76it/s]Processing batches:  96%|█████████▌| 347/362 [00:22<00:01,  7.81it/s]Processing batches:  96%|█████████▌| 348/362 [00:22<00:01,  7.64it/s]Processing batches:  96%|█████████▋| 349/362 [00:22<00:01,  7.86it/s]Processing batches:  97%|█████████▋| 350/362 [00:22<00:01,  7.78it/s]Processing batches:  97%|█████████▋| 351/362 [00:22<00:01,  7.76it/s]Processing batches:  97%|█████████▋| 352/362 [00:22<00:01,  7.73it/s]Processing batches:  98%|█████████▊| 353/362 [00:22<00:01,  7.76it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:01,  7.69it/s]Processing batches:  98%|█████████▊| 355/362 [00:23<00:00,  7.71it/s]Processing batches:  98%|█████████▊| 356/362 [00:23<00:00,  7.74it/s]Processing batches:  99%|█████████▊| 357/362 [00:23<00:00,  7.79it/s]Processing batches:  99%|█████████▉| 358/362 [00:23<00:00,  7.79it/s]Processing batches:  99%|█████████▉| 359/362 [00:23<00:00,  7.79it/s]Processing batches:  99%|█████████▉| 360/362 [00:23<00:00,  7.74it/s]Processing batches: 100%|█████████▉| 361/362 [00:23<00:00,  7.82it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.13it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MAP3K7 - DES: 0.0000, MAE_top2k: 0.0356, n_DE: 49
INFO:ZeroShotPerturbation:Predicting for target: ZNF426
INFO:ZeroShotPerturbation:Processing 1132 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4512.43it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3313945.56it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  21%|██        | 75/362 [00:00<00:00, 746.26it/s]Processing batches:  45%|████▌     | 164/362 [00:00<00:00, 824.44it/s]Processing batches:  68%|██████▊   | 247/362 [00:07<00:04, 23.11it/s] Processing batches:  81%|████████  | 293/362 [00:13<00:04, 15.98it/s]Processing batches:  89%|████████▊ | 321/362 [00:16<00:02, 13.74it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:01, 12.59it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:00, 11.88it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 11.47it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 17.01it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4398.85it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3412212.76it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 50/362 [00:00<00:00, 498.00it/s]Processing batches:  28%|██▊       | 103/362 [00:00<00:00, 514.60it/s]Processing batches:  43%|████▎     | 155/362 [00:00<00:00, 473.72it/s]Processing batches:  56%|█████▌    | 203/362 [00:02<00:03, 46.25it/s] Processing batches:  64%|██████▍   | 233/362 [00:06<00:05, 22.31it/s]Processing batches:  70%|██████▉   | 253/362 [00:08<00:06, 17.22it/s]Processing batches:  74%|███████▍  | 267/362 [00:10<00:06, 14.94it/s]Processing batches:  77%|███████▋  | 277/362 [00:11<00:06, 13.60it/s]Processing batches:  78%|███████▊  | 284/362 [00:12<00:06, 12.73it/s]Processing batches:  80%|███████▉  | 289/362 [00:12<00:06, 12.12it/s]Processing batches:  81%|████████  | 293/362 [00:13<00:05, 11.64it/s]Processing batches:  82%|████████▏ | 296/362 [00:13<00:05, 11.23it/s]Processing batches:  83%|████████▎ | 299/362 [00:13<00:05, 10.84it/s]Processing batches:  83%|████████▎ | 301/362 [00:14<00:05, 10.56it/s]Processing batches:  84%|████████▎ | 303/362 [00:14<00:05, 10.25it/s]Processing batches:  84%|████████▍ | 305/362 [00:14<00:05,  9.96it/s]Processing batches:  85%|████████▍ | 307/362 [00:14<00:05,  9.73it/s]Processing batches:  85%|████████▌ | 309/362 [00:14<00:05,  9.49it/s]Processing batches:  86%|████████▌ | 311/362 [00:15<00:05,  9.33it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:05,  9.23it/s]Processing batches:  86%|████████▋ | 313/362 [00:15<00:05,  9.17it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:05,  9.12it/s]Processing batches:  87%|████████▋ | 315/362 [00:15<00:05,  9.01it/s]Processing batches:  87%|████████▋ | 316/362 [00:15<00:05,  8.95it/s]Processing batches:  88%|████████▊ | 317/362 [00:15<00:05,  8.94it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:04,  8.87it/s]Processing batches:  88%|████████▊ | 319/362 [00:16<00:04,  8.88it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04,  8.87it/s]Processing batches:  89%|████████▊ | 321/362 [00:16<00:04,  8.86it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  8.92it/s]Processing batches:  89%|████████▉ | 323/362 [00:16<00:04,  8.92it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:04,  8.84it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:04,  8.85it/s]Processing batches:  90%|█████████ | 326/362 [00:16<00:04,  8.85it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:03,  8.84it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03,  8.82it/s]Processing batches:  91%|█████████ | 329/362 [00:17<00:03,  8.83it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  8.85it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  8.90it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  8.89it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  8.83it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  8.84it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:03,  8.81it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:02,  8.75it/s]Processing batches:  93%|█████████▎| 337/362 [00:18<00:02,  8.65it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.78it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.79it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.85it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  8.80it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  8.87it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  8.81it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:02,  8.88it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01,  8.81it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  8.72it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.73it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.72it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  8.79it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  8.79it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  8.86it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  8.83it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:01,  8.74it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  8.74it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  8.82it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  8.81it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.78it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00,  8.87it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  8.89it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  8.87it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  8.93it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.31it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target ZNF426 - DES: 0.0000, MAE_top2k: 0.0284, n_DE: 19
INFO:ZeroShotPerturbation:Predicting for target: DNMT1
INFO:ZeroShotPerturbation:Processing 893 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5008.12it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3222001.03it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  32%|███▏      | 115/362 [00:00<00:00, 1142.76it/s]Processing batches:  64%|██████▎   | 230/362 [00:05<00:03, 35.07it/s]  Processing batches:  77%|███████▋  | 279/362 [00:11<00:04, 19.92it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:03, 16.49it/s]Processing batches:  89%|████████▉ | 323/362 [00:15<00:02, 14.84it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:02, 13.85it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:01, 13.13it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01, 12.58it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:00, 12.18it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00, 11.82it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00, 11.44it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00, 11.17it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 11.18it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.93it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4975.45it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3351291.16it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▍        | 54/362 [00:00<00:00, 524.37it/s]Processing batches:  30%|██▉       | 107/362 [00:00<00:00, 494.87it/s]Processing batches:  47%|████▋     | 171/362 [00:00<00:00, 557.69it/s]Processing batches:  63%|██████▎   | 228/362 [00:05<00:04, 27.46it/s] Processing batches:  73%|███████▎  | 263/362 [00:09<00:05, 18.19it/s]Processing batches:  79%|███████▉  | 286/362 [00:11<00:04, 15.30it/s]Processing batches:  83%|████████▎ | 302/362 [00:13<00:04, 13.81it/s]Processing batches:  86%|████████▋ | 313/362 [00:14<00:03, 12.92it/s]Processing batches:  89%|████████▊ | 321/362 [00:15<00:03, 12.29it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:02, 11.84it/s]Processing batches:  91%|█████████▏| 331/362 [00:16<00:02, 11.50it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:02, 11.15it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:02, 10.88it/s]Processing batches:  94%|█████████▍| 340/362 [00:17<00:02, 10.68it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:01, 10.46it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:01, 10.25it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01, 10.03it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01,  9.82it/s]Processing batches:  97%|█████████▋| 350/362 [00:18<00:01,  9.69it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.57it/s]Processing batches:  98%|█████████▊| 354/362 [00:19<00:00,  9.47it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  9.44it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  9.39it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00,  9.34it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00,  9.32it/s]Processing batches:  99%|█████████▉| 359/362 [00:19<00:00,  9.22it/s]Processing batches:  99%|█████████▉| 360/362 [00:19<00:00,  9.34it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00,  9.33it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 18.07it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target DNMT1 - DES: 0.3175, MAE_top2k: 0.2786, n_DE: 8173
INFO:ZeroShotPerturbation:Predicting for target: SRC
INFO:ZeroShotPerturbation:Processing 2403 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2985.27it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3237268.57it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  10%|█         | 38/362 [00:00<00:00, 377.25it/s]Processing batches:  33%|███▎      | 118/362 [00:00<00:00, 624.07it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 536.21it/s]Processing batches:  65%|██████▌   | 236/362 [00:08<00:06, 18.54it/s] Processing batches:  75%|███████▍  | 270/362 [00:13<00:07, 13.14it/s]Processing batches:  81%|████████  | 292/362 [00:16<00:06, 11.29it/s]Processing batches:  85%|████████▍ | 307/362 [00:18<00:05, 10.27it/s]Processing batches:  88%|████████▊ | 318/362 [00:20<00:04,  9.62it/s]Processing batches:  90%|█████████ | 326/362 [00:21<00:03,  9.19it/s]Processing batches:  92%|█████████▏| 332/362 [00:22<00:03,  8.84it/s]Processing batches:  93%|█████████▎| 336/362 [00:22<00:03,  8.58it/s]Processing batches:  94%|█████████▎| 339/362 [00:23<00:02,  8.38it/s]Processing batches:  94%|█████████▍| 342/362 [00:23<00:02,  8.17it/s]Processing batches:  95%|█████████▌| 344/362 [00:23<00:02,  8.05it/s]Processing batches:  96%|█████████▌| 346/362 [00:24<00:02,  7.86it/s]Processing batches:  96%|█████████▌| 348/362 [00:24<00:01,  7.66it/s]Processing batches:  97%|█████████▋| 350/362 [00:24<00:01,  7.56it/s]Processing batches:  97%|█████████▋| 351/362 [00:24<00:01,  7.50it/s]Processing batches:  97%|█████████▋| 352/362 [00:25<00:01,  7.41it/s]Processing batches:  98%|█████████▊| 353/362 [00:25<00:01,  7.32it/s]Processing batches:  98%|█████████▊| 354/362 [00:25<00:01,  7.18it/s]Processing batches:  98%|█████████▊| 355/362 [00:25<00:00,  7.13it/s]Processing batches:  98%|█████████▊| 356/362 [00:25<00:00,  7.09it/s]Processing batches:  99%|█████████▊| 357/362 [00:25<00:00,  7.07it/s]Processing batches:  99%|█████████▉| 358/362 [00:25<00:00,  7.14it/s]Processing batches:  99%|█████████▉| 359/362 [00:26<00:00,  7.07it/s]Processing batches:  99%|█████████▉| 360/362 [00:26<00:00,  7.08it/s]Processing batches: 100%|█████████▉| 361/362 [00:26<00:00,  7.16it/s]Processing batches: 100%|██████████| 362/362 [00:26<00:00, 13.65it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2937.19it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3345082.33it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  12%|█▏        | 44/362 [00:00<00:00, 438.62it/s]Processing batches:  24%|██▍       | 88/362 [00:00<00:00, 405.22it/s]Processing batches:  36%|███▌      | 129/362 [00:00<00:00, 393.75it/s]Processing batches:  47%|████▋     | 169/362 [00:00<00:00, 340.85it/s]Processing batches:  56%|█████▋    | 204/362 [00:03<00:04, 31.85it/s] Processing batches:  63%|██████▎   | 227/362 [00:06<00:07, 17.95it/s]Processing batches:  67%|██████▋   | 243/362 [00:08<00:08, 14.12it/s]Processing batches:  70%|███████   | 254/362 [00:10<00:08, 12.37it/s]Processing batches:  72%|███████▏  | 262/362 [00:11<00:08, 11.29it/s]Processing batches:  74%|███████▍  | 268/362 [00:12<00:08, 10.53it/s]Processing batches:  75%|███████▌  | 272/362 [00:12<00:08, 10.06it/s]Processing batches:  76%|███████▌  | 275/362 [00:13<00:08,  9.68it/s]Processing batches:  77%|███████▋  | 278/362 [00:13<00:09,  9.30it/s]Processing batches:  77%|███████▋  | 280/362 [00:14<00:09,  9.07it/s]Processing batches:  78%|███████▊  | 282/362 [00:14<00:09,  8.75it/s]Processing batches:  78%|███████▊  | 284/362 [00:14<00:09,  8.47it/s]Processing batches:  79%|███████▉  | 286/362 [00:14<00:09,  8.22it/s]Processing batches:  79%|███████▉  | 287/362 [00:14<00:09,  8.12it/s]Processing batches:  80%|███████▉  | 288/362 [00:15<00:09,  8.01it/s]Processing batches:  80%|███████▉  | 289/362 [00:15<00:09,  7.87it/s]Processing batches:  80%|████████  | 290/362 [00:15<00:09,  7.75it/s]Processing batches:  80%|████████  | 291/362 [00:15<00:09,  7.63it/s]Processing batches:  81%|████████  | 292/362 [00:15<00:09,  7.58it/s]Processing batches:  81%|████████  | 293/362 [00:15<00:09,  7.51it/s]Processing batches:  81%|████████  | 294/362 [00:15<00:09,  7.43it/s]Processing batches:  81%|████████▏ | 295/362 [00:16<00:09,  7.37it/s]Processing batches:  82%|████████▏ | 296/362 [00:16<00:08,  7.34it/s]Processing batches:  82%|████████▏ | 297/362 [00:16<00:08,  7.26it/s]Processing batches:  82%|████████▏ | 298/362 [00:16<00:08,  7.27it/s]Processing batches:  83%|████████▎ | 299/362 [00:16<00:08,  7.34it/s]Processing batches:  83%|████████▎ | 300/362 [00:16<00:08,  7.38it/s]Processing batches:  83%|████████▎ | 301/362 [00:16<00:08,  7.28it/s]Processing batches:  83%|████████▎ | 302/362 [00:17<00:08,  7.25it/s]Processing batches:  84%|████████▎ | 303/362 [00:17<00:08,  7.28it/s]Processing batches:  84%|████████▍ | 304/362 [00:17<00:08,  7.24it/s]Processing batches:  84%|████████▍ | 305/362 [00:17<00:07,  7.29it/s]Processing batches:  85%|████████▍ | 306/362 [00:17<00:07,  7.23it/s]Processing batches:  85%|████████▍ | 307/362 [00:17<00:07,  7.27it/s]Processing batches:  85%|████████▌ | 308/362 [00:17<00:07,  7.27it/s]Processing batches:  85%|████████▌ | 309/362 [00:17<00:07,  7.25it/s]Processing batches:  86%|████████▌ | 310/362 [00:18<00:07,  7.21it/s]Processing batches:  86%|████████▌ | 311/362 [00:18<00:07,  7.22it/s]Processing batches:  86%|████████▌ | 312/362 [00:18<00:06,  7.24it/s]Processing batches:  86%|████████▋ | 313/362 [00:18<00:06,  7.20it/s]Processing batches:  87%|████████▋ | 314/362 [00:18<00:06,  7.27it/s]Processing batches:  87%|████████▋ | 315/362 [00:18<00:06,  7.12it/s]Processing batches:  87%|████████▋ | 316/362 [00:18<00:06,  7.20it/s]Processing batches:  88%|████████▊ | 317/362 [00:19<00:06,  7.22it/s]Processing batches:  88%|████████▊ | 318/362 [00:19<00:06,  7.20it/s]Processing batches:  88%|████████▊ | 319/362 [00:19<00:06,  7.16it/s]Processing batches:  88%|████████▊ | 320/362 [00:19<00:05,  7.21it/s]Processing batches:  89%|████████▊ | 321/362 [00:19<00:05,  7.17it/s]Processing batches:  89%|████████▉ | 322/362 [00:19<00:05,  7.18it/s]Processing batches:  89%|████████▉ | 323/362 [00:19<00:05,  7.19it/s]Processing batches:  90%|████████▉ | 324/362 [00:20<00:05,  7.25it/s]Processing batches:  90%|████████▉ | 325/362 [00:20<00:05,  7.26it/s]Processing batches:  90%|█████████ | 326/362 [00:20<00:04,  7.30it/s]Processing batches:  90%|█████████ | 327/362 [00:20<00:04,  7.20it/s]Processing batches:  91%|█████████ | 328/362 [00:20<00:04,  7.24it/s]Processing batches:  91%|█████████ | 329/362 [00:20<00:04,  7.20it/s]Processing batches:  91%|█████████ | 330/362 [00:20<00:04,  7.20it/s]Processing batches:  91%|█████████▏| 331/362 [00:21<00:04,  7.14it/s]Processing batches:  92%|█████████▏| 332/362 [00:21<00:04,  7.21it/s]Processing batches:  92%|█████████▏| 333/362 [00:21<00:04,  7.22it/s]Processing batches:  92%|█████████▏| 334/362 [00:21<00:03,  7.22it/s]Processing batches:  93%|█████████▎| 335/362 [00:21<00:03,  7.21it/s]Processing batches:  93%|█████████▎| 336/362 [00:21<00:03,  7.16it/s]Processing batches:  93%|█████████▎| 337/362 [00:21<00:03,  7.21it/s]Processing batches:  93%|█████████▎| 338/362 [00:22<00:03,  7.21it/s]Processing batches:  94%|█████████▎| 339/362 [00:22<00:03,  7.25it/s]Processing batches:  94%|█████████▍| 340/362 [00:22<00:03,  7.24it/s]Processing batches:  94%|█████████▍| 341/362 [00:22<00:02,  7.25it/s]Processing batches:  94%|█████████▍| 342/362 [00:22<00:02,  7.28it/s]Processing batches:  95%|█████████▍| 343/362 [00:22<00:02,  7.29it/s]Processing batches:  95%|█████████▌| 344/362 [00:22<00:02,  7.30it/s]Processing batches:  95%|█████████▌| 345/362 [00:22<00:02,  7.29it/s]Processing batches:  96%|█████████▌| 346/362 [00:23<00:02,  7.23it/s]Processing batches:  96%|█████████▌| 347/362 [00:23<00:02,  7.19it/s]Processing batches:  96%|█████████▌| 348/362 [00:23<00:01,  7.23it/s]Processing batches:  96%|█████████▋| 349/362 [00:23<00:01,  7.26it/s]Processing batches:  97%|█████████▋| 350/362 [00:23<00:01,  7.22it/s]Processing batches:  97%|█████████▋| 351/362 [00:23<00:01,  7.26it/s]Processing batches:  97%|█████████▋| 352/362 [00:23<00:01,  7.25it/s]Processing batches:  98%|█████████▊| 353/362 [00:24<00:01,  7.28it/s]Processing batches:  98%|█████████▊| 354/362 [00:24<00:01,  7.08it/s]Processing batches:  98%|█████████▊| 355/362 [00:24<00:00,  7.32it/s]Processing batches:  98%|█████████▊| 356/362 [00:24<00:00,  7.33it/s]Processing batches:  99%|█████████▊| 357/362 [00:24<00:00,  7.31it/s]Processing batches:  99%|█████████▉| 358/362 [00:24<00:00,  7.25it/s]Processing batches:  99%|█████████▉| 359/362 [00:24<00:00,  7.35it/s]Processing batches:  99%|█████████▉| 360/362 [00:25<00:00,  7.37it/s]Processing batches: 100%|█████████▉| 361/362 [00:25<00:00,  7.39it/s]Processing batches: 100%|██████████| 362/362 [00:25<00:00, 14.33it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target SRC - DES: 0.0000, MAE_top2k: 0.0275, n_DE: 225
INFO:ZeroShotPerturbation:Predicting for target: MED13
INFO:ZeroShotPerturbation:Processing 2787 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2538.16it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3320911.60it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 51/362 [00:00<00:00, 503.05it/s]Processing batches:  28%|██▊       | 102/362 [00:00<00:00, 504.63it/s]Processing batches:  42%|████▏     | 153/362 [00:00<00:00, 417.42it/s]Processing batches:  54%|█████▍    | 197/362 [00:02<00:03, 45.05it/s] Processing batches:  62%|██████▏   | 224/362 [00:06<00:07, 18.83it/s]Processing batches:  67%|██████▋   | 242/362 [00:09<00:08, 14.00it/s]Processing batches:  70%|███████   | 254/362 [00:11<00:09, 12.00it/s]Processing batches:  73%|███████▎  | 263/362 [00:12<00:09, 10.78it/s]Processing batches:  74%|███████▍  | 269/362 [00:13<00:09, 10.03it/s]Processing batches:  76%|███████▌  | 274/362 [00:14<00:09,  9.42it/s]Processing batches:  77%|███████▋  | 278/362 [00:15<00:09,  8.99it/s]Processing batches:  78%|███████▊  | 281/362 [00:15<00:09,  8.66it/s]Processing batches:  78%|███████▊  | 283/362 [00:15<00:09,  8.40it/s]Processing batches:  79%|███████▊  | 285/362 [00:16<00:09,  8.11it/s]Processing batches:  79%|███████▉  | 287/362 [00:16<00:09,  7.85it/s]Processing batches:  80%|███████▉  | 289/362 [00:16<00:09,  7.60it/s]Processing batches:  80%|████████  | 290/362 [00:16<00:09,  7.44it/s]Processing batches:  80%|████████  | 291/362 [00:17<00:09,  7.39it/s]Processing batches:  81%|████████  | 292/362 [00:17<00:09,  7.21it/s]Processing batches:  81%|████████  | 293/362 [00:17<00:09,  7.13it/s]Processing batches:  81%|████████  | 294/362 [00:17<00:09,  6.95it/s]Processing batches:  81%|████████▏ | 295/362 [00:17<00:09,  6.83it/s]Processing batches:  82%|████████▏ | 296/362 [00:17<00:09,  6.77it/s]Processing batches:  82%|████████▏ | 297/362 [00:17<00:09,  6.75it/s]Processing batches:  82%|████████▏ | 298/362 [00:18<00:09,  6.69it/s]Processing batches:  83%|████████▎ | 299/362 [00:18<00:09,  6.72it/s]Processing batches:  83%|████████▎ | 300/362 [00:18<00:09,  6.66it/s]Processing batches:  83%|████████▎ | 301/362 [00:18<00:09,  6.53it/s]Processing batches:  83%|████████▎ | 302/362 [00:18<00:09,  6.49it/s]Processing batches:  84%|████████▎ | 303/362 [00:18<00:09,  6.47it/s]Processing batches:  84%|████████▍ | 304/362 [00:19<00:08,  6.56it/s]Processing batches:  84%|████████▍ | 305/362 [00:19<00:08,  6.48it/s]Processing batches:  85%|████████▍ | 306/362 [00:19<00:08,  6.52it/s]Processing batches:  85%|████████▍ | 307/362 [00:19<00:08,  6.49it/s]Processing batches:  85%|████████▌ | 308/362 [00:19<00:08,  6.43it/s]Processing batches:  85%|████████▌ | 309/362 [00:19<00:08,  6.44it/s]Processing batches:  86%|████████▌ | 310/362 [00:19<00:08,  6.41it/s]Processing batches:  86%|████████▌ | 311/362 [00:20<00:07,  6.49it/s]Processing batches:  86%|████████▌ | 312/362 [00:20<00:07,  6.52it/s]Processing batches:  86%|████████▋ | 313/362 [00:20<00:07,  6.52it/s]Processing batches:  87%|████████▋ | 314/362 [00:20<00:07,  6.55it/s]Processing batches:  87%|████████▋ | 315/362 [00:20<00:07,  6.56it/s]Processing batches:  87%|████████▋ | 316/362 [00:20<00:07,  6.57it/s]Processing batches:  88%|████████▊ | 317/362 [00:21<00:06,  6.55it/s]Processing batches:  88%|████████▊ | 318/362 [00:21<00:06,  6.58it/s]Processing batches:  88%|████████▊ | 319/362 [00:21<00:06,  6.63it/s]Processing batches:  88%|████████▊ | 320/362 [00:21<00:06,  6.57it/s]Processing batches:  89%|████████▊ | 321/362 [00:21<00:06,  6.57it/s]Processing batches:  89%|████████▉ | 322/362 [00:21<00:05,  6.70it/s]Processing batches:  89%|████████▉ | 323/362 [00:21<00:05,  6.70it/s]Processing batches:  90%|████████▉ | 324/362 [00:22<00:05,  6.66it/s]Processing batches:  90%|████████▉ | 325/362 [00:22<00:05,  6.62it/s]Processing batches:  90%|█████████ | 326/362 [00:22<00:05,  6.56it/s]Processing batches:  90%|█████████ | 327/362 [00:22<00:05,  6.58it/s]Processing batches:  91%|█████████ | 328/362 [00:22<00:05,  6.55it/s]Processing batches:  91%|█████████ | 329/362 [00:22<00:05,  6.55it/s]Processing batches:  91%|█████████ | 330/362 [00:23<00:04,  6.60it/s]Processing batches:  91%|█████████▏| 331/362 [00:23<00:04,  6.58it/s]Processing batches:  92%|█████████▏| 332/362 [00:23<00:04,  6.60it/s]Processing batches:  92%|█████████▏| 333/362 [00:23<00:04,  6.61it/s]Processing batches:  92%|█████████▏| 334/362 [00:23<00:04,  6.55it/s]Processing batches:  93%|█████████▎| 335/362 [00:23<00:04,  6.61it/s]Processing batches:  93%|█████████▎| 336/362 [00:23<00:03,  6.58it/s]Processing batches:  93%|█████████▎| 337/362 [00:24<00:03,  6.56it/s]Processing batches:  93%|█████████▎| 338/362 [00:24<00:03,  6.51it/s]Processing batches:  94%|█████████▎| 339/362 [00:24<00:03,  6.61it/s]Processing batches:  94%|█████████▍| 340/362 [00:24<00:03,  6.59it/s]Processing batches:  94%|█████████▍| 341/362 [00:24<00:03,  6.60it/s]Processing batches:  94%|█████████▍| 342/362 [00:24<00:03,  6.62it/s]Processing batches:  95%|█████████▍| 343/362 [00:24<00:02,  6.61it/s]Processing batches:  95%|█████████▌| 344/362 [00:25<00:02,  6.65it/s]Processing batches:  95%|█████████▌| 345/362 [00:25<00:02,  6.71it/s]Processing batches:  96%|█████████▌| 346/362 [00:25<00:02,  6.65it/s]Processing batches:  96%|█████████▌| 347/362 [00:25<00:02,  6.62it/s]Processing batches:  96%|█████████▌| 348/362 [00:25<00:02,  6.54it/s]Processing batches:  96%|█████████▋| 349/362 [00:25<00:01,  6.68it/s]Processing batches:  97%|█████████▋| 350/362 [00:26<00:01,  6.66it/s]Processing batches:  97%|█████████▋| 351/362 [00:26<00:01,  6.64it/s]Processing batches:  97%|█████████▋| 352/362 [00:26<00:01,  6.53it/s]Processing batches:  98%|█████████▊| 353/362 [00:26<00:01,  6.59it/s]Processing batches:  98%|█████████▊| 354/362 [00:26<00:01,  6.55it/s]Processing batches:  98%|█████████▊| 355/362 [00:26<00:01,  6.52it/s]Processing batches:  98%|█████████▊| 356/362 [00:26<00:00,  6.65it/s]Processing batches:  99%|█████████▊| 357/362 [00:27<00:00,  6.68it/s]Processing batches:  99%|█████████▉| 358/362 [00:27<00:00,  6.70it/s]Processing batches:  99%|█████████▉| 359/362 [00:27<00:00,  6.71it/s]Processing batches:  99%|█████████▉| 360/362 [00:27<00:00,  6.71it/s]Processing batches: 100%|█████████▉| 361/362 [00:27<00:00,  6.76it/s]Processing batches: 100%|██████████| 362/362 [00:27<00:00, 13.02it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2693.84it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3360647.74it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  11%|█         | 40/362 [00:00<00:00, 380.13it/s]Processing batches:  23%|██▎       | 82/362 [00:00<00:00, 401.36it/s]Processing batches:  36%|███▌      | 129/362 [00:00<00:00, 421.03it/s]Processing batches:  48%|████▊     | 172/362 [00:00<00:00, 398.45it/s]Processing batches:  59%|█████▊    | 212/362 [00:04<00:06, 24.97it/s] Processing batches:  66%|██████▌   | 238/362 [00:08<00:07, 15.53it/s]Processing batches:  71%|███████   | 256/362 [00:11<00:08, 12.55it/s]Processing batches:  74%|███████▍  | 268/362 [00:12<00:08, 11.16it/s]Processing batches:  77%|███████▋  | 277/362 [00:14<00:08, 10.26it/s]Processing batches:  78%|███████▊  | 283/362 [00:15<00:08,  9.75it/s]Processing batches:  80%|███████▉  | 288/362 [00:15<00:07,  9.30it/s]Processing batches:  81%|████████  | 292/362 [00:16<00:07,  8.94it/s]Processing batches:  81%|████████▏ | 295/362 [00:16<00:07,  8.64it/s]Processing batches:  82%|████████▏ | 297/362 [00:17<00:07,  8.47it/s]Processing batches:  83%|████████▎ | 299/362 [00:17<00:07,  8.29it/s]Processing batches:  83%|████████▎ | 301/362 [00:17<00:07,  8.06it/s]Processing batches:  84%|████████▎ | 303/362 [00:17<00:07,  7.81it/s]Processing batches:  84%|████████▍ | 304/362 [00:18<00:07,  7.71it/s]Processing batches:  84%|████████▍ | 305/362 [00:18<00:07,  7.60it/s]Processing batches:  85%|████████▍ | 306/362 [00:18<00:07,  7.50it/s]Processing batches:  85%|████████▍ | 307/362 [00:18<00:07,  7.38it/s]Processing batches:  85%|████████▌ | 308/362 [00:18<00:07,  7.28it/s]Processing batches:  85%|████████▌ | 309/362 [00:18<00:07,  7.18it/s]Processing batches:  86%|████████▌ | 310/362 [00:18<00:07,  7.14it/s]Processing batches:  86%|████████▌ | 311/362 [00:19<00:07,  7.06it/s]Processing batches:  86%|████████▌ | 312/362 [00:19<00:07,  7.09it/s]Processing batches:  86%|████████▋ | 313/362 [00:19<00:07,  6.99it/s]Processing batches:  87%|████████▋ | 314/362 [00:19<00:06,  7.07it/s]Processing batches:  87%|████████▋ | 315/362 [00:19<00:06,  6.99it/s]Processing batches:  87%|████████▋ | 316/362 [00:19<00:06,  7.01it/s]Processing batches:  88%|████████▊ | 317/362 [00:19<00:06,  6.94it/s]Processing batches:  88%|████████▊ | 318/362 [00:20<00:06,  7.01it/s]Processing batches:  88%|████████▊ | 319/362 [00:20<00:06,  7.02it/s]Processing batches:  88%|████████▊ | 320/362 [00:20<00:05,  7.03it/s]Processing batches:  89%|████████▊ | 321/362 [00:20<00:05,  7.05it/s]Processing batches:  89%|████████▉ | 322/362 [00:20<00:05,  7.03it/s]Processing batches:  89%|████████▉ | 323/362 [00:20<00:05,  7.07it/s]Processing batches:  90%|████████▉ | 324/362 [00:20<00:05,  7.06it/s]Processing batches:  90%|████████▉ | 325/362 [00:21<00:05,  7.04it/s]Processing batches:  90%|█████████ | 326/362 [00:21<00:05,  6.99it/s]Processing batches:  90%|█████████ | 327/362 [00:21<00:05,  6.89it/s]Processing batches:  91%|█████████ | 328/362 [00:21<00:04,  7.03it/s]Processing batches:  91%|█████████ | 329/362 [00:21<00:04,  6.95it/s]Processing batches:  91%|█████████ | 330/362 [00:21<00:04,  6.93it/s]Processing batches:  91%|█████████▏| 331/362 [00:21<00:04,  6.98it/s]Processing batches:  92%|█████████▏| 332/362 [00:22<00:04,  7.06it/s]Processing batches:  92%|█████████▏| 333/362 [00:22<00:04,  7.04it/s]Processing batches:  92%|█████████▏| 334/362 [00:22<00:03,  7.00it/s]Processing batches:  93%|█████████▎| 335/362 [00:22<00:03,  7.00it/s]Processing batches:  93%|█████████▎| 336/362 [00:22<00:03,  6.98it/s]Processing batches:  93%|█████████▎| 337/362 [00:22<00:03,  6.98it/s]Processing batches:  93%|█████████▎| 338/362 [00:22<00:03,  6.98it/s]Processing batches:  94%|█████████▎| 339/362 [00:23<00:03,  6.97it/s]Processing batches:  94%|█████████▍| 340/362 [00:23<00:03,  7.04it/s]Processing batches:  94%|█████████▍| 341/362 [00:23<00:02,  7.05it/s]Processing batches:  94%|█████████▍| 342/362 [00:23<00:02,  7.08it/s]Processing batches:  95%|█████████▍| 343/362 [00:23<00:02,  7.05it/s]Processing batches:  95%|█████████▌| 344/362 [00:23<00:02,  7.08it/s]Processing batches:  95%|█████████▌| 345/362 [00:23<00:02,  7.06it/s]Processing batches:  96%|█████████▌| 346/362 [00:24<00:02,  7.07it/s]Processing batches:  96%|█████████▌| 347/362 [00:24<00:02,  7.02it/s]Processing batches:  96%|█████████▌| 348/362 [00:24<00:01,  7.00it/s]Processing batches:  96%|█████████▋| 349/362 [00:24<00:01,  7.04it/s]Processing batches:  97%|█████████▋| 350/362 [00:24<00:01,  7.03it/s]Processing batches:  97%|█████████▋| 351/362 [00:24<00:01,  7.03it/s]Processing batches:  97%|█████████▋| 352/362 [00:24<00:01,  7.02it/s]Processing batches:  98%|█████████▊| 353/362 [00:25<00:01,  7.00it/s]Processing batches:  98%|█████████▊| 354/362 [00:25<00:01,  6.94it/s]Processing batches:  98%|█████████▊| 355/362 [00:25<00:01,  6.97it/s]Processing batches:  98%|█████████▊| 356/362 [00:25<00:00,  7.07it/s]Processing batches:  99%|█████████▊| 357/362 [00:25<00:00,  6.97it/s]Processing batches:  99%|█████████▉| 358/362 [00:25<00:00,  7.03it/s]Processing batches:  99%|█████████▉| 359/362 [00:25<00:00,  7.07it/s]Processing batches:  99%|█████████▉| 360/362 [00:26<00:00,  7.03it/s]Processing batches: 100%|█████████▉| 361/362 [00:26<00:00,  7.11it/s]Processing batches: 100%|██████████| 362/362 [00:26<00:00, 13.78it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MED13 - DES: 0.1055, MAE_top2k: 0.0838, n_DE: 5071
INFO:ZeroShotPerturbation:Predicting for target: KDR
INFO:ZeroShotPerturbation:Processing 2056 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3290.94it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3154057.99it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  22%|██▏       | 81/362 [00:00<00:00, 803.16it/s]Processing batches:  47%|████▋     | 170/362 [00:00<00:00, 849.67it/s]Processing batches:  70%|███████   | 255/362 [00:10<00:05, 18.14it/s] Processing batches:  71%|███████   | 256/362 [00:10<00:05, 17.92it/s]Processing batches:  84%|████████▎ | 303/362 [00:16<00:04, 12.09it/s]Processing batches:  92%|█████████▏| 332/362 [00:20<00:02, 10.52it/s]Processing batches:  97%|█████████▋| 351/362 [00:23<00:01,  9.79it/s]Processing batches: 100%|██████████| 362/362 [00:24<00:00, 14.56it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3119.60it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3371555.06it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   9%|▊         | 31/362 [00:00<00:01, 309.72it/s]Processing batches:  21%|██        | 75/362 [00:00<00:00, 370.38it/s]Processing batches:  35%|███▌      | 128/362 [00:00<00:00, 436.50it/s]Processing batches:  48%|████▊     | 175/362 [00:00<00:00, 449.09it/s]Processing batches:  61%|██████    | 220/362 [00:05<00:05, 23.96it/s] Processing batches:  69%|██████▉   | 250/362 [00:09<00:07, 15.64it/s]Processing batches:  75%|███████▍  | 270/362 [00:11<00:07, 13.09it/s]Processing batches:  78%|███████▊  | 284/362 [00:13<00:06, 11.77it/s]Processing batches:  81%|████████  | 294/362 [00:15<00:06, 10.95it/s]Processing batches:  83%|████████▎ | 301/362 [00:15<00:05, 10.42it/s]Processing batches:  85%|████████▍ | 306/362 [00:16<00:05, 10.03it/s]Processing batches:  86%|████████▌ | 310/362 [00:17<00:05,  9.71it/s]Processing batches:  86%|████████▋ | 313/362 [00:17<00:05,  9.45it/s]Processing batches:  87%|████████▋ | 316/362 [00:17<00:05,  9.18it/s]Processing batches:  88%|████████▊ | 318/362 [00:18<00:04,  8.94it/s]Processing batches:  88%|████████▊ | 320/362 [00:18<00:04,  8.82it/s]Processing batches:  89%|████████▉ | 322/362 [00:18<00:04,  8.64it/s]Processing batches:  90%|████████▉ | 324/362 [00:18<00:04,  8.47it/s]Processing batches:  90%|█████████ | 326/362 [00:19<00:04,  8.30it/s]Processing batches:  90%|█████████ | 327/362 [00:19<00:04,  8.23it/s]Processing batches:  91%|█████████ | 328/362 [00:19<00:04,  8.06it/s]Processing batches:  91%|█████████ | 329/362 [00:19<00:04,  8.02it/s]Processing batches:  91%|█████████ | 330/362 [00:19<00:04,  7.98it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:03,  7.93it/s]Processing batches:  92%|█████████▏| 332/362 [00:19<00:03,  7.86it/s]Processing batches:  92%|█████████▏| 333/362 [00:20<00:03,  7.86it/s]Processing batches:  92%|█████████▏| 334/362 [00:20<00:03,  7.79it/s]Processing batches:  93%|█████████▎| 335/362 [00:20<00:03,  7.76it/s]Processing batches:  93%|█████████▎| 336/362 [00:20<00:03,  7.76it/s]Processing batches:  93%|█████████▎| 337/362 [00:20<00:03,  7.79it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:03,  7.78it/s]Processing batches:  94%|█████████▎| 339/362 [00:20<00:02,  7.81it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  7.75it/s]Processing batches:  94%|█████████▍| 341/362 [00:21<00:02,  7.73it/s]Processing batches:  94%|█████████▍| 342/362 [00:21<00:02,  7.79it/s]Processing batches:  95%|█████████▍| 343/362 [00:21<00:02,  7.81it/s]Processing batches:  95%|█████████▌| 344/362 [00:21<00:02,  7.87it/s]Processing batches:  95%|█████████▌| 345/362 [00:21<00:02,  7.73it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:02,  7.81it/s]Processing batches:  96%|█████████▌| 347/362 [00:21<00:01,  7.55it/s]Processing batches:  96%|█████████▌| 348/362 [00:22<00:01,  7.79it/s]Processing batches:  96%|█████████▋| 349/362 [00:22<00:01,  7.74it/s]Processing batches:  97%|█████████▋| 350/362 [00:22<00:01,  7.85it/s]Processing batches:  97%|█████████▋| 351/362 [00:22<00:01,  7.81it/s]Processing batches:  97%|█████████▋| 352/362 [00:22<00:01,  7.74it/s]Processing batches:  98%|█████████▊| 353/362 [00:22<00:01,  7.71it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:01,  7.76it/s]Processing batches:  98%|█████████▊| 355/362 [00:22<00:00,  7.78it/s]Processing batches:  98%|█████████▊| 356/362 [00:23<00:00,  7.80it/s]Processing batches:  99%|█████████▊| 357/362 [00:23<00:00,  7.79it/s]Processing batches:  99%|█████████▉| 358/362 [00:23<00:00,  7.80it/s]Processing batches:  99%|█████████▉| 359/362 [00:23<00:00,  7.80it/s]Processing batches:  99%|█████████▉| 360/362 [00:23<00:00,  7.83it/s]Processing batches: 100%|█████████▉| 361/362 [00:23<00:00,  7.84it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.24it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target KDR - DES: 0.0000, MAE_top2k: 0.0329, n_DE: 17
INFO:ZeroShotPerturbation:Predicting for target: EIF4B
INFO:ZeroShotPerturbation:Processing 1585 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3860.38it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3380271.74it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▌        | 55/362 [00:00<00:00, 530.28it/s]Processing batches:  30%|███       | 109/362 [00:00<00:00, 419.38it/s]Processing batches:  43%|████▎     | 154/362 [00:00<00:00, 431.07it/s]Processing batches:  55%|█████▍    | 199/362 [00:02<00:03, 48.38it/s] Processing batches:  63%|██████▎   | 227/362 [00:06<00:06, 21.30it/s]Processing batches:  68%|██████▊   | 245/362 [00:08<00:07, 16.21it/s]Processing batches:  71%|███████▏  | 258/362 [00:10<00:07, 13.87it/s]Processing batches:  74%|███████▍  | 267/362 [00:11<00:07, 12.57it/s]Processing batches:  75%|███████▌  | 273/362 [00:12<00:07, 11.76it/s]Processing batches:  77%|███████▋  | 278/362 [00:12<00:07, 11.14it/s]Processing batches:  78%|███████▊  | 282/362 [00:13<00:07, 10.65it/s]Processing batches:  79%|███████▊  | 285/362 [00:13<00:07, 10.25it/s]Processing batches:  79%|███████▉  | 287/362 [00:13<00:07,  9.97it/s]Processing batches:  80%|███████▉  | 289/362 [00:14<00:07,  9.67it/s]Processing batches:  80%|████████  | 291/362 [00:14<00:07,  9.37it/s]Processing batches:  81%|████████  | 293/362 [00:14<00:07,  9.06it/s]Processing batches:  81%|████████▏ | 295/362 [00:14<00:07,  8.76it/s]Processing batches:  82%|████████▏ | 296/362 [00:14<00:07,  8.64it/s]Processing batches:  82%|████████▏ | 297/362 [00:15<00:07,  8.52it/s]Processing batches:  82%|████████▏ | 298/362 [00:15<00:07,  8.38it/s]Processing batches:  83%|████████▎ | 299/362 [00:15<00:07,  8.34it/s]Processing batches:  83%|████████▎ | 300/362 [00:15<00:07,  8.23it/s]Processing batches:  83%|████████▎ | 301/362 [00:15<00:07,  8.08it/s]Processing batches:  83%|████████▎ | 302/362 [00:15<00:07,  7.98it/s]Processing batches:  84%|████████▎ | 303/362 [00:15<00:07,  7.92it/s]Processing batches:  84%|████████▍ | 304/362 [00:15<00:07,  7.93it/s]Processing batches:  84%|████████▍ | 305/362 [00:16<00:07,  7.93it/s]Processing batches:  85%|████████▍ | 306/362 [00:16<00:07,  7.94it/s]Processing batches:  85%|████████▍ | 307/362 [00:16<00:06,  7.89it/s]Processing batches:  85%|████████▌ | 308/362 [00:16<00:06,  7.89it/s]Processing batches:  85%|████████▌ | 309/362 [00:16<00:06,  7.85it/s]Processing batches:  86%|████████▌ | 310/362 [00:16<00:06,  7.88it/s]Processing batches:  86%|████████▌ | 311/362 [00:16<00:06,  7.88it/s]Processing batches:  86%|████████▌ | 312/362 [00:16<00:06,  7.90it/s]Processing batches:  86%|████████▋ | 313/362 [00:17<00:06,  7.90it/s]Processing batches:  87%|████████▋ | 314/362 [00:17<00:06,  7.91it/s]Processing batches:  87%|████████▋ | 315/362 [00:17<00:05,  7.91it/s]Processing batches:  87%|████████▋ | 316/362 [00:17<00:05,  7.90it/s]Processing batches:  88%|████████▊ | 317/362 [00:17<00:05,  7.89it/s]Processing batches:  88%|████████▊ | 318/362 [00:17<00:05,  7.90it/s]Processing batches:  88%|████████▊ | 319/362 [00:17<00:05,  7.91it/s]Processing batches:  88%|████████▊ | 320/362 [00:18<00:05,  7.88it/s]Processing batches:  89%|████████▊ | 321/362 [00:18<00:05,  7.91it/s]Processing batches:  89%|████████▉ | 322/362 [00:18<00:05,  7.97it/s]Processing batches:  89%|████████▉ | 323/362 [00:18<00:04,  8.00it/s]Processing batches:  90%|████████▉ | 324/362 [00:18<00:04,  7.97it/s]Processing batches:  90%|████████▉ | 325/362 [00:18<00:04,  7.93it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:04,  7.90it/s]Processing batches:  90%|█████████ | 327/362 [00:18<00:04,  7.87it/s]Processing batches:  91%|█████████ | 328/362 [00:19<00:04,  7.82it/s]Processing batches:  91%|█████████ | 329/362 [00:19<00:04,  7.81it/s]Processing batches:  91%|█████████ | 330/362 [00:19<00:04,  7.77it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:03,  7.77it/s]Processing batches:  92%|█████████▏| 332/362 [00:19<00:03,  7.80it/s]Processing batches:  92%|█████████▏| 333/362 [00:19<00:03,  7.81it/s]Processing batches:  92%|█████████▏| 334/362 [00:19<00:03,  7.80it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:03,  7.86it/s]Processing batches:  93%|█████████▎| 336/362 [00:20<00:03,  7.84it/s]Processing batches:  93%|█████████▎| 337/362 [00:20<00:03,  7.81it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:03,  7.82it/s]Processing batches:  94%|█████████▎| 339/362 [00:20<00:02,  7.87it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  7.88it/s]Processing batches:  94%|█████████▍| 341/362 [00:20<00:02,  7.90it/s]Processing batches:  94%|█████████▍| 342/362 [00:20<00:02,  7.95it/s]Processing batches:  95%|█████████▍| 343/362 [00:20<00:02,  7.95it/s]Processing batches:  95%|█████████▌| 344/362 [00:21<00:02,  7.96it/s]Processing batches:  95%|█████████▌| 345/362 [00:21<00:02,  7.98it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:02,  7.92it/s]Processing batches:  96%|█████████▌| 347/362 [00:21<00:01,  7.90it/s]Processing batches:  96%|█████████▌| 348/362 [00:21<00:01,  7.86it/s]Processing batches:  96%|█████████▋| 349/362 [00:21<00:01,  7.94it/s]Processing batches:  97%|█████████▋| 350/362 [00:21<00:01,  7.92it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  7.90it/s]Processing batches:  97%|█████████▋| 352/362 [00:22<00:01,  7.89it/s]Processing batches:  98%|█████████▊| 353/362 [00:22<00:01,  7.89it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:01,  7.86it/s]Processing batches:  98%|█████████▊| 355/362 [00:22<00:00,  7.90it/s]Processing batches:  98%|█████████▊| 356/362 [00:22<00:00,  7.95it/s]Processing batches:  99%|█████████▊| 357/362 [00:22<00:00,  7.94it/s]Processing batches:  99%|█████████▉| 358/362 [00:22<00:00,  7.96it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  7.96it/s]Processing batches:  99%|█████████▉| 360/362 [00:23<00:00,  7.98it/s]Processing batches: 100%|█████████▉| 361/362 [00:23<00:00,  8.03it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.55it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3688.92it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3342870.46it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 51/362 [00:00<00:00, 508.56it/s]Processing batches:  28%|██▊       | 102/362 [00:00<00:00, 424.59it/s]Processing batches:  40%|████      | 146/362 [00:00<00:00, 381.97it/s]Processing batches:  51%|█████     | 185/362 [00:00<00:01, 139.50it/s]Processing batches:  59%|█████▊    | 212/362 [00:04<00:05, 27.64it/s] Processing batches:  63%|██████▎   | 229/362 [00:06<00:06, 19.20it/s]Processing batches:  67%|██████▋   | 241/362 [00:07<00:07, 15.87it/s]Processing batches:  69%|██████▉   | 249/362 [00:08<00:07, 14.19it/s]Processing batches:  70%|███████   | 255/362 [00:09<00:08, 13.07it/s]Processing batches:  72%|███████▏  | 260/362 [00:10<00:08, 12.16it/s]Processing batches:  73%|███████▎  | 264/362 [00:10<00:08, 11.48it/s]Processing batches:  74%|███████▍  | 267/362 [00:10<00:08, 10.97it/s]Processing batches:  74%|███████▍  | 269/362 [00:11<00:08, 10.60it/s]Processing batches:  75%|███████▍  | 271/362 [00:11<00:08, 10.23it/s]Processing batches:  75%|███████▌  | 273/362 [00:11<00:09,  9.85it/s]Processing batches:  76%|███████▌  | 275/362 [00:11<00:09,  9.52it/s]Processing batches:  77%|███████▋  | 277/362 [00:12<00:09,  9.25it/s]Processing batches:  77%|███████▋  | 279/362 [00:12<00:09,  9.04it/s]Processing batches:  77%|███████▋  | 280/362 [00:12<00:09,  8.94it/s]Processing batches:  78%|███████▊  | 281/362 [00:12<00:09,  8.80it/s]Processing batches:  78%|███████▊  | 282/362 [00:12<00:09,  8.69it/s]Processing batches:  78%|███████▊  | 283/362 [00:12<00:09,  8.61it/s]Processing batches:  78%|███████▊  | 284/362 [00:12<00:09,  8.54it/s]Processing batches:  79%|███████▊  | 285/362 [00:13<00:09,  8.48it/s]Processing batches:  79%|███████▉  | 286/362 [00:13<00:09,  8.43it/s]Processing batches:  79%|███████▉  | 287/362 [00:13<00:08,  8.40it/s]Processing batches:  80%|███████▉  | 288/362 [00:13<00:08,  8.37it/s]Processing batches:  80%|███████▉  | 289/362 [00:13<00:08,  8.29it/s]Processing batches:  80%|████████  | 290/362 [00:13<00:08,  8.34it/s]Processing batches:  80%|████████  | 291/362 [00:13<00:08,  8.35it/s]Processing batches:  81%|████████  | 292/362 [00:13<00:08,  8.32it/s]Processing batches:  81%|████████  | 293/362 [00:14<00:08,  8.30it/s]Processing batches:  81%|████████  | 294/362 [00:14<00:08,  8.20it/s]Processing batches:  81%|████████▏ | 295/362 [00:14<00:08,  8.27it/s]Processing batches:  82%|████████▏ | 296/362 [00:14<00:07,  8.28it/s]Processing batches:  82%|████████▏ | 297/362 [00:14<00:07,  8.21it/s]Processing batches:  82%|████████▏ | 298/362 [00:14<00:07,  8.21it/s]Processing batches:  83%|████████▎ | 299/362 [00:14<00:07,  8.24it/s]Processing batches:  83%|████████▎ | 300/362 [00:14<00:07,  8.24it/s]Processing batches:  83%|████████▎ | 301/362 [00:14<00:07,  8.19it/s]Processing batches:  83%|████████▎ | 302/362 [00:15<00:07,  8.19it/s]Processing batches:  84%|████████▎ | 303/362 [00:15<00:07,  8.20it/s]Processing batches:  84%|████████▍ | 304/362 [00:15<00:07,  8.22it/s]Processing batches:  84%|████████▍ | 305/362 [00:15<00:06,  8.21it/s]Processing batches:  85%|████████▍ | 306/362 [00:15<00:06,  8.19it/s]Processing batches:  85%|████████▍ | 307/362 [00:15<00:06,  8.19it/s]Processing batches:  85%|████████▌ | 308/362 [00:15<00:06,  8.20it/s]Processing batches:  85%|████████▌ | 309/362 [00:15<00:06,  8.16it/s]Processing batches:  86%|████████▌ | 310/362 [00:16<00:06,  8.11it/s]Processing batches:  86%|████████▌ | 311/362 [00:16<00:06,  8.24it/s]Processing batches:  86%|████████▌ | 312/362 [00:16<00:06,  8.24it/s]Processing batches:  86%|████████▋ | 313/362 [00:16<00:05,  8.25it/s]Processing batches:  87%|████████▋ | 314/362 [00:16<00:05,  8.25it/s]Processing batches:  87%|████████▋ | 315/362 [00:16<00:05,  8.24it/s]Processing batches:  87%|████████▋ | 316/362 [00:16<00:05,  8.21it/s]Processing batches:  88%|████████▊ | 317/362 [00:16<00:05,  8.25it/s]Processing batches:  88%|████████▊ | 318/362 [00:17<00:05,  8.31it/s]Processing batches:  88%|████████▊ | 319/362 [00:17<00:05,  8.32it/s]Processing batches:  88%|████████▊ | 320/362 [00:17<00:05,  8.30it/s]Processing batches:  89%|████████▊ | 321/362 [00:17<00:04,  8.31it/s]Processing batches:  89%|████████▉ | 322/362 [00:17<00:04,  8.34it/s]Processing batches:  89%|████████▉ | 323/362 [00:17<00:04,  8.36it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:04,  8.36it/s]Processing batches:  90%|████████▉ | 325/362 [00:17<00:04,  8.35it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:04,  8.29it/s]Processing batches:  90%|█████████ | 327/362 [00:18<00:04,  8.26it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:04,  8.18it/s]Processing batches:  91%|█████████ | 329/362 [00:18<00:03,  8.38it/s]Processing batches:  91%|█████████ | 330/362 [00:18<00:03,  8.37it/s]Processing batches:  91%|█████████▏| 331/362 [00:18<00:03,  8.35it/s]Processing batches:  92%|█████████▏| 332/362 [00:18<00:03,  8.32it/s]Processing batches:  92%|█████████▏| 333/362 [00:18<00:03,  8.30it/s]Processing batches:  92%|█████████▏| 334/362 [00:18<00:03,  8.13it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:03,  8.21it/s]Processing batches:  93%|█████████▎| 336/362 [00:19<00:03,  8.33it/s]Processing batches:  93%|█████████▎| 337/362 [00:19<00:03,  8.22it/s]Processing batches:  93%|█████████▎| 338/362 [00:19<00:02,  8.28it/s]Processing batches:  94%|█████████▎| 339/362 [00:19<00:02,  8.27it/s]Processing batches:  94%|█████████▍| 340/362 [00:19<00:02,  8.25it/s]Processing batches:  94%|█████████▍| 341/362 [00:19<00:02,  8.15it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  8.25it/s]Processing batches:  95%|█████████▍| 343/362 [00:20<00:02,  8.25it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  8.26it/s]Processing batches:  95%|█████████▌| 345/362 [00:20<00:02,  8.21it/s]Processing batches:  96%|█████████▌| 346/362 [00:20<00:01,  8.21it/s]Processing batches:  96%|█████████▌| 347/362 [00:20<00:01,  8.19it/s]Processing batches:  96%|█████████▌| 348/362 [00:20<00:01,  8.19it/s]Processing batches:  96%|█████████▋| 349/362 [00:20<00:01,  8.20it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  8.22it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  8.22it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  8.19it/s]Processing batches:  98%|█████████▊| 353/362 [00:21<00:01,  8.25it/s]Processing batches:  98%|█████████▊| 354/362 [00:21<00:00,  8.22it/s]Processing batches:  98%|█████████▊| 355/362 [00:21<00:00,  8.25it/s]Processing batches:  98%|█████████▊| 356/362 [00:21<00:00,  8.24it/s]Processing batches:  99%|█████████▊| 357/362 [00:21<00:00,  8.22it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  8.22it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.26it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  8.18it/s]Processing batches: 100%|█████████▉| 361/362 [00:22<00:00,  8.31it/s]Processing batches: 100%|██████████| 362/362 [00:22<00:00, 16.21it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target EIF4B - DES: 0.0503, MAE_top2k: 0.1126, n_DE: 4866
INFO:ZeroShotPerturbation:Predicting for target: SIX4
INFO:ZeroShotPerturbation:Processing 642 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5813.31it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3318005.53it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  21%|██        | 75/362 [00:00<00:00, 738.68it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 886.97it/s]Processing batches:  75%|███████▍  | 270/362 [00:09<00:04, 21.11it/s] Processing batches:  88%|████████▊ | 319/362 [00:14<00:02, 16.04it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:00, 14.24it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.88it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5637.51it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3325280.26it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  16%|█▋        | 59/362 [00:00<00:00, 584.94it/s]Processing batches:  33%|███▎      | 118/362 [00:00<00:00, 439.05it/s]Processing batches:  46%|████▌     | 165/362 [00:00<00:00, 448.23it/s]Processing batches:  59%|█████▊    | 212/362 [00:03<00:03, 37.66it/s] Processing batches:  67%|██████▋   | 241/362 [00:06<00:05, 22.08it/s]Processing batches:  72%|███████▏  | 260/362 [00:08<00:05, 17.79it/s]Processing batches:  75%|███████▌  | 273/362 [00:09<00:05, 15.75it/s]Processing batches:  78%|███████▊  | 282/362 [00:10<00:05, 14.55it/s]Processing batches:  80%|███████▉  | 289/362 [00:11<00:05, 13.66it/s]Processing batches:  81%|████████  | 294/362 [00:12<00:05, 13.04it/s]Processing batches:  82%|████████▏ | 298/362 [00:12<00:05, 12.54it/s]Processing batches:  83%|████████▎ | 301/362 [00:12<00:05, 12.15it/s]Processing batches:  84%|████████▍ | 304/362 [00:13<00:04, 11.74it/s]Processing batches:  85%|████████▍ | 306/362 [00:13<00:04, 11.46it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:04, 11.16it/s]Processing batches:  86%|████████▌ | 310/362 [00:13<00:04, 10.88it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:04, 10.59it/s]Processing batches:  87%|████████▋ | 314/362 [00:14<00:04, 10.36it/s]Processing batches:  87%|████████▋ | 316/362 [00:14<00:04, 10.18it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:04, 10.04it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:04,  9.87it/s]Processing batches:  89%|████████▉ | 322/362 [00:15<00:04,  9.85it/s]Processing batches:  89%|████████▉ | 323/362 [00:15<00:03,  9.83it/s]Processing batches:  90%|████████▉ | 324/362 [00:15<00:03,  9.81it/s]Processing batches:  90%|████████▉ | 325/362 [00:15<00:03,  9.76it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03,  9.56it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03,  9.78it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03,  9.76it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03,  9.71it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:03,  9.74it/s]Processing batches:  92%|█████████▏| 332/362 [00:16<00:03,  9.73it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:02,  9.72it/s]Processing batches:  92%|█████████▏| 334/362 [00:16<00:02,  9.71it/s]Processing batches:  93%|█████████▎| 335/362 [00:16<00:02,  9.64it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.73it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.72it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.72it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.72it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02,  9.72it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.72it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:02,  9.74it/s]Processing batches:  95%|█████████▍| 343/362 [00:17<00:01,  9.72it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01,  9.73it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.73it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.71it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.65it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.69it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.72it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.72it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.71it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.73it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.27it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.39it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.49it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.55it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.59it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.62it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.58it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.61it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00,  9.65it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.94it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target SIX4 - DES: 0.0000, MAE_top2k: 0.0535, n_DE: 92
INFO:ZeroShotPerturbation:Predicting for target: TFAM
INFO:ZeroShotPerturbation:Processing 1105 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4691.62it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3349662.81it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  27%|██▋       | 99/362 [00:00<00:00, 987.55it/s]Processing batches:  55%|█████▍    | 198/362 [00:02<00:02, 77.88it/s]Processing batches:  67%|██████▋   | 242/362 [00:07<00:04, 24.58it/s]Processing batches:  74%|███████▍  | 267/362 [00:10<00:05, 18.46it/s]Processing batches:  78%|███████▊  | 282/362 [00:11<00:04, 16.05it/s]Processing batches:  81%|████████  | 292/362 [00:13<00:04, 14.66it/s]Processing batches:  83%|████████▎ | 299/362 [00:13<00:04, 13.71it/s]Processing batches:  84%|████████▍ | 304/362 [00:14<00:04, 12.98it/s]Processing batches:  85%|████████▌ | 308/362 [00:14<00:04, 12.37it/s]Processing batches:  86%|████████▌ | 311/362 [00:15<00:04, 11.87it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:04, 11.36it/s]Processing batches:  87%|████████▋ | 316/362 [00:15<00:04, 11.00it/s]Processing batches:  88%|████████▊ | 318/362 [00:16<00:04, 10.62it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04, 10.27it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  9.97it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:03,  9.73it/s]Processing batches:  90%|█████████ | 326/362 [00:16<00:03,  9.45it/s]Processing batches:  90%|█████████ | 327/362 [00:17<00:03,  9.32it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03,  9.18it/s]Processing batches:  91%|█████████ | 329/362 [00:17<00:03,  9.07it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  8.99it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  8.90it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  8.87it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  8.81it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  8.71it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:03,  8.75it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:02,  8.72it/s]Processing batches:  93%|█████████▎| 337/362 [00:18<00:02,  8.68it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.67it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.72it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.71it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  8.76it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  8.75it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  8.76it/s]Processing batches:  95%|█████████▌| 344/362 [00:19<00:02,  8.77it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01,  8.77it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  8.76it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.72it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.64it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  8.74it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  8.72it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  8.68it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  8.68it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:01,  8.68it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  8.61it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  8.61it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  8.76it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.75it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00,  8.69it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  8.80it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  8.84it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  8.82it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 17.21it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4517.29it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3399364.19it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  12%|█▏        | 42/362 [00:00<00:00, 369.88it/s]Processing batches:  26%|██▌       | 95/362 [00:00<00:00, 451.29it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 605.04it/s]Processing batches:  67%|██████▋   | 242/362 [00:07<00:05, 22.94it/s] Processing batches:  77%|███████▋  | 279/362 [00:11<00:05, 16.53it/s]Processing batches:  84%|████████▎ | 303/362 [00:14<00:04, 14.24it/s]Processing batches:  88%|████████▊ | 320/362 [00:15<00:03, 12.97it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:02, 12.20it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:01, 11.68it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01, 11.29it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01, 10.95it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00, 10.65it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00, 10.43it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00, 10.20it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.51it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target TFAM - DES: 0.0243, MAE_top2k: 0.1084, n_DE: 4151
INFO:ZeroShotPerturbation:Predicting for target: MAST2
INFO:ZeroShotPerturbation:Processing 1029 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4774.39it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3248083.96it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  22%|██▏       | 79/362 [00:00<00:00, 789.73it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 883.79it/s]Processing batches:  75%|███████▍  | 270/362 [00:10<00:04, 19.32it/s] Processing batches:  75%|███████▍  | 271/362 [00:10<00:04, 19.16it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:03, 13.77it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:00, 12.23it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.42it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4733.98it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3360647.74it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  12%|█▏        | 44/362 [00:00<00:00, 386.59it/s]Processing batches:  23%|██▎       | 83/362 [00:00<00:00, 295.68it/s]Processing batches:  34%|███▍      | 124/362 [00:00<00:00, 328.16it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 398.79it/s]Processing batches:  62%|██████▏   | 223/362 [00:05<00:05, 25.73it/s] Processing batches:  69%|██████▉   | 250/362 [00:08<00:06, 17.87it/s]Processing batches:  74%|███████▍  | 268/362 [00:10<00:06, 15.15it/s]Processing batches:  78%|███████▊  | 281/362 [00:11<00:05, 13.67it/s]Processing batches:  80%|████████  | 290/362 [00:12<00:05, 12.77it/s]Processing batches:  82%|████████▏ | 297/362 [00:13<00:05, 12.09it/s]Processing batches:  83%|████████▎ | 302/362 [00:13<00:05, 11.60it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:04, 11.20it/s]Processing batches:  85%|████████▌ | 309/362 [00:14<00:04, 10.87it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:04, 10.55it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:04, 10.34it/s]Processing batches:  87%|████████▋ | 316/362 [00:15<00:04, 10.11it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:04,  9.89it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04,  9.64it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  9.51it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:04,  9.40it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:03,  9.33it/s]Processing batches:  90%|█████████ | 326/362 [00:16<00:03,  9.26it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:03,  9.22it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03,  9.13it/s]Processing batches:  91%|█████████ | 329/362 [00:17<00:03,  9.09it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  9.10it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  9.02it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  9.04it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  9.02it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  8.97it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:02,  9.01it/s]Processing batches:  93%|█████████▎| 336/362 [00:17<00:02,  8.95it/s]Processing batches:  93%|█████████▎| 337/362 [00:17<00:02,  8.92it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.88it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.88it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.92it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  8.99it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  9.00it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  9.00it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:02,  8.91it/s]Processing batches:  95%|█████████▌| 345/362 [00:18<00:01,  8.92it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01,  8.91it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.92it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.93it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  9.02it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  8.98it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  9.02it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  8.96it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:01,  8.95it/s]Processing batches:  98%|█████████▊| 354/362 [00:19<00:00,  8.91it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  8.95it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  9.02it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.93it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00,  8.96it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  8.98it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  9.03it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  9.04it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.54it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MAST2 - DES: 0.0000, MAE_top2k: 0.0384, n_DE: 48
INFO:ZeroShotPerturbation:Predicting for target: SMAGP
INFO:ZeroShotPerturbation:Processing 788 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5305.89it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3294509.35it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  30%|███       | 109/362 [00:00<00:00, 1084.72it/s]Processing batches:  60%|██████    | 218/362 [00:04<00:03, 44.25it/s]  Processing batches:  73%|███████▎  | 265/362 [00:09<00:04, 21.98it/s]Processing batches:  80%|████████  | 291/362 [00:12<00:03, 17.78it/s]Processing batches:  85%|████████▍ | 307/362 [00:13<00:03, 15.80it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:03, 14.59it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:02, 13.74it/s]Processing batches:  92%|█████████▏| 332/362 [00:16<00:02, 13.08it/s]Processing batches:  93%|█████████▎| 336/362 [00:17<00:02, 12.62it/s]Processing batches:  94%|█████████▎| 339/362 [00:17<00:01, 12.23it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:01, 11.83it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01, 11.51it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01, 11.19it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01, 10.84it/s]Processing batches:  97%|█████████▋| 350/362 [00:18<00:01, 10.54it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:00, 10.23it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.97it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  9.73it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00,  9.72it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00,  9.67it/s]Processing batches:  99%|█████████▉| 359/362 [00:19<00:00,  9.58it/s]Processing batches:  99%|█████████▉| 360/362 [00:19<00:00,  9.49it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00,  9.48it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.30it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5210.32it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3313076.86it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 62/362 [00:00<00:00, 561.92it/s]Processing batches:  33%|███▎      | 119/362 [00:00<00:00, 507.86it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 491.70it/s]Processing batches:  64%|██████▍   | 231/362 [00:05<00:05, 25.84it/s] Processing batches:  72%|███████▏  | 262/362 [00:08<00:05, 18.25it/s]Processing batches:  78%|███████▊  | 282/362 [00:11<00:05, 15.61it/s]Processing batches:  82%|████████▏ | 296/362 [00:12<00:04, 14.21it/s]Processing batches:  85%|████████▍ | 306/362 [00:13<00:04, 13.27it/s]Processing batches:  86%|████████▋ | 313/362 [00:14<00:03, 12.64it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:03, 12.17it/s]Processing batches:  89%|████████▉ | 322/362 [00:15<00:03, 11.79it/s]Processing batches:  90%|████████▉ | 325/362 [00:15<00:03, 11.49it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03, 11.14it/s]Processing batches:  91%|█████████ | 330/362 [00:16<00:02, 10.88it/s]Processing batches:  92%|█████████▏| 332/362 [00:16<00:02, 10.68it/s]Processing batches:  92%|█████████▏| 334/362 [00:16<00:02, 10.45it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02, 10.23it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:02,  9.99it/s]Processing batches:  94%|█████████▍| 340/362 [00:17<00:02,  9.88it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:02,  9.78it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01,  9.66it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.64it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.50it/s]Processing batches:  96%|█████████▌| 347/362 [00:18<00:01,  9.45it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01,  9.35it/s]Processing batches:  96%|█████████▋| 349/362 [00:18<00:01,  9.47it/s]Processing batches:  97%|█████████▋| 350/362 [00:18<00:01,  9.31it/s]Processing batches:  97%|█████████▋| 351/362 [00:18<00:01,  9.48it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.32it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.45it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.47it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.38it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  9.45it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00,  9.40it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00,  9.46it/s]Processing batches:  99%|█████████▉| 359/362 [00:19<00:00,  9.44it/s]Processing batches:  99%|█████████▉| 360/362 [00:19<00:00,  9.45it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00,  9.45it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.46it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target SMAGP - DES: 0.0000, MAE_top2k: 0.0809, n_DE: 898
INFO:ZeroShotPerturbation:Predicting for target: XRCC4
INFO:ZeroShotPerturbation:Processing 591 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5979.05it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3281820.07it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  26%|██▌       | 95/362 [00:00<00:00, 894.65it/s]Processing batches:  51%|█████     | 185/362 [00:00<00:00, 229.98it/s]Processing batches:  64%|██████▍   | 231/362 [00:05<00:04, 29.57it/s] Processing batches:  71%|███████   | 257/362 [00:08<00:04, 21.13it/s]Processing batches:  75%|███████▌  | 273/362 [00:09<00:04, 18.02it/s]Processing batches:  78%|███████▊  | 284/362 [00:10<00:04, 16.26it/s]Processing batches:  81%|████████  | 292/362 [00:11<00:04, 15.08it/s]Processing batches:  82%|████████▏ | 298/362 [00:12<00:04, 14.20it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:04, 13.58it/s]Processing batches:  84%|████████▍ | 305/362 [00:13<00:04, 13.07it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:04, 12.53it/s]Processing batches:  86%|████████▌ | 310/362 [00:13<00:04, 12.13it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:04, 11.75it/s]Processing batches:  87%|████████▋ | 314/362 [00:14<00:04, 11.35it/s]Processing batches:  87%|████████▋ | 316/362 [00:14<00:04, 10.99it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:04, 10.68it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:04, 10.39it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:03, 10.18it/s]Processing batches:  90%|████████▉ | 324/362 [00:15<00:03, 10.19it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03, 10.03it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03,  9.88it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03,  9.82it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03,  9.75it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:03,  9.70it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:03,  9.67it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:02,  9.69it/s]Processing batches:  92%|█████████▏| 334/362 [00:16<00:02,  9.63it/s]Processing batches:  93%|█████████▎| 335/362 [00:16<00:02,  9.66it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.64it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.61it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.58it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.61it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02,  9.60it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.64it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:02,  9.64it/s]Processing batches:  95%|█████████▍| 343/362 [00:17<00:01,  9.65it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01,  9.69it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.66it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.63it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.61it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.58it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.64it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.59it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.60it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.59it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.57it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.55it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.58it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.58it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.63it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.63it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.62it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.64it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00,  9.62it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.97it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5656.51it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3350698.85it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  18%|█▊        | 64/362 [00:00<00:00, 637.95it/s]Processing batches:  35%|███▌      | 128/362 [00:00<00:00, 563.03it/s]Processing batches:  51%|█████     | 185/362 [00:00<00:00, 198.91it/s]Processing batches:  61%|██████    | 221/362 [00:04<00:04, 30.88it/s] Processing batches:  67%|██████▋   | 244/362 [00:06<00:05, 21.37it/s]Processing batches:  72%|███████▏  | 259/362 [00:08<00:05, 17.94it/s]Processing batches:  74%|███████▍  | 269/362 [00:09<00:05, 16.07it/s]Processing batches:  76%|███████▌  | 276/362 [00:10<00:05, 14.93it/s]Processing batches:  78%|███████▊  | 282/362 [00:10<00:05, 14.00it/s]Processing batches:  79%|███████▉  | 286/362 [00:11<00:05, 13.37it/s]Processing batches:  80%|███████▉  | 289/362 [00:11<00:05, 12.90it/s]Processing batches:  81%|████████  | 292/362 [00:11<00:05, 12.40it/s]Processing batches:  81%|████████  | 294/362 [00:12<00:05, 12.05it/s]Processing batches:  82%|████████▏ | 296/362 [00:12<00:05, 11.67it/s]Processing batches:  82%|████████▏ | 298/362 [00:12<00:05, 11.32it/s]Processing batches:  83%|████████▎ | 300/362 [00:12<00:05, 10.97it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:05, 10.65it/s]Processing batches:  84%|████████▍ | 304/362 [00:13<00:05, 10.40it/s]Processing batches:  85%|████████▍ | 306/362 [00:13<00:05, 10.08it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:05, 10.09it/s]Processing batches:  86%|████████▌ | 310/362 [00:13<00:05,  9.92it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:05,  9.84it/s]Processing batches:  86%|████████▋ | 313/362 [00:13<00:04,  9.82it/s]Processing batches:  87%|████████▋ | 314/362 [00:14<00:04,  9.77it/s]Processing batches:  87%|████████▋ | 315/362 [00:14<00:04,  9.68it/s]Processing batches:  87%|████████▋ | 316/362 [00:14<00:04,  9.67it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:04,  9.73it/s]Processing batches:  88%|████████▊ | 319/362 [00:14<00:04,  9.72it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:04,  9.74it/s]Processing batches:  89%|████████▊ | 321/362 [00:14<00:04,  9.70it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:04,  9.74it/s]Processing batches:  89%|████████▉ | 323/362 [00:15<00:04,  9.55it/s]Processing batches:  90%|████████▉ | 325/362 [00:15<00:03,  9.76it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03,  9.76it/s]Processing batches:  90%|█████████ | 327/362 [00:15<00:03,  9.78it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03,  9.73it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03,  9.74it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03,  9.64it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:03,  9.75it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:02,  9.78it/s]Processing batches:  92%|█████████▏| 334/362 [00:16<00:02,  9.73it/s]Processing batches:  93%|█████████▎| 335/362 [00:16<00:02,  9.74it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.77it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.72it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.74it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.78it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02,  9.70it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.67it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:02,  9.75it/s]Processing batches:  95%|█████████▍| 343/362 [00:17<00:01,  9.72it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01,  9.69it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.71it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.59it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.55it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.63it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.68it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.53it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.66it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.64it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.58it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.58it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.64it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.63it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.64it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.70it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.71it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.66it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 19.04it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target XRCC4 - DES: 0.0015, MAE_top2k: 0.0899, n_DE: 2688
INFO:ZeroShotPerturbation:Predicting for target: HMGN1
INFO:ZeroShotPerturbation:Processing 2004 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3354.10it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3358117.81it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   8%|▊         | 30/362 [00:00<00:01, 274.93it/s]Processing batches:  17%|█▋        | 62/362 [00:00<00:01, 298.56it/s]Processing batches:  31%|███       | 113/362 [00:00<00:00, 388.37it/s]Processing batches:  42%|████▏     | 152/362 [00:00<00:00, 381.70it/s]Processing batches:  53%|█████▎    | 191/362 [00:01<00:02, 66.55it/s] Processing batches:  60%|█████▉    | 217/362 [00:05<00:06, 21.92it/s]Processing batches:  65%|██████▍   | 235/362 [00:07<00:08, 15.70it/s]Processing batches:  68%|██████▊   | 247/362 [00:09<00:08, 13.26it/s]Processing batches:  71%|███████   | 256/362 [00:10<00:08, 11.86it/s]Processing batches:  72%|███████▏  | 262/362 [00:11<00:09, 11.04it/s]Processing batches:  74%|███████▍  | 267/362 [00:12<00:09, 10.35it/s]Processing batches:  75%|███████▍  | 271/362 [00:12<00:09,  9.85it/s]Processing batches:  76%|███████▌  | 274/362 [00:13<00:09,  9.48it/s]Processing batches:  76%|███████▌  | 276/362 [00:13<00:09,  9.21it/s]Processing batches:  77%|███████▋  | 278/362 [00:13<00:09,  8.94it/s]Processing batches:  77%|███████▋  | 280/362 [00:13<00:09,  8.73it/s]Processing batches:  78%|███████▊  | 282/362 [00:14<00:09,  8.44it/s]Processing batches:  78%|███████▊  | 284/362 [00:14<00:09,  8.23it/s]Processing batches:  79%|███████▊  | 285/362 [00:14<00:09,  8.11it/s]Processing batches:  79%|███████▉  | 286/362 [00:14<00:09,  8.02it/s]Processing batches:  79%|███████▉  | 287/362 [00:14<00:09,  7.93it/s]Processing batches:  80%|███████▉  | 288/362 [00:15<00:09,  7.85it/s]Processing batches:  80%|███████▉  | 289/362 [00:15<00:09,  7.74it/s]Processing batches:  80%|████████  | 290/362 [00:15<00:09,  7.70it/s]Processing batches:  80%|████████  | 291/362 [00:15<00:09,  7.63it/s]Processing batches:  81%|████████  | 292/362 [00:15<00:09,  7.50it/s]Processing batches:  81%|████████  | 293/362 [00:15<00:09,  7.47it/s]Processing batches:  81%|████████  | 294/362 [00:15<00:09,  7.44it/s]Processing batches:  81%|████████▏ | 295/362 [00:15<00:09,  7.32it/s]Processing batches:  82%|████████▏ | 296/362 [00:16<00:08,  7.37it/s]Processing batches:  82%|████████▏ | 297/362 [00:16<00:08,  7.28it/s]Processing batches:  82%|████████▏ | 298/362 [00:16<00:08,  7.36it/s]Processing batches:  83%|████████▎ | 299/362 [00:16<00:08,  7.42it/s]Processing batches:  83%|████████▎ | 300/362 [00:16<00:08,  7.45it/s]Processing batches:  83%|████████▎ | 301/362 [00:16<00:08,  7.34it/s]Processing batches:  83%|████████▎ | 302/362 [00:16<00:08,  7.29it/s]Processing batches:  84%|████████▎ | 303/362 [00:17<00:08,  7.30it/s]Processing batches:  84%|████████▍ | 304/362 [00:17<00:07,  7.34it/s]Processing batches:  84%|████████▍ | 305/362 [00:17<00:07,  7.35it/s]Processing batches:  85%|████████▍ | 306/362 [00:17<00:07,  7.36it/s]Processing batches:  85%|████████▍ | 307/362 [00:17<00:07,  7.36it/s]Processing batches:  85%|████████▌ | 308/362 [00:17<00:07,  7.30it/s]Processing batches:  85%|████████▌ | 309/362 [00:17<00:07,  7.34it/s]Processing batches:  86%|████████▌ | 310/362 [00:18<00:07,  7.31it/s]Processing batches:  86%|████████▌ | 311/362 [00:18<00:06,  7.33it/s]Processing batches:  86%|████████▌ | 312/362 [00:18<00:06,  7.31it/s]Processing batches:  86%|████████▋ | 313/362 [00:18<00:06,  7.32it/s]Processing batches:  87%|████████▋ | 314/362 [00:18<00:06,  7.35it/s]Processing batches:  87%|████████▋ | 315/362 [00:18<00:06,  7.38it/s]Processing batches:  87%|████████▋ | 316/362 [00:18<00:06,  7.22it/s]Processing batches:  88%|████████▊ | 317/362 [00:18<00:06,  7.35it/s]Processing batches:  88%|████████▊ | 318/362 [00:19<00:05,  7.36it/s]Processing batches:  88%|████████▊ | 319/362 [00:19<00:05,  7.43it/s]Processing batches:  88%|████████▊ | 320/362 [00:19<00:05,  7.41it/s]Processing batches:  89%|████████▊ | 321/362 [00:19<00:05,  7.29it/s]Processing batches:  89%|████████▉ | 322/362 [00:19<00:05,  7.41it/s]Processing batches:  89%|████████▉ | 323/362 [00:19<00:05,  7.59it/s]Processing batches:  90%|████████▉ | 324/362 [00:19<00:05,  7.42it/s]Processing batches:  90%|████████▉ | 325/362 [00:20<00:05,  7.40it/s]Processing batches:  90%|█████████ | 326/362 [00:20<00:04,  7.27it/s]Processing batches:  90%|█████████ | 327/362 [00:20<00:04,  7.33it/s]Processing batches:  91%|█████████ | 328/362 [00:20<00:04,  7.26it/s]Processing batches:  91%|█████████ | 329/362 [00:20<00:04,  7.32it/s]Processing batches:  91%|█████████ | 330/362 [00:20<00:04,  7.30it/s]Processing batches:  91%|█████████▏| 331/362 [00:20<00:04,  7.30it/s]Processing batches:  92%|█████████▏| 332/362 [00:21<00:04,  7.34it/s]Processing batches:  92%|█████████▏| 333/362 [00:21<00:03,  7.33it/s]Processing batches:  92%|█████████▏| 334/362 [00:21<00:03,  7.26it/s]Processing batches:  93%|█████████▎| 335/362 [00:21<00:03,  7.33it/s]Processing batches:  93%|█████████▎| 336/362 [00:21<00:03,  7.26it/s]Processing batches:  93%|█████████▎| 337/362 [00:21<00:03,  7.29it/s]Processing batches:  93%|█████████▎| 338/362 [00:21<00:03,  7.36it/s]Processing batches:  94%|█████████▎| 339/362 [00:21<00:03,  7.32it/s]Processing batches:  94%|█████████▍| 340/362 [00:22<00:03,  7.27it/s]Processing batches:  94%|█████████▍| 341/362 [00:22<00:02,  7.39it/s]Processing batches:  94%|█████████▍| 342/362 [00:22<00:02,  7.45it/s]Processing batches:  95%|█████████▍| 343/362 [00:22<00:02,  7.53it/s]Processing batches:  95%|█████████▌| 344/362 [00:22<00:02,  7.46it/s]Processing batches:  95%|█████████▌| 345/362 [00:22<00:02,  7.42it/s]Processing batches:  96%|█████████▌| 346/362 [00:22<00:02,  7.42it/s]Processing batches:  96%|█████████▌| 347/362 [00:23<00:02,  7.44it/s]Processing batches:  96%|█████████▌| 348/362 [00:23<00:01,  7.35it/s]Processing batches:  96%|█████████▋| 349/362 [00:23<00:01,  7.48it/s]Processing batches:  97%|█████████▋| 350/362 [00:23<00:01,  7.41it/s]Processing batches:  97%|█████████▋| 351/362 [00:23<00:01,  7.41it/s]Processing batches:  97%|█████████▋| 352/362 [00:23<00:01,  7.41it/s]Processing batches:  98%|█████████▊| 353/362 [00:23<00:01,  7.41it/s]Processing batches:  98%|█████████▊| 354/362 [00:24<00:01,  7.42it/s]Processing batches:  98%|█████████▊| 355/362 [00:24<00:00,  7.39it/s]Processing batches:  98%|█████████▊| 356/362 [00:24<00:00,  7.47it/s]Processing batches:  99%|█████████▊| 357/362 [00:24<00:00,  7.45it/s]Processing batches:  99%|█████████▉| 358/362 [00:24<00:00,  7.39it/s]Processing batches:  99%|█████████▉| 359/362 [00:24<00:00,  7.40it/s]Processing batches:  99%|█████████▉| 360/362 [00:24<00:00,  7.42it/s]Processing batches: 100%|█████████▉| 361/362 [00:24<00:00,  7.50it/s]Processing batches: 100%|██████████| 362/362 [00:25<00:00, 14.46it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3240.10it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3391913.78it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   7%|▋         | 25/362 [00:00<00:01, 249.28it/s]Processing batches:  16%|█▌        | 57/362 [00:00<00:01, 281.71it/s]Processing batches:  31%|███       | 112/362 [00:00<00:00, 398.52it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 499.02it/s]Processing batches:  64%|██████▍   | 231/362 [00:06<00:06, 21.18it/s] Processing batches:  73%|███████▎  | 264/362 [00:11<00:06, 14.79it/s]Processing batches:  79%|███████▉  | 286/362 [00:14<00:06, 12.59it/s]Processing batches:  83%|████████▎ | 301/362 [00:15<00:05, 11.45it/s]Processing batches:  86%|████████▌ | 312/362 [00:17<00:04, 10.72it/s]Processing batches:  88%|████████▊ | 320/362 [00:18<00:04, 10.23it/s]Processing batches:  90%|█████████ | 326/362 [00:19<00:03,  9.87it/s]Processing batches:  91%|█████████ | 330/362 [00:19<00:03,  9.60it/s]Processing batches:  92%|█████████▏| 333/362 [00:20<00:03,  9.37it/s]Processing batches:  93%|█████████▎| 336/362 [00:20<00:02,  9.15it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:02,  8.97it/s]Processing batches:  94%|█████████▍| 340/362 [00:21<00:02,  8.81it/s]Processing batches:  94%|█████████▍| 342/362 [00:21<00:02,  8.64it/s]Processing batches:  95%|█████████▌| 344/362 [00:21<00:02,  8.48it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:01,  8.30it/s]Processing batches:  96%|█████████▌| 347/362 [00:21<00:01,  8.26it/s]Processing batches:  96%|█████████▌| 348/362 [00:22<00:01,  8.10it/s]Processing batches:  96%|█████████▋| 349/362 [00:22<00:01,  8.12it/s]Processing batches:  97%|█████████▋| 350/362 [00:22<00:01,  8.05it/s]Processing batches:  97%|█████████▋| 351/362 [00:22<00:01,  7.98it/s]Processing batches:  97%|█████████▋| 352/362 [00:22<00:01,  7.96it/s]Processing batches:  98%|█████████▊| 353/362 [00:22<00:01,  7.92it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:01,  7.84it/s]Processing batches:  98%|█████████▊| 355/362 [00:22<00:00,  7.90it/s]Processing batches:  98%|█████████▊| 356/362 [00:23<00:00,  7.80it/s]Processing batches:  99%|█████████▊| 357/362 [00:23<00:00,  7.72it/s]Processing batches:  99%|█████████▉| 358/362 [00:23<00:00,  7.84it/s]Processing batches:  99%|█████████▉| 359/362 [00:23<00:00,  7.81it/s]Processing batches:  99%|█████████▉| 360/362 [00:23<00:00,  7.80it/s]Processing batches: 100%|█████████▉| 361/362 [00:23<00:00,  7.85it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.22it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target HMGN1 - DES: 0.0000, MAE_top2k: 0.0334, n_DE: 13
INFO:ZeroShotPerturbation:Predicting for target: GSK3B
INFO:ZeroShotPerturbation:Processing 1059 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4848.91it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3318731.57it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  25%|██▌       | 91/362 [00:00<00:00, 843.17it/s]Processing batches:  49%|████▊     | 176/362 [00:00<00:00, 735.41it/s]Processing batches:  69%|██████▉   | 251/362 [00:08<00:05, 21.94it/s] Processing batches:  81%|████████  | 292/362 [00:12<00:04, 16.04it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:03, 13.91it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:02, 12.83it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01, 12.11it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00, 11.63it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00, 11.23it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.35it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4723.32it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3292077.98it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  16%|█▌        | 58/362 [00:00<00:00, 577.79it/s]Processing batches:  32%|███▏      | 116/362 [00:00<00:00, 533.60it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 382.46it/s]Processing batches:  62%|██████▏   | 225/362 [00:05<00:04, 27.43it/s] Processing batches:  70%|██████▉   | 252/362 [00:08<00:05, 18.90it/s]Processing batches:  75%|███████▍  | 270/362 [00:10<00:05, 15.88it/s]Processing batches:  78%|███████▊  | 282/362 [00:11<00:05, 14.36it/s]Processing batches:  80%|████████  | 291/362 [00:12<00:05, 13.31it/s]Processing batches:  82%|████████▏ | 297/362 [00:13<00:05, 12.62it/s]Processing batches:  83%|████████▎ | 302/362 [00:13<00:04, 12.06it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:04, 11.60it/s]Processing batches:  85%|████████▌ | 309/362 [00:14<00:04, 11.24it/s]Processing batches:  86%|████████▌ | 312/362 [00:14<00:04, 10.87it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:04, 10.58it/s]Processing batches:  87%|████████▋ | 316/362 [00:15<00:04, 10.33it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:04, 10.08it/s]Processing batches:  88%|████████▊ | 320/362 [00:15<00:04,  9.81it/s]Processing batches:  89%|████████▉ | 322/362 [00:15<00:04,  9.66it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:04,  9.48it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:03,  9.41it/s]Processing batches:  90%|█████████ | 326/362 [00:16<00:03,  9.37it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:03,  9.26it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03,  9.18it/s]Processing batches:  91%|█████████ | 329/362 [00:16<00:03,  9.12it/s]Processing batches:  91%|█████████ | 330/362 [00:16<00:03,  9.14it/s]Processing batches:  91%|█████████▏| 331/362 [00:16<00:03,  9.07it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  9.09it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  9.02it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  9.04it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:03,  9.00it/s]Processing batches:  93%|█████████▎| 336/362 [00:17<00:02,  8.90it/s]Processing batches:  93%|█████████▎| 337/362 [00:17<00:02,  9.02it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:02,  9.07it/s]Processing batches:  94%|█████████▎| 339/362 [00:17<00:02,  9.02it/s]Processing batches:  94%|█████████▍| 340/362 [00:17<00:02,  9.06it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  9.00it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  9.02it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  9.01it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:01,  9.04it/s]Processing batches:  95%|█████████▌| 345/362 [00:18<00:01,  9.02it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01,  8.90it/s]Processing batches:  96%|█████████▌| 347/362 [00:18<00:01,  9.06it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01,  9.05it/s]Processing batches:  96%|█████████▋| 349/362 [00:18<00:01,  9.02it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  9.07it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  9.01it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  9.01it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:01,  9.00it/s]Processing batches:  98%|█████████▊| 354/362 [00:19<00:00,  8.98it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  9.04it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  8.92it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00,  9.02it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00,  9.02it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  8.96it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  9.10it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  9.09it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.75it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target GSK3B - DES: 0.0023, MAE_top2k: 0.1114, n_DE: 2178
INFO:ZeroShotPerturbation:Predicting for target: TMBIM6
INFO:ZeroShotPerturbation:Processing 505 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6087.52it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3254915.29it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  43%|████▎     | 155/362 [00:00<00:00, 1543.15it/s]Processing batches:  43%|████▎     | 155/362 [00:12<00:00, 1543.15it/s]Processing batches:  85%|████████▍ | 306/362 [00:12<00:02, 20.21it/s]  Processing batches:  85%|████████▌ | 308/362 [00:13<00:02, 19.98it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.55it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6123.07it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3282956.68it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 60/362 [00:00<00:00, 587.85it/s]Processing batches:  35%|███▌      | 127/362 [00:00<00:00, 633.89it/s]Processing batches:  53%|█████▎    | 191/362 [00:01<00:01, 111.97it/s]Processing batches:  63%|██████▎   | 229/362 [00:05<00:04, 28.79it/s] Processing batches:  70%|██████▉   | 252/362 [00:07<00:05, 20.93it/s]Processing batches:  74%|███████▍  | 267/362 [00:09<00:05, 17.84it/s]Processing batches:  77%|███████▋  | 278/362 [00:10<00:05, 16.03it/s]Processing batches:  79%|███████▉  | 286/362 [00:10<00:05, 14.85it/s]Processing batches:  81%|████████  | 292/362 [00:11<00:04, 14.06it/s]Processing batches:  82%|████████▏ | 296/362 [00:11<00:04, 13.48it/s]Processing batches:  83%|████████▎ | 299/362 [00:12<00:04, 13.02it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:04, 12.52it/s]Processing batches:  84%|████████▍ | 304/362 [00:12<00:04, 12.16it/s]Processing batches:  85%|████████▍ | 306/362 [00:13<00:04, 11.80it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:04, 11.38it/s]Processing batches:  86%|████████▌ | 310/362 [00:13<00:04, 11.04it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:04, 10.76it/s]Processing batches:  87%|████████▋ | 314/362 [00:13<00:04, 10.62it/s]Processing batches:  87%|████████▋ | 316/362 [00:14<00:04, 10.42it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:04, 10.26it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:04, 10.06it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:03, 10.06it/s]Processing batches:  90%|████████▉ | 324/362 [00:14<00:03,  9.96it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03,  9.95it/s]Processing batches:  90%|█████████ | 327/362 [00:15<00:03,  9.93it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03,  9.90it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03,  9.90it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03,  9.84it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:03,  9.85it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:03,  9.86it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02,  9.86it/s]Processing batches:  92%|█████████▏| 334/362 [00:15<00:02,  9.85it/s]Processing batches:  93%|█████████▎| 335/362 [00:15<00:02,  9.87it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.85it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.85it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.86it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.87it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02,  9.83it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.87it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:02,  9.87it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01,  9.89it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01,  9.89it/s]Processing batches:  95%|█████████▌| 345/362 [00:16<00:01,  9.87it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.79it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.83it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.84it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.80it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.84it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00,  9.85it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00,  9.80it/s]Processing batches:  98%|█████████▊| 355/362 [00:17<00:00,  9.82it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.84it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.86it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.85it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.87it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.87it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.85it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.40it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target TMBIM6 - DES: 0.0000, MAE_top2k: 0.0668, n_DE: 25
INFO:ZeroShotPerturbation:Predicting for target: PMEL
INFO:ZeroShotPerturbation:Processing 356 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6355.01it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3279265.57it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  43%|████▎     | 156/362 [00:00<00:00, 1499.67it/s]Processing batches:  43%|████▎     | 156/362 [00:11<00:00, 1499.67it/s]Processing batches:  82%|████████▏ | 296/362 [00:11<00:03, 21.66it/s]  Processing batches:  82%|████████▏ | 298/362 [00:11<00:02, 21.39it/s]Processing batches: 100%|█████████▉| 361/362 [00:17<00:00, 15.52it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 20.07it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6569.00it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3384495.95it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   5%|▍         | 17/362 [00:00<00:02, 167.93it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 923.46it/s]Processing batches:  75%|███████▍  | 270/362 [00:08<00:03, 24.18it/s] Processing batches:  88%|████████▊ | 318/362 [00:13<00:02, 18.10it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:00, 15.91it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 20.32it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target PMEL - DES: 0.0000, MAE_top2k: 0.0805, n_DE: 32
INFO:ZeroShotPerturbation:Predicting for target: DAXX
INFO:ZeroShotPerturbation:Processing 1332 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4297.44it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3317134.70it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  35%|███▍      | 125/362 [00:00<00:00, 1240.42it/s]Processing batches:  69%|██████▉   | 250/362 [00:08<00:04, 25.08it/s]  Processing batches:  83%|████████▎ | 302/362 [00:14<00:03, 16.48it/s]Processing batches:  91%|█████████▏| 331/362 [00:18<00:02, 14.07it/s]Processing batches:  96%|█████████▋| 349/362 [00:20<00:01, 12.90it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00, 12.15it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.49it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4056.39it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3368410.09it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▌        | 55/362 [00:00<00:00, 510.26it/s]Processing batches:  35%|███▌      | 127/362 [00:00<00:00, 629.53it/s]Processing batches:  53%|█████▎    | 191/362 [00:01<00:01, 98.63it/s] Processing batches:  63%|██████▎   | 228/362 [00:05<00:05, 25.51it/s]Processing batches:  69%|██████▉   | 251/362 [00:08<00:06, 18.42it/s]Processing batches:  73%|███████▎  | 266/362 [00:10<00:06, 15.66it/s]Processing batches:  76%|███████▌  | 276/362 [00:11<00:06, 14.13it/s]Processing batches:  78%|███████▊  | 284/362 [00:12<00:05, 13.08it/s]Processing batches:  80%|████████  | 290/362 [00:13<00:05, 12.31it/s]Processing batches:  81%|████████  | 294/362 [00:13<00:05, 11.77it/s]Processing batches:  82%|████████▏ | 297/362 [00:13<00:05, 11.31it/s]Processing batches:  83%|████████▎ | 300/362 [00:14<00:05, 10.87it/s]Processing batches:  83%|████████▎ | 302/362 [00:14<00:05, 10.55it/s]Processing batches:  84%|████████▍ | 304/362 [00:14<00:05, 10.21it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:05,  9.91it/s]Processing batches:  85%|████████▌ | 308/362 [00:15<00:05,  9.60it/s]Processing batches:  86%|████████▌ | 310/362 [00:15<00:05,  9.36it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:05,  9.14it/s]Processing batches:  86%|████████▋ | 313/362 [00:15<00:05,  9.07it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:05,  8.96it/s]Processing batches:  87%|████████▋ | 315/362 [00:16<00:05,  8.86it/s]Processing batches:  87%|████████▋ | 316/362 [00:16<00:05,  8.79it/s]Processing batches:  88%|████████▊ | 317/362 [00:16<00:05,  8.67it/s]Processing batches:  88%|████████▊ | 318/362 [00:16<00:05,  8.68it/s]Processing batches:  88%|████████▊ | 319/362 [00:16<00:04,  8.63it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04,  8.61it/s]Processing batches:  89%|████████▊ | 321/362 [00:16<00:04,  8.52it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  8.61it/s]Processing batches:  89%|████████▉ | 323/362 [00:16<00:04,  8.62it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:04,  8.65it/s]Processing batches:  90%|████████▉ | 325/362 [00:17<00:04,  8.54it/s]Processing batches:  90%|█████████ | 326/362 [00:17<00:04,  8.60it/s]Processing batches:  90%|█████████ | 327/362 [00:17<00:04,  8.36it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03,  8.57it/s]Processing batches:  91%|█████████ | 329/362 [00:17<00:03,  8.38it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  8.55it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  8.56it/s]Processing batches:  92%|█████████▏| 332/362 [00:18<00:03,  8.56it/s]Processing batches:  92%|█████████▏| 333/362 [00:18<00:03,  8.56it/s]Processing batches:  92%|█████████▏| 334/362 [00:18<00:03,  8.50it/s]Processing batches:  93%|█████████▎| 335/362 [00:18<00:03,  8.61it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:03,  8.41it/s]Processing batches:  93%|█████████▎| 337/362 [00:18<00:02,  8.60it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.58it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.64it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.56it/s]Processing batches:  94%|█████████▍| 341/362 [00:19<00:02,  8.56it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  8.63it/s]Processing batches:  95%|█████████▍| 343/362 [00:19<00:02,  8.66it/s]Processing batches:  95%|█████████▌| 344/362 [00:19<00:02,  8.62it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01,  8.60it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  8.58it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.57it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.58it/s]Processing batches:  96%|█████████▋| 349/362 [00:20<00:01,  8.63it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  8.60it/s]Processing batches:  97%|█████████▋| 351/362 [00:20<00:01,  8.57it/s]Processing batches:  97%|█████████▋| 352/362 [00:20<00:01,  8.57it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:01,  8.57it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  8.55it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  8.60it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  8.54it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.49it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  8.57it/s]Processing batches:  99%|█████████▉| 359/362 [00:21<00:00,  8.54it/s]Processing batches:  99%|█████████▉| 360/362 [00:21<00:00,  8.54it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00,  8.61it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.86it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target DAXX - DES: 0.0014, MAE_top2k: 0.0563, n_DE: 740
INFO:ZeroShotPerturbation:Predicting for target: METTL14
INFO:ZeroShotPerturbation:Processing 468 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6186.29it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3339778.75it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 1686.27it/s]Processing batches:  50%|█████     | 181/362 [00:13<00:00, 1686.27it/s]Processing batches:  87%|████████▋ | 314/362 [00:13<00:02, 19.14it/s]  Processing batches:  87%|████████▋ | 315/362 [00:13<00:02, 19.04it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.67it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6423.13it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3320911.60it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  18%|█▊        | 65/362 [00:00<00:00, 637.49it/s]Processing batches:  45%|████▌     | 163/362 [00:00<00:00, 834.40it/s]Processing batches:  68%|██████▊   | 247/362 [00:06<00:04, 27.00it/s] Processing batches:  81%|████████  | 293/362 [00:11<00:03, 18.65it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:02, 15.98it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:01, 14.67it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00, 13.83it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.68it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target METTL14 - DES: 0.3054, MAE_top2k: 0.4973, n_DE: 9318
INFO:ZeroShotPerturbation:Predicting for target: MAU2
INFO:ZeroShotPerturbation:Processing 1021 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4621.82it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3250868.79it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  33%|███▎      | 118/362 [00:00<00:00, 1176.46it/s]Processing batches:  65%|██████▌   | 236/362 [00:06<00:04, 31.11it/s]  Processing batches:  79%|███████▉  | 286/362 [00:12<00:04, 18.68it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:03, 15.62it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:02, 14.17it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:01, 13.23it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:00, 12.59it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00, 12.07it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00, 11.73it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.43it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4731.31it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3341250.28it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   7%|▋         | 27/362 [00:00<00:01, 222.29it/s]Processing batches:  14%|█▍        | 52/362 [00:00<00:01, 235.79it/s]Processing batches:  21%|██        | 76/362 [00:00<00:01, 227.61it/s]Processing batches:  33%|███▎      | 121/362 [00:00<00:00, 299.75it/s]Processing batches:  44%|████▍     | 159/362 [00:00<00:00, 326.61it/s]Processing batches:  53%|█████▎    | 192/362 [00:01<00:02, 68.08it/s] Processing batches:  59%|█████▉    | 215/362 [00:04<00:05, 26.04it/s]Processing batches:  64%|██████▍   | 231/362 [00:06<00:06, 18.96it/s]Processing batches:  67%|██████▋   | 242/362 [00:07<00:07, 16.09it/s]Processing batches:  69%|██████▉   | 250/362 [00:08<00:07, 14.43it/s]Processing batches:  71%|███████   | 256/362 [00:08<00:07, 13.37it/s]Processing batches:  72%|███████▏  | 261/362 [00:09<00:08, 12.56it/s]Processing batches:  73%|███████▎  | 265/362 [00:09<00:08, 11.94it/s]Processing batches:  74%|███████▍  | 268/362 [00:10<00:08, 11.48it/s]Processing batches:  75%|███████▍  | 271/362 [00:10<00:08, 11.04it/s]Processing batches:  75%|███████▌  | 273/362 [00:10<00:08, 10.74it/s]Processing batches:  76%|███████▌  | 275/362 [00:11<00:08, 10.43it/s]Processing batches:  77%|███████▋  | 277/362 [00:11<00:08, 10.15it/s]Processing batches:  77%|███████▋  | 279/362 [00:11<00:08,  9.91it/s]Processing batches:  78%|███████▊  | 281/362 [00:11<00:08,  9.70it/s]Processing batches:  78%|███████▊  | 283/362 [00:11<00:08,  9.51it/s]Processing batches:  78%|███████▊  | 284/362 [00:12<00:08,  9.45it/s]Processing batches:  79%|███████▊  | 285/362 [00:12<00:08,  9.37it/s]Processing batches:  79%|███████▉  | 286/362 [00:12<00:08,  9.32it/s]Processing batches:  79%|███████▉  | 287/362 [00:12<00:08,  9.26it/s]Processing batches:  80%|███████▉  | 288/362 [00:12<00:08,  9.22it/s]Processing batches:  80%|███████▉  | 289/362 [00:12<00:07,  9.18it/s]Processing batches:  80%|████████  | 290/362 [00:12<00:07,  9.17it/s]Processing batches:  80%|████████  | 291/362 [00:12<00:07,  9.17it/s]Processing batches:  81%|████████  | 292/362 [00:12<00:07,  9.14it/s]Processing batches:  81%|████████  | 293/362 [00:12<00:07,  9.03it/s]Processing batches:  81%|████████  | 294/362 [00:13<00:07,  9.10it/s]Processing batches:  81%|████████▏ | 295/362 [00:13<00:07,  9.08it/s]Processing batches:  82%|████████▏ | 296/362 [00:13<00:07,  9.06it/s]Processing batches:  82%|████████▏ | 297/362 [00:13<00:07,  8.93it/s]Processing batches:  82%|████████▏ | 298/362 [00:13<00:06,  9.14it/s]Processing batches:  83%|████████▎ | 299/362 [00:13<00:06,  9.12it/s]Processing batches:  83%|████████▎ | 300/362 [00:13<00:06,  9.09it/s]Processing batches:  83%|████████▎ | 301/362 [00:13<00:06,  9.10it/s]Processing batches:  83%|████████▎ | 302/362 [00:13<00:06,  9.02it/s]Processing batches:  84%|████████▎ | 303/362 [00:14<00:06,  9.05it/s]Processing batches:  84%|████████▍ | 304/362 [00:14<00:06,  9.05it/s]Processing batches:  84%|████████▍ | 305/362 [00:14<00:06,  9.00it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:06,  9.00it/s]Processing batches:  85%|████████▍ | 307/362 [00:14<00:06,  8.96it/s]Processing batches:  85%|████████▌ | 308/362 [00:14<00:06,  8.98it/s]Processing batches:  85%|████████▌ | 309/362 [00:14<00:05,  9.00it/s]Processing batches:  86%|████████▌ | 310/362 [00:14<00:05,  9.07it/s]Processing batches:  86%|████████▌ | 311/362 [00:14<00:05,  8.96it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:05,  8.98it/s]Processing batches:  86%|████████▋ | 313/362 [00:15<00:05,  8.98it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:05,  9.00it/s]Processing batches:  87%|████████▋ | 315/362 [00:15<00:05,  9.00it/s]Processing batches:  87%|████████▋ | 316/362 [00:15<00:05,  8.97it/s]Processing batches:  88%|████████▊ | 317/362 [00:15<00:05,  9.00it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:04,  9.02it/s]Processing batches:  88%|████████▊ | 319/362 [00:15<00:04,  9.06it/s]Processing batches:  88%|████████▊ | 320/362 [00:15<00:04,  9.06it/s]Processing batches:  89%|████████▊ | 321/362 [00:16<00:04,  9.12it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  9.10it/s]Processing batches:  89%|████████▉ | 323/362 [00:16<00:04,  9.13it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:04,  9.12it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:04,  9.11it/s]Processing batches:  90%|█████████ | 326/362 [00:16<00:03,  9.11it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:03,  9.09it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03,  9.08it/s]Processing batches:  91%|█████████ | 329/362 [00:16<00:03,  9.12it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  9.08it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  9.08it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  9.13it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  8.92it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  9.15it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:02,  9.08it/s]Processing batches:  93%|█████████▎| 336/362 [00:17<00:02,  9.06it/s]Processing batches:  93%|█████████▎| 337/362 [00:17<00:02,  9.06it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:02,  9.06it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  9.07it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  9.06it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  9.06it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  9.08it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  9.09it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:01,  9.05it/s]Processing batches:  95%|█████████▌| 345/362 [00:18<00:01,  9.06it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01,  8.92it/s]Processing batches:  96%|█████████▌| 347/362 [00:18<00:01,  9.07it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  9.07it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  9.10it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  9.09it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  9.08it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  9.05it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:00,  9.04it/s]Processing batches:  98%|█████████▊| 354/362 [00:19<00:00,  9.03it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  9.04it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  9.02it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.99it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00,  9.00it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  9.04it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  9.02it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  9.05it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.59it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MAU2 - DES: 0.1786, MAE_top2k: 0.2298, n_DE: 6770
INFO:ZeroShotPerturbation:Predicting for target: NDUFB4
INFO:ZeroShotPerturbation:Processing 1413 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4048.56it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3336692.76it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  25%|██▌       | 91/362 [00:00<00:00, 904.39it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 482.21it/s]Processing batches:  67%|██████▋   | 241/362 [00:07<00:05, 22.47it/s] Processing batches:  76%|███████▌  | 274/362 [00:11<00:05, 16.22it/s]Processing batches:  81%|████████  | 294/362 [00:14<00:04, 14.05it/s]Processing batches:  85%|████████▍ | 307/362 [00:15<00:04, 12.81it/s]Processing batches:  87%|████████▋ | 316/362 [00:16<00:03, 12.02it/s]Processing batches:  89%|████████▉ | 323/362 [00:17<00:03, 11.44it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:03, 10.97it/s]Processing batches:  92%|█████████▏| 332/362 [00:18<00:02, 10.58it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:02, 10.26it/s]Processing batches:  93%|█████████▎| 338/362 [00:19<00:02,  9.92it/s]Processing batches:  94%|█████████▍| 340/362 [00:19<00:02,  9.72it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  9.47it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:01,  9.25it/s]Processing batches:  96%|█████████▌| 346/362 [00:20<00:01,  9.00it/s]Processing batches:  96%|█████████▌| 348/362 [00:20<00:01,  8.79it/s]Processing batches:  96%|█████████▋| 349/362 [00:20<00:01,  8.71it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  8.63it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  8.56it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  8.44it/s]Processing batches:  98%|█████████▊| 353/362 [00:21<00:01,  8.37it/s]Processing batches:  98%|█████████▊| 354/362 [00:21<00:00,  8.25it/s]Processing batches:  98%|█████████▊| 355/362 [00:21<00:00,  8.18it/s]Processing batches:  98%|█████████▊| 356/362 [00:21<00:00,  8.23it/s]Processing batches:  99%|█████████▊| 357/362 [00:21<00:00,  8.21it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  8.19it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.15it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  8.20it/s]Processing batches: 100%|█████████▉| 361/362 [00:22<00:00,  8.23it/s]Processing batches: 100%|██████████| 362/362 [00:22<00:00, 16.19it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4108.04it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3367064.04it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   8%|▊         | 29/362 [00:00<00:01, 284.17it/s]Processing batches:  20%|██        | 73/362 [00:00<00:00, 373.46it/s]Processing batches:  33%|███▎      | 118/362 [00:00<00:00, 406.85it/s]Processing batches:  48%|████▊     | 174/362 [00:00<00:00, 465.93it/s]Processing batches:  61%|██████    | 221/362 [00:05<00:05, 26.20it/s] Processing batches:  70%|██████▉   | 252/362 [00:08<00:06, 17.09it/s]Processing batches:  75%|███████▌  | 273/362 [00:11<00:06, 14.24it/s]Processing batches:  79%|███████▉  | 287/362 [00:12<00:05, 12.88it/s]Processing batches:  82%|████████▏ | 297/362 [00:14<00:05, 12.03it/s]Processing batches:  84%|████████▍ | 304/362 [00:14<00:05, 11.45it/s]Processing batches:  86%|████████▌ | 310/362 [00:15<00:04, 10.93it/s]Processing batches:  87%|████████▋ | 314/362 [00:16<00:04, 10.60it/s]Processing batches:  88%|████████▊ | 317/362 [00:16<00:04, 10.31it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04, 10.02it/s]Processing batches:  89%|████████▉ | 322/362 [00:17<00:04,  9.83it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:03,  9.63it/s]Processing batches:  90%|█████████ | 326/362 [00:17<00:03,  9.43it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03,  9.22it/s]Processing batches:  91%|█████████ | 330/362 [00:18<00:03,  9.03it/s]Processing batches:  92%|█████████▏| 332/362 [00:18<00:03,  8.88it/s]Processing batches:  92%|█████████▏| 333/362 [00:18<00:03,  8.82it/s]Processing batches:  92%|█████████▏| 334/362 [00:18<00:03,  8.74it/s]Processing batches:  93%|█████████▎| 335/362 [00:18<00:03,  8.69it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:03,  8.64it/s]Processing batches:  93%|█████████▎| 337/362 [00:18<00:02,  8.59it/s]Processing batches:  93%|█████████▎| 338/362 [00:19<00:02,  8.58it/s]Processing batches:  94%|█████████▎| 339/362 [00:19<00:02,  8.59it/s]Processing batches:  94%|█████████▍| 340/362 [00:19<00:02,  8.57it/s]Processing batches:  94%|█████████▍| 341/362 [00:19<00:02,  8.57it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  8.59it/s]Processing batches:  95%|█████████▍| 343/362 [00:19<00:02,  8.59it/s]Processing batches:  95%|█████████▌| 344/362 [00:19<00:02,  8.57it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01,  8.53it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  8.44it/s]Processing batches:  96%|█████████▌| 347/362 [00:20<00:01,  8.48it/s]Processing batches:  96%|█████████▌| 348/362 [00:20<00:01,  8.48it/s]Processing batches:  96%|█████████▋| 349/362 [00:20<00:01,  8.51it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  8.50it/s]Processing batches:  97%|█████████▋| 351/362 [00:20<00:01,  8.55it/s]Processing batches:  97%|█████████▋| 352/362 [00:20<00:01,  8.39it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:01,  8.49it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  8.52it/s]Processing batches:  98%|█████████▊| 355/362 [00:21<00:00,  8.54it/s]Processing batches:  98%|█████████▊| 356/362 [00:21<00:00,  8.54it/s]Processing batches:  99%|█████████▊| 357/362 [00:21<00:00,  8.57it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  8.55it/s]Processing batches:  99%|█████████▉| 359/362 [00:21<00:00,  8.47it/s]Processing batches:  99%|█████████▉| 360/362 [00:21<00:00,  8.59it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00,  8.60it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.63it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target NDUFB4 - DES: 0.0000, MAE_top2k: 0.0703, n_DE: 971
INFO:ZeroShotPerturbation:Predicting for target: KDM1A
INFO:ZeroShotPerturbation:Processing 352 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6543.38it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3315829.31it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 1435.23it/s]Processing batches:  50%|█████     | 181/362 [00:13<00:00, 1435.23it/s]Processing batches:  88%|████████▊ | 317/362 [00:13<00:02, 19.45it/s]  Processing batches:  88%|████████▊ | 319/362 [00:13<00:02, 19.26it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 20.18it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6502.80it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3300531.70it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  30%|███       | 109/362 [00:00<00:00, 1039.74it/s]Processing batches:  59%|█████▉    | 213/362 [00:03<00:02, 53.49it/s]  Processing batches:  71%|███████▏  | 258/362 [00:07<00:04, 25.26it/s]Processing batches:  78%|███████▊  | 283/362 [00:10<00:03, 20.10it/s]Processing batches:  83%|████████▎ | 299/362 [00:11<00:03, 17.73it/s]Processing batches:  86%|████████▌ | 310/362 [00:12<00:03, 16.29it/s]Processing batches:  88%|████████▊ | 318/362 [00:13<00:02, 15.29it/s]Processing batches:  90%|████████▉ | 324/362 [00:14<00:02, 14.53it/s]Processing batches:  91%|█████████ | 328/362 [00:14<00:02, 13.98it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:02, 13.51it/s]Processing batches:  92%|█████████▏| 334/362 [00:15<00:02, 13.02it/s]Processing batches:  93%|█████████▎| 336/362 [00:15<00:02, 12.66it/s]Processing batches:  93%|█████████▎| 338/362 [00:15<00:01, 12.30it/s]Processing batches:  94%|█████████▍| 340/362 [00:15<00:01, 11.93it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:01, 11.57it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01, 11.26it/s]Processing batches:  96%|█████████▌| 346/362 [00:16<00:01, 10.97it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:01, 10.75it/s]Processing batches:  97%|█████████▋| 350/362 [00:16<00:01, 10.62it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:00, 10.46it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00, 10.37it/s]Processing batches:  98%|█████████▊| 356/362 [00:17<00:00, 10.32it/s]Processing batches:  99%|█████████▉| 358/362 [00:17<00:00, 10.29it/s]Processing batches:  99%|█████████▉| 360/362 [00:17<00:00, 10.24it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 10.85it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 20.08it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target KDM1A - DES: 0.3739, MAE_top2k: 0.4818, n_DE: 10194
INFO:ZeroShotPerturbation:Predicting for target: TXNDC9
INFO:ZeroShotPerturbation:Processing 514 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6172.63it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3296514.36it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  21%|██▏       | 77/362 [00:00<00:00, 758.75it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 878.75it/s]Processing batches:  74%|███████▍  | 269/362 [00:09<00:04, 21.61it/s] Processing batches:  88%|████████▊ | 318/362 [00:14<00:02, 16.38it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:00, 14.56it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.29it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6083.11it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3374405.57it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   6%|▋         | 23/362 [00:00<00:01, 203.81it/s]Processing batches:  14%|█▍        | 51/362 [00:00<00:01, 242.98it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 527.98it/s]Processing batches:  63%|██████▎   | 229/362 [00:05<00:04, 32.18it/s] Processing batches:  71%|███████▏  | 258/362 [00:08<00:04, 21.94it/s]Processing batches:  77%|███████▋  | 277/362 [00:10<00:04, 18.29it/s]Processing batches:  80%|████████  | 290/362 [00:11<00:04, 16.39it/s]Processing batches:  83%|████████▎ | 299/362 [00:12<00:04, 15.17it/s]Processing batches:  85%|████████▍ | 306/362 [00:13<00:03, 14.25it/s]Processing batches:  86%|████████▌ | 311/362 [00:13<00:03, 13.60it/s]Processing batches:  87%|████████▋ | 315/362 [00:13<00:03, 13.05it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:03, 12.62it/s]Processing batches:  89%|████████▊ | 321/362 [00:14<00:03, 12.18it/s]Processing batches:  89%|████████▉ | 323/362 [00:14<00:03, 11.87it/s]Processing batches:  90%|████████▉ | 325/362 [00:14<00:03, 11.54it/s]Processing batches:  90%|█████████ | 327/362 [00:15<00:03, 11.21it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03, 10.91it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:02, 10.66it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02, 10.43it/s]Processing batches:  93%|█████████▎| 335/362 [00:15<00:02, 10.27it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02, 10.15it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02, 10.06it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.99it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01,  9.95it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01,  9.94it/s]Processing batches:  95%|█████████▌| 345/362 [00:16<00:01,  9.92it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.88it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.86it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.88it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.89it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.72it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:01,  9.82it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00,  9.86it/s]Processing batches:  98%|█████████▊| 355/362 [00:17<00:00,  9.86it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.86it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.85it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.87it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.86it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.86it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.88it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.40it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target TXNDC9 - DES: 0.0000, MAE_top2k: 0.0707, n_DE: 1072
INFO:ZeroShotPerturbation:Predicting for target: CALM3
INFO:ZeroShotPerturbation:Processing 681 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5618.63it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3208776.55it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  19%|█▊        | 67/362 [00:00<00:00, 639.19it/s]Processing batches:  46%|████▌     | 167/362 [00:00<00:00, 846.84it/s]Processing batches:  70%|██████▉   | 253/362 [00:07<00:04, 24.13it/s] Processing batches:  83%|████████▎ | 300/362 [00:12<00:03, 17.14it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:02, 14.83it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01, 13.67it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00, 12.93it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.62it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5570.12it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3317715.20it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  28%|██▊       | 100/362 [00:00<00:00, 910.36it/s]Processing batches:  53%|█████▎    | 192/362 [00:01<00:01, 122.38it/s]Processing batches:  65%|██████▍   | 234/362 [00:05<00:04, 29.24it/s] Processing batches:  71%|███████▏  | 258/362 [00:08<00:04, 21.32it/s]Processing batches:  75%|███████▌  | 273/362 [00:09<00:04, 18.20it/s]Processing batches:  78%|███████▊  | 283/362 [00:10<00:04, 16.46it/s]Processing batches:  80%|████████  | 290/362 [00:11<00:04, 15.31it/s]Processing batches:  81%|████████▏ | 295/362 [00:12<00:04, 14.49it/s]Processing batches:  83%|████████▎ | 299/362 [00:12<00:04, 13.79it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:04, 13.22it/s]Processing batches:  84%|████████▍ | 305/362 [00:13<00:04, 12.62it/s]Processing batches:  85%|████████▍ | 307/362 [00:13<00:04, 12.22it/s]Processing batches:  85%|████████▌ | 309/362 [00:13<00:04, 11.78it/s]Processing batches:  86%|████████▌ | 311/362 [00:13<00:04, 11.37it/s]Processing batches:  86%|████████▋ | 313/362 [00:14<00:04, 10.95it/s]Processing batches:  87%|████████▋ | 315/362 [00:14<00:04, 10.71it/s]Processing batches:  88%|████████▊ | 317/362 [00:14<00:04, 10.40it/s]Processing batches:  88%|████████▊ | 319/362 [00:14<00:04, 10.18it/s]Processing batches:  89%|████████▊ | 321/362 [00:14<00:04, 10.03it/s]Processing batches:  89%|████████▉ | 323/362 [00:15<00:03,  9.93it/s]Processing batches:  90%|████████▉ | 324/362 [00:15<00:03,  9.89it/s]Processing batches:  90%|████████▉ | 325/362 [00:15<00:03,  9.80it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03,  9.75it/s]Processing batches:  90%|█████████ | 327/362 [00:15<00:03,  9.71it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03,  9.67it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03,  9.66it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03,  9.63it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:03,  9.60it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:03,  9.62it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:03,  9.60it/s]Processing batches:  92%|█████████▏| 334/362 [00:16<00:02,  9.61it/s]Processing batches:  93%|█████████▎| 335/362 [00:16<00:02,  9.67it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.63it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.61it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.61it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.62it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02,  9.63it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.63it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:02,  9.66it/s]Processing batches:  95%|█████████▍| 343/362 [00:17<00:01,  9.67it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01,  9.67it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.61it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.59it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.55it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.60it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.64it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.63it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.64it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.61it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.62it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.63it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.64it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.66it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.63it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.68it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.67it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.60it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.62it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.99it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target CALM3 - DES: 0.0000, MAE_top2k: 0.0796, n_DE: 2
INFO:ZeroShotPerturbation:Predicting for target: C1QBP
INFO:ZeroShotPerturbation:Processing 711 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5618.63it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3298952.29it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 62/362 [00:00<00:00, 617.25it/s]Processing batches:  37%|███▋      | 135/362 [00:00<00:00, 660.49it/s]Processing batches:  56%|█████▌    | 201/362 [00:02<00:02, 62.01it/s] Processing batches:  66%|██████▌   | 239/362 [00:06<00:05, 24.53it/s]Processing batches:  72%|███████▏  | 262/362 [00:09<00:05, 18.73it/s]Processing batches:  77%|███████▋  | 277/362 [00:10<00:05, 16.26it/s]Processing batches:  80%|███████▉  | 288/362 [00:11<00:04, 14.82it/s]Processing batches:  82%|████████▏ | 296/362 [00:12<00:04, 13.81it/s]Processing batches:  83%|████████▎ | 302/362 [00:13<00:04, 13.05it/s]Processing batches:  85%|████████▍ | 306/362 [00:13<00:04, 12.54it/s]Processing batches:  85%|████████▌ | 309/362 [00:14<00:04, 12.11it/s]Processing batches:  86%|████████▌ | 312/362 [00:14<00:04, 11.68it/s]Processing batches:  87%|████████▋ | 314/362 [00:14<00:04, 11.36it/s]Processing batches:  87%|████████▋ | 316/362 [00:14<00:04, 11.04it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:04, 10.72it/s]Processing batches:  88%|████████▊ | 320/362 [00:15<00:04, 10.43it/s]Processing batches:  89%|████████▉ | 322/362 [00:15<00:03, 10.19it/s]Processing batches:  90%|████████▉ | 324/362 [00:15<00:03, 10.01it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03,  9.83it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03,  9.63it/s]Processing batches:  91%|█████████ | 329/362 [00:16<00:03,  9.60it/s]Processing batches:  91%|█████████ | 330/362 [00:16<00:03,  9.55it/s]Processing batches:  91%|█████████▏| 331/362 [00:16<00:03,  9.48it/s]Processing batches:  92%|█████████▏| 332/362 [00:16<00:03,  9.41it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:03,  9.41it/s]Processing batches:  92%|█████████▏| 334/362 [00:16<00:02,  9.35it/s]Processing batches:  93%|█████████▎| 335/362 [00:16<00:02,  9.37it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.31it/s]Processing batches:  93%|█████████▎| 337/362 [00:17<00:02,  9.33it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:02,  9.19it/s]Processing batches:  94%|█████████▎| 339/362 [00:17<00:02,  9.38it/s]Processing batches:  94%|█████████▍| 340/362 [00:17<00:02,  9.38it/s]Processing batches:  94%|█████████▍| 341/362 [00:17<00:02,  9.34it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:02,  9.43it/s]Processing batches:  95%|█████████▍| 343/362 [00:17<00:02,  9.39it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01,  9.26it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01,  9.43it/s]Processing batches:  96%|█████████▌| 347/362 [00:18<00:01,  9.41it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01,  9.36it/s]Processing batches:  96%|█████████▋| 349/362 [00:18<00:01,  9.35it/s]Processing batches:  97%|█████████▋| 350/362 [00:18<00:01,  9.37it/s]Processing batches:  97%|█████████▋| 351/362 [00:18<00:01,  9.35it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.26it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.25it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.24it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  9.26it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  9.31it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00,  9.20it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00,  9.34it/s]Processing batches:  99%|█████████▉| 359/362 [00:19<00:00,  9.34it/s]Processing batches:  99%|█████████▉| 360/362 [00:19<00:00,  9.30it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00,  9.37it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.35it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5384.22it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3343460.00it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 50/362 [00:00<00:00, 468.82it/s]Processing batches:  27%|██▋       | 97/362 [00:00<00:00, 443.87it/s]Processing batches:  44%|████▍     | 159/362 [00:00<00:00, 497.66it/s]Processing batches:  58%|█████▊    | 209/362 [00:03<00:03, 41.98it/s] Processing batches:  66%|██████▋   | 240/362 [00:06<00:05, 22.71it/s]Processing batches:  72%|███████▏  | 261/362 [00:08<00:05, 17.91it/s]Processing batches:  76%|███████▌  | 275/362 [00:10<00:05, 15.75it/s]Processing batches:  79%|███████▊  | 285/362 [00:11<00:05, 14.46it/s]Processing batches:  81%|████████  | 292/362 [00:12<00:05, 13.62it/s]Processing batches:  82%|████████▏ | 297/362 [00:12<00:04, 13.01it/s]Processing batches:  83%|████████▎ | 301/362 [00:12<00:04, 12.50it/s]Processing batches:  84%|████████▍ | 304/362 [00:13<00:04, 12.09it/s]Processing batches:  85%|████████▍ | 307/362 [00:13<00:04, 11.67it/s]Processing batches:  85%|████████▌ | 309/362 [00:13<00:04, 11.33it/s]Processing batches:  86%|████████▌ | 311/362 [00:14<00:04, 11.10it/s]Processing batches:  86%|████████▋ | 313/362 [00:14<00:04, 10.80it/s]Processing batches:  87%|████████▋ | 315/362 [00:14<00:04, 10.54it/s]Processing batches:  88%|████████▊ | 317/362 [00:14<00:04, 10.28it/s]Processing batches:  88%|████████▊ | 319/362 [00:14<00:04, 10.05it/s]Processing batches:  89%|████████▊ | 321/362 [00:15<00:04, 10.03it/s]Processing batches:  89%|████████▉ | 323/362 [00:15<00:03,  9.94it/s]Processing batches:  90%|████████▉ | 325/362 [00:15<00:03,  9.85it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03,  9.81it/s]Processing batches:  90%|█████████ | 327/362 [00:15<00:03,  9.73it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03,  9.74it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03,  9.52it/s]Processing batches:  91%|█████████▏| 331/362 [00:16<00:03,  9.69it/s]Processing batches:  92%|█████████▏| 332/362 [00:16<00:03,  9.65it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:03,  9.41it/s]Processing batches:  93%|█████████▎| 335/362 [00:16<00:02,  9.64it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.61it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.56it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.54it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.65it/s]Processing batches:  94%|█████████▍| 340/362 [00:17<00:02,  9.60it/s]Processing batches:  94%|█████████▍| 341/362 [00:17<00:02,  9.60it/s]Processing batches:  94%|█████████▍| 342/362 [00:17<00:02,  9.34it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01,  9.64it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.61it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.42it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.55it/s]Processing batches:  96%|█████████▋| 349/362 [00:18<00:01,  9.60it/s]Processing batches:  97%|█████████▋| 350/362 [00:18<00:01,  9.27it/s]Processing batches:  97%|█████████▋| 352/362 [00:18<00:01,  9.62it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.61it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00,  9.59it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.61it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.57it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.57it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.61it/s]Processing batches:  99%|█████████▉| 359/362 [00:19<00:00,  9.60it/s]Processing batches:  99%|█████████▉| 360/362 [00:19<00:00,  9.62it/s]Processing batches: 100%|█████████▉| 361/362 [00:19<00:00,  9.63it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.73it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target C1QBP - DES: 0.0108, MAE_top2k: 0.1106, n_DE: 3441
INFO:ZeroShotPerturbation:Predicting for target: MBTPS1
INFO:ZeroShotPerturbation:Processing 626 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6017.65it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3362137.72it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  33%|███▎      | 118/362 [00:00<00:00, 1179.09it/s]Processing batches:  65%|██████▌   | 236/362 [00:05<00:03, 33.86it/s]  Processing batches:  79%|███████▉  | 286/362 [00:11<00:03, 20.27it/s]Processing batches:  87%|████████▋ | 314/362 [00:14<00:02, 16.94it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:02, 15.38it/s]Processing batches:  95%|█████████▍| 343/362 [00:17<00:01, 14.37it/s]Processing batches:  97%|█████████▋| 351/362 [00:18<00:00, 13.68it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00, 13.11it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 12.78it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.92it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5522.45it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3328345.17it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▌        | 56/362 [00:00<00:00, 554.16it/s]Processing batches:  33%|███▎      | 118/362 [00:00<00:00, 583.87it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 577.53it/s]Processing batches:  66%|██████▌   | 239/362 [00:06<00:05, 24.54it/s] Processing batches:  76%|███████▌  | 275/362 [00:10<00:04, 17.64it/s]Processing batches:  82%|████████▏ | 298/362 [00:12<00:04, 15.27it/s]Processing batches:  87%|████████▋ | 314/362 [00:14<00:03, 13.97it/s]Processing batches:  90%|████████▉ | 325/362 [00:15<00:02, 13.18it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:02, 12.62it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:01, 12.18it/s]Processing batches:  95%|█████████▌| 344/362 [00:17<00:01, 11.81it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01, 11.48it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:00, 11.24it/s]Processing batches:  98%|█████████▊| 354/362 [00:18<00:00, 11.00it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00, 10.82it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00, 10.64it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00, 10.43it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 10.71it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 19.00it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MBTPS1 - DES: 0.0300, MAE_top2k: 0.1764, n_DE: 4467
INFO:ZeroShotPerturbation:Predicting for target: ZNF562
INFO:ZeroShotPerturbation:Processing 418 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6523.02it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3377561.75it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  46%|████▌     | 165/362 [00:00<00:00, 1647.78it/s]Processing batches:  46%|████▌     | 165/362 [00:12<00:00, 1647.78it/s]Processing batches:  85%|████████▌ | 309/362 [00:12<00:02, 20.17it/s]  Processing batches:  86%|████████▌ | 311/362 [00:13<00:02, 19.95it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.95it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6447.82it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3355888.67it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  19%|█▊        | 67/362 [00:00<00:00, 586.08it/s]Processing batches:  35%|███▍      | 126/362 [00:00<00:00, 563.95it/s]Processing batches:  51%|█████     | 183/362 [00:00<00:00, 279.82it/s]Processing batches:  61%|██████▏   | 222/362 [00:04<00:04, 31.09it/s] Processing batches:  68%|██████▊   | 246/362 [00:06<00:05, 21.61it/s]Processing batches:  72%|███████▏  | 262/362 [00:08<00:05, 18.16it/s]Processing batches:  75%|███████▌  | 273/362 [00:09<00:05, 16.32it/s]Processing batches:  78%|███████▊  | 281/362 [00:10<00:05, 15.13it/s]Processing batches:  79%|███████▉  | 287/362 [00:10<00:05, 14.26it/s]Processing batches:  81%|████████  | 292/362 [00:11<00:05, 13.55it/s]Processing batches:  82%|████████▏ | 296/362 [00:11<00:05, 12.99it/s]Processing batches:  83%|████████▎ | 299/362 [00:12<00:05, 12.57it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:04, 12.13it/s]Processing batches:  84%|████████▍ | 304/362 [00:12<00:04, 11.85it/s]Processing batches:  85%|████████▍ | 306/362 [00:12<00:04, 11.53it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:04, 11.20it/s]Processing batches:  86%|████████▌ | 310/362 [00:13<00:04, 11.00it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:04, 10.67it/s]Processing batches:  87%|████████▋ | 314/362 [00:13<00:04, 10.62it/s]Processing batches:  87%|████████▋ | 316/362 [00:13<00:04, 10.48it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:04, 10.34it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:04, 10.20it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:03, 10.27it/s]Processing batches:  90%|████████▉ | 324/362 [00:14<00:03, 10.11it/s]Processing batches:  90%|█████████ | 326/362 [00:14<00:03, 10.17it/s]Processing batches:  91%|█████████ | 328/362 [00:14<00:03, 10.15it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03, 10.12it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:02, 10.10it/s]Processing batches:  92%|█████████▏| 334/362 [00:15<00:02, 10.08it/s]Processing batches:  93%|█████████▎| 336/362 [00:15<00:02, 10.08it/s]Processing batches:  93%|█████████▎| 338/362 [00:15<00:02, 10.09it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02, 10.11it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:01, 10.11it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01, 10.10it/s]Processing batches:  96%|█████████▌| 346/362 [00:16<00:01, 10.09it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:01,  9.99it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01, 10.09it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:00, 10.09it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00, 10.10it/s]Processing batches:  98%|█████████▊| 356/362 [00:17<00:00, 10.04it/s]Processing batches:  99%|█████████▉| 358/362 [00:17<00:00, 10.14it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00, 10.13it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 10.76it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.75it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target ZNF562 - DES: 0.0000, MAE_top2k: 0.0499, n_DE: 23
INFO:ZeroShotPerturbation:Predicting for target: PHF10
INFO:ZeroShotPerturbation:Processing 450 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6388.89it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3277564.78it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  36%|███▋      | 132/362 [00:00<00:00, 1196.35it/s]Processing batches:  70%|██████▉   | 252/362 [00:07<00:03, 29.06it/s]  Processing batches:  84%|████████▎ | 303/362 [00:12<00:03, 19.50it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:01, 16.78it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:00, 15.37it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00, 14.50it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.71it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6260.16it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3341544.74it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 60/362 [00:00<00:00, 584.14it/s]Processing batches:  42%|████▏     | 153/362 [00:00<00:00, 783.12it/s]Processing batches:  64%|██████▍   | 232/362 [00:05<00:03, 32.58it/s] Processing batches:  76%|███████▌  | 276/362 [00:09<00:04, 20.34it/s]Processing batches:  84%|████████▎ | 303/362 [00:12<00:03, 17.00it/s]Processing batches:  89%|████████▊ | 321/362 [00:14<00:02, 15.34it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02, 14.37it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:01, 13.66it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01, 13.15it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00, 12.72it/s]Processing batches:  99%|█████████▊| 357/362 [00:17<00:00, 12.32it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00, 12.07it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.69it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target PHF10 - DES: 0.0000, MAE_top2k: 0.1028, n_DE: 798
INFO:ZeroShotPerturbation:Predicting for target: FDPS
INFO:ZeroShotPerturbation:Processing 154 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 7570.95it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3213671.92it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 1083.67it/s]Processing batches:  80%|████████  | 291/362 [00:10<00:03, 22.77it/s]  Processing batches:  81%|████████  | 293/362 [00:10<00:03, 22.48it/s]Processing batches:  94%|█████████▎| 339/362 [00:14<00:01, 17.11it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 21.21it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 7410.43it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3368410.09it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  10%|█         | 37/362 [00:00<00:00, 347.16it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 845.80it/s]Processing batches:  73%|███████▎  | 264/362 [00:07<00:03, 25.91it/s] Processing batches:  85%|████████▌ | 309/362 [00:12<00:02, 19.33it/s]Processing batches:  93%|█████████▎| 337/362 [00:14<00:01, 16.94it/s]Processing batches:  98%|█████████▊| 355/362 [00:16<00:00, 15.68it/s]Processing batches: 100%|██████████| 362/362 [00:16<00:00, 21.36it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target FDPS - DES: 0.0005, MAE_top2k: 0.2557, n_DE: 1884
INFO:ZeroShotPerturbation:Predicting for target: OXA1L
INFO:ZeroShotPerturbation:Processing 63 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 8104.94it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3284236.31it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  42%|████▏     | 151/362 [00:00<00:00, 1473.23it/s]Processing batches:  83%|████████▎ | 299/362 [00:10<00:02, 23.60it/s]  Processing batches:  83%|████████▎ | 301/362 [00:10<00:02, 23.30it/s]Processing batches: 100%|██████████| 362/362 [00:16<00:00, 22.07it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 8542.37it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3406235.29it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 993.29it/s]Processing batches:  78%|███████▊  | 282/362 [00:09<00:03, 24.68it/s] Processing batches:  90%|████████▉ | 324/362 [00:13<00:01, 19.64it/s]Processing batches:  96%|█████████▌| 348/362 [00:15<00:00, 17.63it/s]Processing batches: 100%|██████████| 362/362 [00:16<00:00, 21.98it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target OXA1L - DES: 0.0000, MAE_top2k: 0.2681, n_DE: 373
INFO:ZeroShotPerturbation:Results saved to results/baseline/perturbation_metrics.csv
INFO:ZeroShotPerturbation:==================================================
INFO:ZeroShotPerturbation:Final Test Metrics (per eval_metrics.md Section 4.2.2):
INFO:ZeroShotPerturbation:--------------------------------------------------
INFO:ZeroShotPerturbation:Three DE Metrics (raw, averaged):
INFO:ZeroShotPerturbation:  pds_nrank:             0.5167
INFO:ZeroShotPerturbation:  mae:                   0.1258
INFO:ZeroShotPerturbation:  des:                   0.0467
INFO:ZeroShotPerturbation:--------------------------------------------------
INFO:ZeroShotPerturbation:Overall Score (0-100, from meaned metrics):
INFO:ZeroShotPerturbation:  overall_score:         0.09
INFO:ZeroShotPerturbation:==================================================
