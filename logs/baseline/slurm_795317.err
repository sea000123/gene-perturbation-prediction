/public/home/wangar2023/VCC_Project/scGPT/scgpt/model/model.py:21: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/public/home/wangar2023/VCC_Project/scGPT/scgpt/model/multiomic_model.py:19: UserWarning: flash_attn is not installed
  warnings.warn("flash_attn is not installed")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/torchtext/vocab/__init__.py:4: UserWarning: 
/!\ IMPORTANT WARNING ABOUT TORCHTEXT STATUS /!\ 
Torchtext is deprecated and the last released version will be 0.18 (this one). You can silence this warning by calling the following at the beginnign of your scripts: `import torchtext; torchtext.disable_torchtext_deprecation_warning()`
  warnings.warn(torchtext._TORCHTEXT_DEPRECATION_MSG)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/torchtext/utils.py:4: UserWarning: 
/!\ IMPORTANT WARNING ABOUT TORCHTEXT STATUS /!\ 
Torchtext is deprecated and the last released version will be 0.18 (this one). You can silence this warning by calling the following at the beginnign of your scripts: `import torchtext; torchtext.disable_torchtext_deprecation_warning()`
  warnings.warn(torchtext._TORCHTEXT_DEPRECATION_MSG)
INFO:ZeroShotPerturbation:Starting Perturbation Pipeline with baseline model
INFO:ZeroShotPerturbation:Model directory: model/scGPT
INFO:ZeroShotPerturbation:Results will be saved to: results/baseline
INFO:ZeroShotPerturbation:Initializing Baseline Model Wrapper...
INFO:ZeroShotPerturbation:Loaded vocab from model/scGPT/vocab.json
INFO:ZeroShotPerturbation:Initializing Data Loader...
INFO:ZeroShotPerturbation:Loading training data from data/processed/train.h5ad
INFO:ZeroShotPerturbation:Loading test data from data/processed/test.h5ad
INFO:ZeroShotPerturbation:Found 38176 control cells.
INFO:ZeroShotPerturbation:Fitting baseline model on training data...
INFO:ZeroShotPerturbation:Fitting baseline from AnnData: computing mean perturbed expression...
INFO:ZeroShotPerturbation:Baseline fitted: mean expression computed from 153002 perturbed samples, 18080 genes
INFO:ZeroShotPerturbation:Processing 30 target genes...
INFO:ZeroShotPerturbation:Predicting for target: AKT2
INFO:ZeroShotPerturbation:Processing 938 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3031.66it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3117364.81it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▍        | 54/362 [00:00<00:00, 520.77it/s]Processing batches:  30%|██▉       | 107/362 [00:00<00:00, 316.18it/s]Processing batches:  40%|████      | 145/362 [00:00<00:00, 320.04it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 302.86it/s]Processing batches:  59%|█████▉    | 213/362 [00:04<00:05, 25.08it/s] Processing batches:  65%|██████▍   | 234/362 [00:07<00:07, 17.12it/s]Processing batches:  69%|██████▊   | 248/362 [00:08<00:07, 14.29it/s]Processing batches:  71%|███████▏  | 258/362 [00:10<00:08, 12.81it/s]Processing batches:  73%|███████▎  | 265/362 [00:11<00:08, 11.91it/s]Processing batches:  75%|███████▍  | 270/362 [00:11<00:08, 11.27it/s]Processing batches:  76%|███████▌  | 274/362 [00:12<00:08, 10.73it/s]Processing batches:  77%|███████▋  | 277/362 [00:12<00:08, 10.40it/s]Processing batches:  77%|███████▋  | 280/362 [00:12<00:08, 10.08it/s]Processing batches:  78%|███████▊  | 282/362 [00:13<00:08,  9.78it/s]Processing batches:  78%|███████▊  | 284/362 [00:13<00:08,  9.53it/s]Processing batches:  79%|███████▉  | 286/362 [00:13<00:08,  9.19it/s]Processing batches:  80%|███████▉  | 288/362 [00:13<00:08,  8.94it/s]Processing batches:  80%|████████  | 290/362 [00:14<00:08,  8.78it/s]Processing batches:  80%|████████  | 291/362 [00:14<00:08,  8.70it/s]Processing batches:  81%|████████  | 292/362 [00:14<00:08,  8.59it/s]Processing batches:  81%|████████  | 293/362 [00:14<00:08,  8.36it/s]Processing batches:  81%|████████  | 294/362 [00:14<00:08,  8.23it/s]Processing batches:  81%|████████▏ | 295/362 [00:14<00:08,  8.17it/s]Processing batches:  82%|████████▏ | 296/362 [00:14<00:08,  8.14it/s]Processing batches:  82%|████████▏ | 297/362 [00:15<00:07,  8.17it/s]Processing batches:  82%|████████▏ | 298/362 [00:15<00:07,  8.16it/s]Processing batches:  83%|████████▎ | 299/362 [00:15<00:07,  7.94it/s]Processing batches:  83%|████████▎ | 300/362 [00:15<00:07,  8.04it/s]Processing batches:  83%|████████▎ | 301/362 [00:15<00:07,  7.96it/s]Processing batches:  83%|████████▎ | 302/362 [00:15<00:07,  7.94it/s]Processing batches:  84%|████████▎ | 303/362 [00:15<00:07,  8.06it/s]Processing batches:  84%|████████▍ | 304/362 [00:15<00:07,  8.04it/s]Processing batches:  84%|████████▍ | 305/362 [00:16<00:07,  8.05it/s]Processing batches:  85%|████████▍ | 306/362 [00:16<00:07,  7.80it/s]Processing batches:  85%|████████▍ | 307/362 [00:16<00:06,  7.86it/s]Processing batches:  85%|████████▌ | 308/362 [00:16<00:06,  7.90it/s]Processing batches:  85%|████████▌ | 309/362 [00:16<00:06,  7.97it/s]Processing batches:  86%|████████▌ | 310/362 [00:16<00:06,  7.96it/s]Processing batches:  86%|████████▌ | 311/362 [00:16<00:06,  7.95it/s]Processing batches:  86%|████████▌ | 312/362 [00:16<00:06,  7.98it/s]Processing batches:  86%|████████▋ | 313/362 [00:17<00:06,  8.07it/s]Processing batches:  87%|████████▋ | 314/362 [00:17<00:06,  7.99it/s]Processing batches:  87%|████████▋ | 315/362 [00:17<00:05,  8.03it/s]Processing batches:  87%|████████▋ | 316/362 [00:17<00:05,  8.13it/s]Processing batches:  88%|████████▊ | 317/362 [00:17<00:05,  8.02it/s]Processing batches:  88%|████████▊ | 318/362 [00:17<00:05,  8.04it/s]Processing batches:  88%|████████▊ | 319/362 [00:17<00:05,  8.07it/s]Processing batches:  88%|████████▊ | 320/362 [00:17<00:05,  8.15it/s]Processing batches:  89%|████████▊ | 321/362 [00:18<00:05,  8.16it/s]Processing batches:  89%|████████▉ | 322/362 [00:18<00:04,  8.15it/s]Processing batches:  89%|████████▉ | 323/362 [00:18<00:04,  8.23it/s]Processing batches:  90%|████████▉ | 324/362 [00:18<00:04,  8.26it/s]Processing batches:  90%|████████▉ | 325/362 [00:18<00:04,  8.22it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:04,  8.21it/s]Processing batches:  90%|█████████ | 327/362 [00:18<00:04,  8.19it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:04,  8.13it/s]Processing batches:  91%|█████████ | 329/362 [00:18<00:04,  8.14it/s]Processing batches:  91%|█████████ | 330/362 [00:19<00:03,  8.21it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:03,  7.93it/s]Processing batches:  92%|█████████▏| 332/362 [00:19<00:03,  7.82it/s]Processing batches:  92%|█████████▏| 333/362 [00:19<00:03,  8.06it/s]Processing batches:  92%|█████████▏| 334/362 [00:19<00:03,  8.09it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:03,  8.17it/s]Processing batches:  93%|█████████▎| 336/362 [00:19<00:03,  8.12it/s]Processing batches:  93%|█████████▎| 337/362 [00:19<00:03,  8.17it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:03,  7.72it/s]Processing batches:  94%|█████████▎| 339/362 [00:20<00:02,  7.87it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  8.04it/s]Processing batches:  94%|█████████▍| 341/362 [00:20<00:02,  8.07it/s]Processing batches:  94%|█████████▍| 342/362 [00:20<00:02,  8.13it/s]Processing batches:  95%|█████████▍| 343/362 [00:20<00:02,  7.94it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  8.05it/s]Processing batches:  95%|█████████▌| 345/362 [00:21<00:02,  7.76it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:02,  7.81it/s]Processing batches:  96%|█████████▌| 347/362 [00:21<00:01,  7.97it/s]Processing batches:  96%|█████████▌| 348/362 [00:21<00:01,  8.03it/s]Processing batches:  96%|█████████▋| 349/362 [00:21<00:01,  8.15it/s]Processing batches:  97%|█████████▋| 350/362 [00:21<00:01,  8.20it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  8.22it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  8.18it/s]Processing batches:  98%|█████████▊| 353/362 [00:21<00:01,  7.93it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:01,  7.97it/s]Processing batches:  98%|█████████▊| 355/362 [00:22<00:00,  7.99it/s]Processing batches:  98%|█████████▊| 356/362 [00:22<00:00,  8.13it/s]Processing batches:  99%|█████████▊| 357/362 [00:22<00:00,  8.11it/s]Processing batches:  99%|█████████▉| 358/362 [00:22<00:00,  8.14it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.20it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  8.17it/s]Processing batches: 100%|█████████▉| 361/362 [00:22<00:00,  8.16it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.71it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3187.16it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2996168.17it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  22%|██▏       | 80/362 [00:00<00:00, 697.42it/s]Processing batches:  41%|████▏     | 150/362 [00:00<00:00, 610.30it/s]Processing batches:  59%|█████▊    | 212/362 [00:04<00:04, 37.36it/s] Processing batches:  68%|██████▊   | 247/362 [00:08<00:05, 19.70it/s]Processing batches:  74%|███████▍  | 268/362 [00:10<00:05, 15.77it/s]Processing batches:  78%|███████▊  | 282/362 [00:12<00:05, 13.96it/s]Processing batches:  81%|████████  | 292/362 [00:13<00:05, 12.80it/s]Processing batches:  83%|████████▎ | 299/362 [00:14<00:05, 12.01it/s]Processing batches:  84%|████████▍ | 304/362 [00:15<00:05, 11.43it/s]Processing batches:  85%|████████▌ | 308/362 [00:15<00:04, 10.98it/s]Processing batches:  86%|████████▌ | 311/362 [00:16<00:04, 10.57it/s]Processing batches:  87%|████████▋ | 314/362 [00:16<00:04, 10.14it/s]Processing batches:  87%|████████▋ | 316/362 [00:16<00:04,  9.87it/s]Processing batches:  88%|████████▊ | 318/362 [00:17<00:04,  9.61it/s]Processing batches:  88%|████████▊ | 320/362 [00:17<00:04,  9.32it/s]Processing batches:  89%|████████▉ | 322/362 [00:17<00:04,  9.18it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:04,  9.04it/s]Processing batches:  90%|████████▉ | 325/362 [00:17<00:04,  8.94it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:04,  8.85it/s]Processing batches:  90%|█████████ | 327/362 [00:18<00:04,  8.70it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:03,  8.60it/s]Processing batches:  91%|█████████ | 329/362 [00:18<00:03,  8.55it/s]Processing batches:  91%|█████████ | 330/362 [00:18<00:03,  8.51it/s]Processing batches:  91%|█████████▏| 331/362 [00:18<00:03,  8.43it/s]Processing batches:  92%|█████████▏| 332/362 [00:18<00:03,  8.41it/s]Processing batches:  92%|█████████▏| 333/362 [00:18<00:03,  8.39it/s]Processing batches:  92%|█████████▏| 334/362 [00:19<00:03,  8.41it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:03,  8.37it/s]Processing batches:  93%|█████████▎| 336/362 [00:19<00:03,  8.08it/s]Processing batches:  93%|█████████▎| 337/362 [00:19<00:03,  8.21it/s]Processing batches:  93%|█████████▎| 338/362 [00:19<00:02,  8.23it/s]Processing batches:  94%|█████████▎| 339/362 [00:19<00:02,  8.26it/s]Processing batches:  94%|█████████▍| 340/362 [00:19<00:02,  8.28it/s]Processing batches:  94%|█████████▍| 341/362 [00:19<00:02,  8.50it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  8.42it/s]Processing batches:  95%|█████████▍| 343/362 [00:20<00:02,  8.07it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  8.23it/s]Processing batches:  95%|█████████▌| 345/362 [00:20<00:02,  8.25it/s]Processing batches:  96%|█████████▌| 346/362 [00:20<00:01,  8.24it/s]Processing batches:  96%|█████████▌| 347/362 [00:20<00:01,  8.26it/s]Processing batches:  96%|█████████▌| 348/362 [00:20<00:01,  8.32it/s]Processing batches:  96%|█████████▋| 349/362 [00:20<00:01,  8.34it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  8.37it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  8.09it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  8.12it/s]Processing batches:  98%|█████████▊| 353/362 [00:21<00:01,  8.19it/s]Processing batches:  98%|█████████▊| 354/362 [00:21<00:00,  8.19it/s]Processing batches:  98%|█████████▊| 355/362 [00:21<00:00,  8.33it/s]Processing batches:  98%|█████████▊| 356/362 [00:21<00:00,  8.19it/s]Processing batches:  99%|█████████▊| 357/362 [00:21<00:00,  8.24it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  8.37it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.02it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  8.14it/s]Processing batches: 100%|█████████▉| 361/362 [00:22<00:00,  8.29it/s]Processing batches: 100%|██████████| 362/362 [00:22<00:00, 16.17it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target AKT2 - DES: 0.0000, MAE_top2k: 0.0631, n_DE: 288
INFO:ZeroShotPerturbation:Predicting for target: MAP3K7
INFO:ZeroShotPerturbation:Processing 2019 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2983.15it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2962342.92it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  20%|█▉        | 72/362 [00:00<00:00, 715.12it/s]Processing batches:  40%|███▉      | 144/362 [00:00<00:00, 703.19it/s]Processing batches:  59%|█████▉    | 215/362 [00:05<00:05, 28.30it/s] Processing batches:  70%|███████   | 254/362 [00:11<00:07, 14.91it/s]Processing batches:  77%|███████▋  | 278/362 [00:15<00:06, 12.03it/s]Processing batches:  81%|████████  | 294/362 [00:17<00:06, 10.63it/s]Processing batches:  84%|████████▍ | 305/362 [00:19<00:05,  9.78it/s]Processing batches:  86%|████████▋ | 313/362 [00:20<00:05,  9.19it/s]Processing batches:  88%|████████▊ | 319/362 [00:21<00:04,  8.76it/s]Processing batches:  89%|████████▉ | 323/362 [00:22<00:04,  8.45it/s]Processing batches:  90%|█████████ | 326/362 [00:22<00:04,  8.21it/s]Processing batches:  91%|█████████ | 329/362 [00:23<00:04,  7.87it/s]Processing batches:  91%|█████████▏| 331/362 [00:23<00:04,  7.70it/s]Processing batches:  92%|█████████▏| 333/362 [00:24<00:03,  7.52it/s]Processing batches:  93%|█████████▎| 335/362 [00:24<00:03,  7.29it/s]Processing batches:  93%|█████████▎| 336/362 [00:24<00:03,  7.19it/s]Processing batches:  93%|█████████▎| 337/362 [00:24<00:03,  7.11it/s]Processing batches:  93%|█████████▎| 338/362 [00:24<00:03,  6.96it/s]Processing batches:  94%|█████████▎| 339/362 [00:24<00:03,  7.01it/s]Processing batches:  94%|█████████▍| 340/362 [00:25<00:03,  6.91it/s]Processing batches:  94%|█████████▍| 341/362 [00:25<00:03,  6.78it/s]Processing batches:  94%|█████████▍| 342/362 [00:25<00:02,  6.70it/s]Processing batches:  95%|█████████▍| 343/362 [00:25<00:02,  6.61it/s]Processing batches:  95%|█████████▌| 344/362 [00:25<00:02,  6.57it/s]Processing batches:  95%|█████████▌| 345/362 [00:25<00:02,  6.64it/s]Processing batches:  96%|█████████▌| 346/362 [00:26<00:02,  6.54it/s]Processing batches:  96%|█████████▌| 347/362 [00:26<00:02,  6.55it/s]Processing batches:  96%|█████████▌| 348/362 [00:26<00:02,  6.48it/s]Processing batches:  96%|█████████▋| 349/362 [00:26<00:02,  6.50it/s]Processing batches:  97%|█████████▋| 350/362 [00:26<00:01,  6.55it/s]Processing batches:  97%|█████████▋| 351/362 [00:26<00:01,  6.40it/s]Processing batches:  97%|█████████▋| 352/362 [00:26<00:01,  6.35it/s]Processing batches:  98%|█████████▊| 353/362 [00:27<00:01,  6.48it/s]Processing batches:  98%|█████████▊| 354/362 [00:27<00:01,  6.36it/s]Processing batches:  98%|█████████▊| 355/362 [00:27<00:01,  6.50it/s]Processing batches:  98%|█████████▊| 356/362 [00:27<00:00,  6.45it/s]Processing batches:  99%|█████████▊| 357/362 [00:27<00:00,  6.44it/s]Processing batches:  99%|█████████▉| 358/362 [00:27<00:00,  6.53it/s]Processing batches:  99%|█████████▉| 359/362 [00:28<00:00,  6.50it/s]Processing batches:  99%|█████████▉| 360/362 [00:28<00:00,  6.59it/s]Processing batches: 100%|█████████▉| 361/362 [00:28<00:00,  6.58it/s]Processing batches: 100%|██████████| 362/362 [00:28<00:00, 12.74it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1831.57it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2005050.54it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   7%|▋         | 26/362 [00:00<00:01, 236.15it/s]Processing batches:  24%|██▍       | 88/362 [00:00<00:00, 451.92it/s]Processing batches:  46%|████▌     | 167/362 [00:00<00:00, 597.12it/s]Processing batches:  63%|██████▎   | 228/362 [00:07<00:06, 21.51it/s] Processing batches:  73%|███████▎  | 265/362 [00:12<00:07, 13.79it/s]Processing batches:  80%|███████▉  | 289/362 [00:16<00:06, 11.44it/s]Processing batches:  84%|████████▍ | 305/362 [00:18<00:05, 10.32it/s]Processing batches:  87%|████████▋ | 316/362 [00:20<00:04,  9.64it/s]Processing batches:  90%|████████▉ | 324/362 [00:21<00:04,  9.12it/s]Processing batches:  91%|█████████ | 330/362 [00:22<00:03,  8.76it/s]Processing batches:  92%|█████████▏| 334/362 [00:23<00:03,  8.51it/s]Processing batches:  93%|█████████▎| 337/362 [00:23<00:03,  8.32it/s]Processing batches:  94%|█████████▍| 340/362 [00:24<00:02,  8.10it/s]Processing batches:  94%|█████████▍| 342/362 [00:24<00:02,  7.99it/s]Processing batches:  95%|█████████▌| 344/362 [00:24<00:02,  7.81it/s]Processing batches:  96%|█████████▌| 346/362 [00:25<00:02,  7.65it/s]Processing batches:  96%|█████████▌| 348/362 [00:25<00:01,  7.45it/s]Processing batches:  96%|█████████▋| 349/362 [00:25<00:01,  7.43it/s]Processing batches:  97%|█████████▋| 350/362 [00:25<00:01,  7.29it/s]Processing batches:  97%|█████████▋| 351/362 [00:25<00:01,  7.24it/s]Processing batches:  97%|█████████▋| 352/362 [00:25<00:01,  7.12it/s]Processing batches:  98%|█████████▊| 353/362 [00:26<00:01,  6.95it/s]Processing batches:  98%|█████████▊| 354/362 [00:26<00:01,  6.92it/s]Processing batches:  98%|█████████▊| 355/362 [00:26<00:01,  6.93it/s]Processing batches:  98%|█████████▊| 356/362 [00:26<00:00,  6.87it/s]Processing batches:  99%|█████████▊| 357/362 [00:26<00:00,  6.83it/s]Processing batches:  99%|█████████▉| 358/362 [00:26<00:00,  6.85it/s]Processing batches:  99%|█████████▉| 359/362 [00:26<00:00,  6.82it/s]Processing batches:  99%|█████████▉| 360/362 [00:27<00:00,  6.88it/s]Processing batches: 100%|█████████▉| 361/362 [00:27<00:00,  6.88it/s]Processing batches: 100%|██████████| 362/362 [00:27<00:00, 13.25it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MAP3K7 - DES: 0.0000, MAE_top2k: 0.0356, n_DE: 44
INFO:ZeroShotPerturbation:Predicting for target: ZNF426
INFO:ZeroShotPerturbation:Processing 1132 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3222.67it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2938580.81it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 62/362 [00:00<00:00, 619.11it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 891.72it/s]Processing batches:  74%|███████▍  | 269/362 [00:11<00:05, 17.28it/s] Processing batches:  75%|███████▍  | 270/362 [00:11<00:05, 17.12it/s]Processing batches:  88%|████████▊ | 319/362 [00:18<00:03, 12.13it/s]Processing batches:  96%|█████████▋| 349/362 [00:22<00:01, 10.71it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.15it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2573.19it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2349517.17it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  13%|█▎        | 46/362 [00:00<00:00, 456.21it/s]Processing batches:  28%|██▊       | 103/362 [00:00<00:00, 516.09it/s]Processing batches:  46%|████▋     | 168/362 [00:00<00:00, 566.46it/s]Processing batches:  62%|██████▏   | 225/362 [00:05<00:05, 25.14it/s] Processing batches:  72%|███████▏  | 260/362 [00:10<00:06, 16.20it/s]Processing batches:  78%|███████▊  | 283/362 [00:13<00:05, 13.51it/s]Processing batches:  83%|████████▎ | 299/362 [00:15<00:05, 12.11it/s]Processing batches:  86%|████████▌ | 310/362 [00:16<00:04, 11.26it/s]Processing batches:  88%|████████▊ | 318/362 [00:17<00:04, 10.69it/s]Processing batches:  90%|████████▉ | 324/362 [00:18<00:03, 10.29it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:03,  9.97it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:03,  9.73it/s]Processing batches:  92%|█████████▏| 334/362 [00:19<00:02,  9.44it/s]Processing batches:  93%|█████████▎| 336/362 [00:19<00:02,  9.27it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:02,  9.09it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  8.84it/s]Processing batches:  94%|█████████▍| 342/362 [00:20<00:02,  8.71it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  8.55it/s]Processing batches:  95%|█████████▌| 345/362 [00:21<00:02,  8.46it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:01,  8.45it/s]Processing batches:  96%|█████████▌| 347/362 [00:21<00:01,  8.14it/s]Processing batches:  96%|█████████▌| 348/362 [00:21<00:01,  8.14it/s]Processing batches:  96%|█████████▋| 349/362 [00:21<00:01,  8.14it/s]Processing batches:  97%|█████████▋| 350/362 [00:21<00:01,  8.11it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  8.10it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  8.10it/s]Processing batches:  98%|█████████▊| 353/362 [00:22<00:01,  8.05it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:00,  8.03it/s]Processing batches:  98%|█████████▊| 355/362 [00:22<00:00,  7.79it/s]Processing batches:  98%|█████████▊| 356/362 [00:22<00:00,  7.85it/s]Processing batches:  99%|█████████▊| 357/362 [00:22<00:00,  7.88it/s]Processing batches:  99%|█████████▉| 358/362 [00:22<00:00,  7.94it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.04it/s]Processing batches:  99%|█████████▉| 360/362 [00:23<00:00,  8.02it/s]Processing batches: 100%|█████████▉| 361/362 [00:23<00:00,  8.09it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.60it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target ZNF426 - DES: 0.0000, MAE_top2k: 0.0284, n_DE: 16
INFO:ZeroShotPerturbation:Predicting for target: DNMT1
INFO:ZeroShotPerturbation:Processing 893 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4350.94it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2782862.98it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 60/362 [00:00<00:00, 587.81it/s]Processing batches:  37%|███▋      | 133/362 [00:00<00:00, 668.56it/s]Processing batches:  55%|█████▌    | 200/362 [00:02<00:02, 56.17it/s] Processing batches:  66%|██████▌   | 238/362 [00:07<00:05, 21.45it/s]Processing batches:  72%|███████▏  | 262/362 [00:10<00:06, 16.17it/s]Processing batches:  77%|███████▋  | 278/362 [00:12<00:06, 13.94it/s]Processing batches:  80%|███████▉  | 289/362 [00:13<00:05, 12.68it/s]Processing batches:  82%|████████▏ | 297/362 [00:14<00:05, 11.86it/s]Processing batches:  84%|████████▎ | 303/362 [00:15<00:05, 11.25it/s]Processing batches:  85%|████████▍ | 307/362 [00:16<00:05, 10.82it/s]Processing batches:  86%|████████▌ | 310/362 [00:16<00:04, 10.49it/s]Processing batches:  86%|████████▋ | 313/362 [00:16<00:04, 10.12it/s]Processing batches:  87%|████████▋ | 315/362 [00:17<00:04,  9.91it/s]Processing batches:  88%|████████▊ | 317/362 [00:17<00:04,  9.67it/s]Processing batches:  88%|████████▊ | 319/362 [00:17<00:04,  9.40it/s]Processing batches:  89%|████████▊ | 321/362 [00:17<00:04,  9.17it/s]Processing batches:  89%|████████▉ | 323/362 [00:17<00:04,  8.97it/s]Processing batches:  90%|████████▉ | 324/362 [00:18<00:04,  8.92it/s]Processing batches:  90%|████████▉ | 325/362 [00:18<00:04,  8.74it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:04,  8.69it/s]Processing batches:  90%|█████████ | 327/362 [00:18<00:04,  8.65it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:04,  8.50it/s]Processing batches:  91%|█████████ | 329/362 [00:18<00:03,  8.39it/s]Processing batches:  91%|█████████ | 330/362 [00:18<00:03,  8.17it/s]Processing batches:  91%|█████████▏| 331/362 [00:18<00:03,  8.16it/s]Processing batches:  92%|█████████▏| 332/362 [00:19<00:03,  8.09it/s]Processing batches:  92%|█████████▏| 333/362 [00:19<00:03,  8.14it/s]Processing batches:  92%|█████████▏| 334/362 [00:19<00:03,  8.17it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:03,  8.08it/s]Processing batches:  93%|█████████▎| 336/362 [00:19<00:03,  8.13it/s]Processing batches:  93%|█████████▎| 337/362 [00:19<00:03,  7.88it/s]Processing batches:  93%|█████████▎| 338/362 [00:19<00:03,  7.96it/s]Processing batches:  94%|█████████▎| 339/362 [00:19<00:02,  8.03it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  8.15it/s]Processing batches:  94%|█████████▍| 341/362 [00:20<00:02,  8.16it/s]Processing batches:  94%|█████████▍| 342/362 [00:20<00:02,  8.25it/s]Processing batches:  95%|█████████▍| 343/362 [00:20<00:02,  8.21it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  8.06it/s]Processing batches:  95%|█████████▌| 345/362 [00:20<00:02,  8.07it/s]Processing batches:  96%|█████████▌| 346/362 [00:20<00:01,  8.15it/s]Processing batches:  96%|█████████▌| 347/362 [00:20<00:01,  8.19it/s]Processing batches:  96%|█████████▌| 348/362 [00:21<00:01,  8.20it/s]Processing batches:  96%|█████████▋| 349/362 [00:21<00:01,  8.09it/s]Processing batches:  97%|█████████▋| 350/362 [00:21<00:01,  8.38it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  7.99it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  7.98it/s]Processing batches:  98%|█████████▊| 353/362 [00:21<00:01,  7.89it/s]Processing batches:  98%|█████████▊| 354/362 [00:21<00:00,  8.14it/s]Processing batches:  98%|█████████▊| 355/362 [00:21<00:00,  8.14it/s]Processing batches:  98%|█████████▊| 356/362 [00:22<00:00,  8.17it/s]Processing batches:  99%|█████████▊| 357/362 [00:22<00:00,  8.31it/s]Processing batches:  99%|█████████▉| 358/362 [00:22<00:00,  8.48it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.66it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  8.79it/s]Processing batches: 100%|█████████▉| 361/362 [00:22<00:00,  8.84it/s]Processing batches: 100%|██████████| 362/362 [00:22<00:00, 15.95it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2350.41it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 1508964.61it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  21%|██        | 76/362 [00:00<00:00, 730.34it/s]Processing batches:  41%|████▏     | 150/362 [00:00<00:00, 695.79it/s]Processing batches:  61%|██████    | 220/362 [00:05<00:04, 32.34it/s] Processing batches:  72%|███████▏  | 259/362 [00:09<00:05, 18.54it/s]Processing batches:  78%|███████▊  | 283/362 [00:12<00:05, 15.05it/s]Processing batches:  83%|████████▎ | 299/362 [00:14<00:04, 13.38it/s]Processing batches:  86%|████████▌ | 310/362 [00:15<00:04, 12.35it/s]Processing batches:  88%|████████▊ | 318/362 [00:16<00:03, 11.79it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:03, 11.41it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03, 11.12it/s]Processing batches:  91%|█████████▏| 331/362 [00:18<00:02, 10.88it/s]Processing batches:  92%|█████████▏| 334/362 [00:18<00:02, 10.63it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:02, 10.41it/s]Processing batches:  93%|█████████▎| 338/362 [00:19<00:02, 10.23it/s]Processing batches:  94%|█████████▍| 340/362 [00:19<00:02, 10.06it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  9.81it/s]Processing batches:  95%|█████████▌| 344/362 [00:19<00:01,  9.56it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  9.46it/s]Processing batches:  96%|█████████▌| 348/362 [00:20<00:01,  9.41it/s]Processing batches:  96%|█████████▋| 349/362 [00:20<00:01,  9.28it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  9.30it/s]Processing batches:  97%|█████████▋| 351/362 [00:20<00:01,  9.32it/s]Processing batches:  97%|█████████▋| 352/362 [00:20<00:01,  9.33it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:00,  9.34it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  9.35it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  9.37it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  9.40it/s]Processing batches:  99%|█████████▊| 357/362 [00:21<00:00,  9.07it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  9.21it/s]Processing batches:  99%|█████████▉| 359/362 [00:21<00:00,  9.25it/s]Processing batches:  99%|█████████▉| 360/362 [00:21<00:00,  9.29it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00,  9.35it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.77it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target DNMT1 - DES: 0.3508, MAE_top2k: 0.2786, n_DE: 8383
INFO:ZeroShotPerturbation:Predicting for target: SRC
INFO:ZeroShotPerturbation:Processing 2403 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2920.82it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3357077.18it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 52/362 [00:00<00:00, 517.56it/s]Processing batches:  34%|███▎      | 122/362 [00:00<00:00, 606.84it/s]Processing batches:  51%|█████     | 183/362 [00:00<00:00, 224.73it/s]Processing batches:  61%|██████▏   | 222/362 [00:06<00:06, 22.60it/s] Processing batches:  68%|██████▊   | 246/362 [00:09<00:07, 15.61it/s]Processing batches:  72%|███████▏  | 262/362 [00:11<00:07, 13.05it/s]Processing batches:  75%|███████▌  | 273/362 [00:13<00:07, 11.69it/s]Processing batches:  78%|███████▊  | 281/362 [00:14<00:07, 10.83it/s]Processing batches:  79%|███████▉  | 287/362 [00:15<00:07, 10.19it/s]Processing batches:  80%|████████  | 291/362 [00:15<00:07,  9.77it/s]Processing batches:  81%|████████  | 294/362 [00:16<00:07,  9.36it/s]Processing batches:  82%|████████▏ | 297/362 [00:16<00:07,  9.04it/s]Processing batches:  83%|████████▎ | 299/362 [00:17<00:07,  8.82it/s]Processing batches:  83%|████████▎ | 301/362 [00:17<00:07,  8.53it/s]Processing batches:  84%|████████▎ | 303/362 [00:17<00:07,  8.22it/s]Processing batches:  84%|████████▍ | 305/362 [00:17<00:07,  7.99it/s]Processing batches:  85%|████████▍ | 306/362 [00:18<00:07,  7.87it/s]Processing batches:  85%|████████▍ | 307/362 [00:18<00:07,  7.73it/s]Processing batches:  85%|████████▌ | 308/362 [00:18<00:07,  7.51it/s]Processing batches:  85%|████████▌ | 309/362 [00:18<00:07,  7.48it/s]Processing batches:  86%|████████▌ | 310/362 [00:18<00:07,  7.38it/s]Processing batches:  86%|████████▌ | 311/362 [00:18<00:06,  7.32it/s]Processing batches:  86%|████████▌ | 312/362 [00:18<00:06,  7.26it/s]Processing batches:  86%|████████▋ | 313/362 [00:19<00:06,  7.18it/s]Processing batches:  87%|████████▋ | 314/362 [00:19<00:06,  7.10it/s]Processing batches:  87%|████████▋ | 315/362 [00:19<00:06,  7.06it/s]Processing batches:  87%|████████▋ | 316/362 [00:19<00:06,  7.06it/s]Processing batches:  88%|████████▊ | 317/362 [00:19<00:06,  7.06it/s]Processing batches:  88%|████████▊ | 318/362 [00:19<00:06,  7.08it/s]Processing batches:  88%|████████▊ | 319/362 [00:19<00:06,  6.89it/s]Processing batches:  88%|████████▊ | 320/362 [00:20<00:05,  7.04it/s]Processing batches:  89%|████████▊ | 321/362 [00:20<00:05,  7.07it/s]Processing batches:  89%|████████▉ | 322/362 [00:20<00:05,  7.15it/s]Processing batches:  89%|████████▉ | 323/362 [00:20<00:05,  7.22it/s]Processing batches:  90%|████████▉ | 324/362 [00:20<00:05,  7.22it/s]Processing batches:  90%|████████▉ | 325/362 [00:20<00:05,  7.02it/s]Processing batches:  90%|█████████ | 326/362 [00:20<00:05,  7.11it/s]Processing batches:  90%|█████████ | 327/362 [00:21<00:05,  6.98it/s]Processing batches:  91%|█████████ | 328/362 [00:21<00:04,  7.07it/s]Processing batches:  91%|█████████ | 329/362 [00:21<00:04,  7.07it/s]Processing batches:  91%|█████████ | 330/362 [00:21<00:04,  7.10it/s]Processing batches:  91%|█████████▏| 331/362 [00:21<00:04,  6.88it/s]Processing batches:  92%|█████████▏| 332/362 [00:21<00:04,  6.94it/s]Processing batches:  92%|█████████▏| 333/362 [00:21<00:04,  7.02it/s]Processing batches:  92%|█████████▏| 334/362 [00:22<00:04,  6.98it/s]Processing batches:  93%|█████████▎| 335/362 [00:22<00:03,  7.11it/s]Processing batches:  93%|█████████▎| 336/362 [00:22<00:03,  7.09it/s]Processing batches:  93%|█████████▎| 337/362 [00:22<00:03,  6.94it/s]Processing batches:  93%|█████████▎| 338/362 [00:22<00:03,  7.02it/s]Processing batches:  94%|█████████▎| 339/362 [00:22<00:03,  7.07it/s]Processing batches:  94%|█████████▍| 340/362 [00:22<00:03,  7.06it/s]Processing batches:  94%|█████████▍| 341/362 [00:23<00:02,  7.15it/s]Processing batches:  94%|█████████▍| 342/362 [00:23<00:02,  7.16it/s]Processing batches:  95%|█████████▍| 343/362 [00:23<00:02,  7.22it/s]Processing batches:  95%|█████████▌| 344/362 [00:23<00:02,  7.19it/s]Processing batches:  95%|█████████▌| 345/362 [00:23<00:02,  7.18it/s]Processing batches:  96%|█████████▌| 346/362 [00:23<00:02,  7.18it/s]Processing batches:  96%|█████████▌| 347/362 [00:23<00:02,  7.12it/s]Processing batches:  96%|█████████▌| 348/362 [00:23<00:01,  7.14it/s]Processing batches:  96%|█████████▋| 349/362 [00:24<00:01,  7.18it/s]Processing batches:  97%|█████████▋| 350/362 [00:24<00:01,  7.19it/s]Processing batches:  97%|█████████▋| 351/362 [00:24<00:01,  7.14it/s]Processing batches:  97%|█████████▋| 352/362 [00:24<00:01,  7.04it/s]Processing batches:  98%|█████████▊| 353/362 [00:24<00:01,  7.06it/s]Processing batches:  98%|█████████▊| 354/362 [00:24<00:01,  7.00it/s]Processing batches:  98%|█████████▊| 355/362 [00:24<00:00,  7.00it/s]Processing batches:  98%|█████████▊| 356/362 [00:25<00:00,  7.11it/s]Processing batches:  99%|█████████▊| 357/362 [00:25<00:00,  7.09it/s]Processing batches:  99%|█████████▉| 358/362 [00:25<00:00,  7.06it/s]Processing batches:  99%|█████████▉| 359/362 [00:25<00:00,  7.06it/s]Processing batches:  99%|█████████▉| 360/362 [00:25<00:00,  7.08it/s]Processing batches: 100%|█████████▉| 361/362 [00:25<00:00,  7.18it/s]Processing batches: 100%|██████████| 362/362 [00:25<00:00, 13.97it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1115.80it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2347626.04it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  11%|█         | 40/362 [00:00<00:00, 343.93it/s]Processing batches:  21%|██        | 75/362 [00:00<00:01, 259.65it/s]Processing batches:  42%|████▏     | 151/362 [00:00<00:00, 444.92it/s]Processing batches:  56%|█████▌    | 201/362 [00:03<00:03, 44.92it/s] Processing batches:  64%|██████▍   | 232/362 [00:07<00:06, 19.83it/s]Processing batches:  70%|██████▉   | 252/362 [00:10<00:07, 15.05it/s]Processing batches:  73%|███████▎  | 266/362 [00:12<00:07, 12.94it/s]Processing batches:  76%|███████▌  | 276/362 [00:13<00:07, 11.72it/s]Processing batches:  78%|███████▊  | 283/362 [00:14<00:07, 10.97it/s]Processing batches:  80%|███████▉  | 288/362 [00:14<00:07, 10.39it/s]Processing batches:  81%|████████  | 292/362 [00:15<00:07,  9.96it/s]Processing batches:  81%|████████▏ | 295/362 [00:15<00:07,  9.54it/s]Processing batches:  82%|████████▏ | 298/362 [00:16<00:06,  9.21it/s]Processing batches:  83%|████████▎ | 300/362 [00:16<00:06,  9.00it/s]Processing batches:  83%|████████▎ | 302/362 [00:16<00:06,  8.74it/s]Processing batches:  84%|████████▍ | 304/362 [00:17<00:06,  8.51it/s]Processing batches:  85%|████████▍ | 306/362 [00:17<00:06,  8.30it/s]Processing batches:  85%|████████▍ | 307/362 [00:17<00:06,  8.17it/s]Processing batches:  85%|████████▌ | 308/362 [00:17<00:06,  8.05it/s]Processing batches:  85%|████████▌ | 309/362 [00:17<00:06,  7.92it/s]Processing batches:  86%|████████▌ | 310/362 [00:17<00:06,  7.88it/s]Processing batches:  86%|████████▌ | 311/362 [00:18<00:06,  7.79it/s]Processing batches:  86%|████████▌ | 312/362 [00:18<00:06,  7.68it/s]Processing batches:  86%|████████▋ | 313/362 [00:18<00:06,  7.64it/s]Processing batches:  87%|████████▋ | 314/362 [00:18<00:06,  7.57it/s]Processing batches:  87%|████████▋ | 315/362 [00:18<00:06,  7.56it/s]Processing batches:  87%|████████▋ | 316/362 [00:18<00:06,  7.51it/s]Processing batches:  88%|████████▊ | 317/362 [00:18<00:05,  7.55it/s]Processing batches:  88%|████████▊ | 318/362 [00:19<00:05,  7.45it/s]Processing batches:  88%|████████▊ | 319/362 [00:19<00:05,  7.59it/s]Processing batches:  88%|████████▊ | 320/362 [00:19<00:05,  7.40it/s]Processing batches:  89%|████████▊ | 321/362 [00:19<00:05,  7.46it/s]Processing batches:  89%|████████▉ | 322/362 [00:19<00:05,  7.48it/s]Processing batches:  89%|████████▉ | 323/362 [00:19<00:05,  7.37it/s]Processing batches:  90%|████████▉ | 324/362 [00:19<00:05,  7.36it/s]Processing batches:  90%|████████▉ | 325/362 [00:19<00:04,  7.51it/s]Processing batches:  90%|█████████ | 326/362 [00:20<00:04,  7.35it/s]Processing batches:  90%|█████████ | 327/362 [00:20<00:04,  7.42it/s]Processing batches:  91%|█████████ | 328/362 [00:20<00:04,  7.42it/s]Processing batches:  91%|█████████ | 329/362 [00:20<00:04,  7.41it/s]Processing batches:  91%|█████████ | 330/362 [00:20<00:04,  7.46it/s]Processing batches:  91%|█████████▏| 331/362 [00:20<00:04,  7.30it/s]Processing batches:  92%|█████████▏| 332/362 [00:20<00:04,  7.42it/s]Processing batches:  92%|█████████▏| 333/362 [00:21<00:03,  7.42it/s]Processing batches:  92%|█████████▏| 334/362 [00:21<00:03,  7.42it/s]Processing batches:  93%|█████████▎| 335/362 [00:21<00:03,  7.49it/s]Processing batches:  93%|█████████▎| 336/362 [00:21<00:03,  7.54it/s]Processing batches:  93%|█████████▎| 337/362 [00:21<00:03,  7.51it/s]Processing batches:  93%|█████████▎| 338/362 [00:21<00:03,  7.32it/s]Processing batches:  94%|█████████▎| 339/362 [00:21<00:03,  7.39it/s]Processing batches:  94%|█████████▍| 340/362 [00:21<00:02,  7.48it/s]Processing batches:  94%|█████████▍| 341/362 [00:22<00:02,  7.52it/s]Processing batches:  94%|█████████▍| 342/362 [00:22<00:02,  7.55it/s]Processing batches:  95%|█████████▍| 343/362 [00:22<00:02,  7.53it/s]Processing batches:  95%|█████████▌| 344/362 [00:22<00:02,  7.45it/s]Processing batches:  95%|█████████▌| 345/362 [00:22<00:02,  7.54it/s]Processing batches:  96%|█████████▌| 346/362 [00:22<00:02,  7.49it/s]Processing batches:  96%|█████████▌| 347/362 [00:22<00:01,  7.53it/s]Processing batches:  96%|█████████▌| 348/362 [00:23<00:01,  7.48it/s]Processing batches:  96%|█████████▋| 349/362 [00:23<00:01,  7.58it/s]Processing batches:  97%|█████████▋| 350/362 [00:23<00:01,  7.32it/s]Processing batches:  97%|█████████▋| 351/362 [00:23<00:01,  7.57it/s]Processing batches:  97%|█████████▋| 352/362 [00:23<00:01,  7.58it/s]Processing batches:  98%|█████████▊| 353/362 [00:23<00:01,  7.54it/s]Processing batches:  98%|█████████▊| 354/362 [00:23<00:01,  7.40it/s]Processing batches:  98%|█████████▊| 355/362 [00:23<00:00,  7.52it/s]Processing batches:  98%|█████████▊| 356/362 [00:24<00:00,  7.49it/s]Processing batches:  99%|█████████▊| 357/362 [00:24<00:00,  7.51it/s]Processing batches:  99%|█████████▉| 358/362 [00:24<00:00,  7.49it/s]Processing batches:  99%|█████████▉| 359/362 [00:24<00:00,  7.56it/s]Processing batches:  99%|█████████▉| 360/362 [00:24<00:00,  7.51it/s]Processing batches: 100%|█████████▉| 361/362 [00:24<00:00,  7.50it/s]Processing batches: 100%|██████████| 362/362 [00:24<00:00, 14.56it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target SRC - DES: 0.0000, MAE_top2k: 0.0275, n_DE: 226
INFO:ZeroShotPerturbation:Predicting for target: MED13
INFO:ZeroShotPerturbation:Processing 2787 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2589.88it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3222685.66it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  21%|██▏       | 77/362 [00:00<00:00, 763.84it/s]Processing batches:  46%|████▌     | 166/362 [00:00<00:00, 832.61it/s]Processing batches:  69%|██████▉   | 250/362 [00:10<00:06, 17.25it/s] Processing batches:  69%|██████▉   | 251/362 [00:10<00:06, 17.04it/s]Processing batches:  82%|████████▏ | 297/362 [00:17<00:05, 11.14it/s]Processing batches:  90%|████████▉ | 325/362 [00:22<00:03,  9.63it/s]Processing batches:  95%|█████████▌| 344/362 [00:24<00:02,  8.91it/s]Processing batches:  99%|█████████▊| 357/362 [00:26<00:00,  8.49it/s]Processing batches: 100%|██████████| 362/362 [00:27<00:00, 13.12it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1090.56it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2257338.11it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   9%|▉         | 32/362 [00:00<00:01, 309.99it/s]Processing batches:  22%|██▏       | 79/362 [00:00<00:00, 393.85it/s]Processing batches:  35%|███▍      | 125/362 [00:00<00:00, 408.30it/s]Processing batches:  48%|████▊     | 174/362 [00:00<00:00, 436.83it/s]Processing batches:  60%|██████    | 218/362 [00:05<00:06, 22.43it/s] Processing batches:  68%|██████▊   | 247/362 [00:09<00:07, 14.44it/s]Processing batches:  73%|███████▎  | 266/362 [00:13<00:08, 11.34it/s]Processing batches:  77%|███████▋  | 279/362 [00:15<00:08,  9.80it/s]Processing batches:  80%|███████▉  | 288/362 [00:17<00:08,  8.94it/s]Processing batches:  81%|████████▏ | 295/362 [00:18<00:08,  8.35it/s]Processing batches:  83%|████████▎ | 300/362 [00:19<00:07,  7.94it/s]Processing batches:  84%|████████▍ | 304/362 [00:19<00:07,  7.60it/s]Processing batches:  85%|████████▍ | 307/362 [00:20<00:07,  7.32it/s]Processing batches:  85%|████████▌ | 309/362 [00:20<00:07,  7.14it/s]Processing batches:  86%|████████▌ | 311/362 [00:21<00:07,  6.96it/s]Processing batches:  86%|████████▋ | 313/362 [00:21<00:07,  6.72it/s]Processing batches:  87%|████████▋ | 315/362 [00:21<00:07,  6.56it/s]Processing batches:  87%|████████▋ | 316/362 [00:21<00:07,  6.49it/s]Processing batches:  88%|████████▊ | 317/362 [00:22<00:07,  6.27it/s]Processing batches:  88%|████████▊ | 318/362 [00:22<00:07,  6.22it/s]Processing batches:  88%|████████▊ | 319/362 [00:22<00:07,  6.06it/s]Processing batches:  88%|████████▊ | 320/362 [00:22<00:06,  6.10it/s]Processing batches:  89%|████████▊ | 321/362 [00:22<00:06,  6.02it/s]Processing batches:  89%|████████▉ | 322/362 [00:22<00:06,  6.08it/s]Processing batches:  89%|████████▉ | 323/362 [00:23<00:06,  5.84it/s]Processing batches:  90%|████████▉ | 324/362 [00:23<00:06,  5.87it/s]Processing batches:  90%|████████▉ | 325/362 [00:23<00:06,  5.85it/s]Processing batches:  90%|█████████ | 326/362 [00:23<00:06,  5.84it/s]Processing batches:  90%|█████████ | 327/362 [00:23<00:05,  5.85it/s]Processing batches:  91%|█████████ | 328/362 [00:23<00:05,  5.73it/s]Processing batches:  91%|█████████ | 329/362 [00:24<00:05,  5.67it/s]Processing batches:  91%|█████████ | 330/362 [00:24<00:05,  5.69it/s]Processing batches:  91%|█████████▏| 331/362 [00:24<00:05,  5.73it/s]Processing batches:  92%|█████████▏| 332/362 [00:24<00:05,  5.75it/s]Processing batches:  92%|█████████▏| 333/362 [00:24<00:05,  5.78it/s]Processing batches:  92%|█████████▏| 334/362 [00:25<00:04,  5.77it/s]Processing batches:  93%|█████████▎| 335/362 [00:25<00:04,  5.92it/s]Processing batches:  93%|█████████▎| 336/362 [00:25<00:04,  5.90it/s]Processing batches:  93%|█████████▎| 337/362 [00:25<00:04,  5.92it/s]Processing batches:  93%|█████████▎| 338/362 [00:25<00:04,  5.90it/s]Processing batches:  94%|█████████▎| 339/362 [00:25<00:03,  5.86it/s]Processing batches:  94%|█████████▍| 340/362 [00:26<00:03,  5.88it/s]Processing batches:  94%|█████████▍| 341/362 [00:26<00:03,  5.90it/s]Processing batches:  94%|█████████▍| 342/362 [00:26<00:03,  5.88it/s]Processing batches:  95%|█████████▍| 343/362 [00:26<00:03,  5.93it/s]Processing batches:  95%|█████████▌| 344/362 [00:26<00:03,  5.95it/s]Processing batches:  95%|█████████▌| 345/362 [00:26<00:02,  5.91it/s]Processing batches:  96%|█████████▌| 346/362 [00:27<00:02,  5.97it/s]Processing batches:  96%|█████████▌| 347/362 [00:27<00:02,  5.93it/s]Processing batches:  96%|█████████▌| 348/362 [00:27<00:02,  6.02it/s]Processing batches:  96%|█████████▋| 349/362 [00:27<00:02,  6.00it/s]Processing batches:  97%|█████████▋| 350/362 [00:27<00:02,  5.98it/s]Processing batches:  97%|█████████▋| 351/362 [00:27<00:01,  5.93it/s]Processing batches:  97%|█████████▋| 352/362 [00:28<00:01,  5.91it/s]Processing batches:  98%|█████████▊| 353/362 [00:28<00:01,  5.83it/s]Processing batches:  98%|█████████▊| 354/362 [00:28<00:01,  5.82it/s]Processing batches:  98%|█████████▊| 355/362 [00:28<00:01,  5.88it/s]Processing batches:  98%|█████████▊| 356/362 [00:28<00:01,  5.87it/s]Processing batches:  99%|█████████▊| 357/362 [00:28<00:00,  5.90it/s]Processing batches:  99%|█████████▉| 358/362 [00:29<00:00,  5.89it/s]Processing batches:  99%|█████████▉| 359/362 [00:29<00:00,  5.96it/s]Processing batches:  99%|█████████▉| 360/362 [00:29<00:00,  5.81it/s]Processing batches: 100%|█████████▉| 361/362 [00:29<00:00,  5.88it/s]Processing batches: 100%|██████████| 362/362 [00:29<00:00,  6.63it/s]Processing batches: 100%|██████████| 362/362 [00:29<00:00, 12.19it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MED13 - DES: 0.0653, MAE_top2k: 0.0838, n_DE: 4472
INFO:ZeroShotPerturbation:Predicting for target: KDR
INFO:ZeroShotPerturbation:Processing 2056 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2725.34it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3000673.33it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  25%|██▌       | 92/362 [00:00<00:00, 917.38it/s]Processing batches:  51%|█████     | 184/362 [00:00<00:00, 230.49it/s]Processing batches:  64%|██████▍   | 231/362 [00:08<00:06, 19.79it/s] Processing batches:  71%|███████   | 257/362 [00:12<00:07, 14.04it/s]Processing batches:  75%|███████▌  | 273/362 [00:14<00:07, 11.93it/s]Processing batches:  78%|███████▊  | 284/362 [00:16<00:07, 10.77it/s]Processing batches:  81%|████████  | 292/362 [00:17<00:07,  9.98it/s]Processing batches:  82%|████████▏ | 297/362 [00:18<00:06,  9.46it/s]Processing batches:  83%|████████▎ | 301/362 [00:19<00:06,  9.02it/s]Processing batches:  84%|████████▍ | 304/362 [00:19<00:06,  8.62it/s]Processing batches:  85%|████████▍ | 307/362 [00:20<00:06,  8.28it/s]Processing batches:  85%|████████▌ | 309/362 [00:20<00:06,  8.00it/s]Processing batches:  86%|████████▌ | 311/362 [00:20<00:06,  7.74it/s]Processing batches:  86%|████████▋ | 313/362 [00:21<00:06,  7.46it/s]Processing batches:  87%|████████▋ | 314/362 [00:21<00:06,  7.31it/s]Processing batches:  87%|████████▋ | 315/362 [00:21<00:06,  7.18it/s]Processing batches:  87%|████████▋ | 316/362 [00:21<00:06,  7.03it/s]Processing batches:  88%|████████▊ | 317/362 [00:21<00:06,  6.92it/s]Processing batches:  88%|████████▊ | 318/362 [00:21<00:06,  6.79it/s]Processing batches:  88%|████████▊ | 319/362 [00:22<00:06,  6.74it/s]Processing batches:  88%|████████▊ | 320/362 [00:22<00:06,  6.41it/s]Processing batches:  89%|████████▊ | 321/362 [00:22<00:06,  6.46it/s]Processing batches:  89%|████████▉ | 322/362 [00:22<00:06,  6.52it/s]Processing batches:  89%|████████▉ | 323/362 [00:22<00:06,  6.48it/s]Processing batches:  90%|████████▉ | 324/362 [00:22<00:05,  6.47it/s]Processing batches:  90%|████████▉ | 325/362 [00:23<00:05,  6.44it/s]Processing batches:  90%|█████████ | 326/362 [00:23<00:05,  6.31it/s]Processing batches:  90%|█████████ | 327/362 [00:23<00:05,  6.28it/s]Processing batches:  91%|█████████ | 328/362 [00:23<00:05,  6.18it/s]Processing batches:  91%|█████████ | 329/362 [00:23<00:05,  6.26it/s]Processing batches:  91%|█████████ | 330/362 [00:23<00:05,  6.35it/s]Processing batches:  91%|█████████▏| 331/362 [00:24<00:04,  6.36it/s]Processing batches:  92%|█████████▏| 332/362 [00:24<00:04,  6.42it/s]Processing batches:  92%|█████████▏| 333/362 [00:24<00:04,  6.40it/s]Processing batches:  92%|█████████▏| 334/362 [00:24<00:04,  6.36it/s]Processing batches:  93%|█████████▎| 335/362 [00:24<00:04,  6.45it/s]Processing batches:  93%|█████████▎| 336/362 [00:24<00:04,  6.40it/s]Processing batches:  93%|█████████▎| 337/362 [00:24<00:03,  6.43it/s]Processing batches:  93%|█████████▎| 338/362 [00:25<00:03,  6.41it/s]Processing batches:  94%|█████████▎| 339/362 [00:25<00:03,  6.41it/s]Processing batches:  94%|█████████▍| 340/362 [00:25<00:03,  6.38it/s]Processing batches:  94%|█████████▍| 341/362 [00:25<00:03,  6.37it/s]Processing batches:  94%|█████████▍| 342/362 [00:25<00:03,  6.34it/s]Processing batches:  95%|█████████▍| 343/362 [00:25<00:02,  6.40it/s]Processing batches:  95%|█████████▌| 344/362 [00:26<00:02,  6.38it/s]Processing batches:  95%|█████████▌| 345/362 [00:26<00:02,  6.43it/s]Processing batches:  96%|█████████▌| 346/362 [00:26<00:02,  6.31it/s]Processing batches:  96%|█████████▌| 347/362 [00:26<00:02,  6.33it/s]Processing batches:  96%|█████████▌| 348/362 [00:26<00:02,  6.35it/s]Processing batches:  96%|█████████▋| 349/362 [00:26<00:02,  6.41it/s]Processing batches:  97%|█████████▋| 350/362 [00:26<00:01,  6.36it/s]Processing batches:  97%|█████████▋| 351/362 [00:27<00:01,  6.37it/s]Processing batches:  97%|█████████▋| 352/362 [00:27<00:01,  6.37it/s]Processing batches:  98%|█████████▊| 353/362 [00:27<00:01,  6.35it/s]Processing batches:  98%|█████████▊| 354/362 [00:27<00:01,  6.40it/s]Processing batches:  98%|█████████▊| 355/362 [00:27<00:01,  6.47it/s]Processing batches:  98%|█████████▊| 356/362 [00:27<00:00,  6.49it/s]Processing batches:  99%|█████████▊| 357/362 [00:28<00:00,  6.32it/s]Processing batches:  99%|█████████▉| 358/362 [00:28<00:00,  6.38it/s]Processing batches:  99%|█████████▉| 359/362 [00:28<00:00,  6.38it/s]Processing batches:  99%|█████████▉| 360/362 [00:28<00:00,  6.42it/s]Processing batches: 100%|█████████▉| 361/362 [00:28<00:00,  6.53it/s]Processing batches: 100%|██████████| 362/362 [00:28<00:00, 12.58it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1471.69it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3002455.41it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   8%|▊         | 29/362 [00:00<00:01, 288.81it/s]Processing batches:  21%|██        | 76/362 [00:00<00:00, 381.59it/s]Processing batches:  35%|███▍      | 125/362 [00:00<00:00, 392.55it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 413.27it/s]Processing batches:  62%|██████▏   | 223/362 [00:06<00:07, 19.62it/s] Processing batches:  69%|██████▉   | 250/362 [00:10<00:08, 13.58it/s]Processing batches:  74%|███████▍  | 268/362 [00:13<00:08, 11.42it/s]Processing batches:  78%|███████▊  | 281/362 [00:15<00:07, 10.22it/s]Processing batches:  80%|████████  | 290/362 [00:16<00:07,  9.52it/s]Processing batches:  82%|████████▏ | 297/362 [00:17<00:07,  9.03it/s]Processing batches:  83%|████████▎ | 302/362 [00:18<00:06,  8.67it/s]Processing batches:  85%|████████▍ | 306/362 [00:19<00:06,  8.39it/s]Processing batches:  85%|████████▌ | 309/362 [00:19<00:06,  8.13it/s]Processing batches:  86%|████████▌ | 311/362 [00:20<00:06,  7.96it/s]Processing batches:  86%|████████▋ | 313/362 [00:20<00:06,  7.80it/s]Processing batches:  87%|████████▋ | 315/362 [00:20<00:06,  7.58it/s]Processing batches:  88%|████████▊ | 317/362 [00:20<00:06,  7.43it/s]Processing batches:  88%|████████▊ | 318/362 [00:21<00:05,  7.34it/s]Processing batches:  88%|████████▊ | 319/362 [00:21<00:05,  7.25it/s]Processing batches:  88%|████████▊ | 320/362 [00:21<00:05,  7.11it/s]Processing batches:  89%|████████▊ | 321/362 [00:21<00:05,  7.02it/s]Processing batches:  89%|████████▉ | 322/362 [00:21<00:05,  6.93it/s]Processing batches:  89%|████████▉ | 323/362 [00:21<00:05,  7.00it/s]Processing batches:  90%|████████▉ | 324/362 [00:21<00:05,  6.89it/s]Processing batches:  90%|████████▉ | 325/362 [00:22<00:05,  6.91it/s]Processing batches:  90%|█████████ | 326/362 [00:22<00:05,  6.60it/s]Processing batches:  90%|█████████ | 327/362 [00:22<00:05,  6.57it/s]Processing batches:  91%|█████████ | 328/362 [00:22<00:05,  6.58it/s]Processing batches:  91%|█████████ | 329/362 [00:22<00:04,  6.63it/s]Processing batches:  91%|█████████ | 330/362 [00:22<00:04,  6.68it/s]Processing batches:  91%|█████████▏| 331/362 [00:23<00:04,  6.67it/s]Processing batches:  92%|█████████▏| 332/362 [00:23<00:04,  6.60it/s]Processing batches:  92%|█████████▏| 333/362 [00:23<00:04,  6.71it/s]Processing batches:  92%|█████████▏| 334/362 [00:23<00:04,  6.70it/s]Processing batches:  93%|█████████▎| 335/362 [00:23<00:04,  6.72it/s]Processing batches:  93%|█████████▎| 336/362 [00:23<00:03,  6.74it/s]Processing batches:  93%|█████████▎| 337/362 [00:23<00:03,  6.74it/s]Processing batches:  93%|█████████▎| 338/362 [00:24<00:03,  6.73it/s]Processing batches:  94%|█████████▎| 339/362 [00:24<00:03,  6.74it/s]Processing batches:  94%|█████████▍| 340/362 [00:24<00:03,  6.70it/s]Processing batches:  94%|█████████▍| 341/362 [00:24<00:03,  6.73it/s]Processing batches:  94%|█████████▍| 342/362 [00:24<00:03,  6.65it/s]Processing batches:  95%|█████████▍| 343/362 [00:24<00:02,  6.71it/s]Processing batches:  95%|█████████▌| 344/362 [00:24<00:02,  6.77it/s]Processing batches:  95%|█████████▌| 345/362 [00:25<00:02,  6.76it/s]Processing batches:  96%|█████████▌| 346/362 [00:25<00:02,  6.54it/s]Processing batches:  96%|█████████▌| 347/362 [00:25<00:02,  6.62it/s]Processing batches:  96%|█████████▌| 348/362 [00:25<00:02,  6.62it/s]Processing batches:  96%|█████████▋| 349/362 [00:25<00:01,  6.61it/s]Processing batches:  97%|█████████▋| 350/362 [00:25<00:01,  6.68it/s]Processing batches:  97%|█████████▋| 351/362 [00:26<00:01,  6.67it/s]Processing batches:  97%|█████████▋| 352/362 [00:26<00:01,  6.67it/s]Processing batches:  98%|█████████▊| 353/362 [00:26<00:01,  6.66it/s]Processing batches:  98%|█████████▊| 354/362 [00:26<00:01,  6.59it/s]Processing batches:  98%|█████████▊| 355/362 [00:26<00:01,  6.70it/s]Processing batches:  98%|█████████▊| 356/362 [00:26<00:00,  6.70it/s]Processing batches:  99%|█████████▊| 357/362 [00:26<00:00,  6.70it/s]Processing batches:  99%|█████████▉| 358/362 [00:27<00:00,  6.73it/s]Processing batches:  99%|█████████▉| 359/362 [00:27<00:00,  6.68it/s]Processing batches:  99%|█████████▉| 360/362 [00:27<00:00,  6.63it/s]Processing batches: 100%|█████████▉| 361/362 [00:27<00:00,  6.76it/s]Processing batches: 100%|██████████| 362/362 [00:27<00:00, 13.12it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target KDR - DES: 0.0000, MAE_top2k: 0.0329, n_DE: 17
INFO:ZeroShotPerturbation:Predicting for target: EIF4B
INFO:ZeroShotPerturbation:Processing 1585 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2993.79it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3004477.67it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  16%|█▋        | 59/362 [00:00<00:00, 578.71it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 822.22it/s]Processing batches:  72%|███████▏  | 262/362 [00:11<00:06, 16.50it/s] Processing batches:  73%|███████▎  | 263/362 [00:12<00:06, 16.34it/s]Processing batches:  85%|████████▍ | 307/362 [00:18<00:04, 11.40it/s]Processing batches:  92%|█████████▏| 334/362 [00:22<00:02,  9.99it/s]Processing batches:  97%|█████████▋| 352/362 [00:25<00:01,  9.28it/s]Processing batches: 100%|██████████| 362/362 [00:26<00:00, 13.72it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1781.02it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 1778239.33it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  11%|█         | 39/362 [00:00<00:00, 383.00it/s]Processing batches:  31%|███       | 113/362 [00:00<00:00, 582.60it/s]Processing batches:  48%|████▊     | 172/362 [00:00<00:00, 565.44it/s]Processing batches:  63%|██████▎   | 229/362 [00:07<00:06, 21.58it/s] Processing batches:  73%|███████▎  | 264/362 [00:11<00:06, 14.46it/s]Processing batches:  79%|███████▉  | 287/362 [00:14<00:06, 12.13it/s]Processing batches:  84%|████████▎ | 303/362 [00:17<00:05, 10.91it/s]Processing batches:  87%|████████▋ | 314/362 [00:18<00:04, 10.20it/s]Processing batches:  89%|████████▉ | 322/362 [00:19<00:04,  9.70it/s]Processing batches:  91%|█████████ | 328/362 [00:20<00:03,  9.30it/s]Processing batches:  92%|█████████▏| 332/362 [00:21<00:03,  9.06it/s]Processing batches:  93%|█████████▎| 335/362 [00:21<00:03,  8.81it/s]Processing batches:  93%|█████████▎| 338/362 [00:22<00:02,  8.59it/s]Processing batches:  94%|█████████▍| 340/362 [00:22<00:02,  8.42it/s]Processing batches:  94%|█████████▍| 342/362 [00:22<00:02,  8.20it/s]Processing batches:  95%|█████████▌| 344/362 [00:22<00:02,  8.07it/s]Processing batches:  96%|█████████▌| 346/362 [00:23<00:02,  7.89it/s]Processing batches:  96%|█████████▌| 347/362 [00:23<00:01,  7.84it/s]Processing batches:  96%|█████████▌| 348/362 [00:23<00:01,  7.61it/s]Processing batches:  96%|█████████▋| 349/362 [00:23<00:01,  7.56it/s]Processing batches:  97%|█████████▋| 350/362 [00:23<00:01,  7.52it/s]Processing batches:  97%|█████████▋| 351/362 [00:23<00:01,  7.46it/s]Processing batches:  97%|█████████▋| 352/362 [00:24<00:01,  7.41it/s]Processing batches:  98%|█████████▊| 353/362 [00:24<00:01,  7.42it/s]Processing batches:  98%|█████████▊| 354/362 [00:24<00:01,  7.35it/s]Processing batches:  98%|█████████▊| 355/362 [00:24<00:00,  7.25it/s]Processing batches:  98%|█████████▊| 356/362 [00:24<00:00,  7.33it/s]Processing batches:  99%|█████████▊| 357/362 [00:24<00:00,  7.29it/s]Processing batches:  99%|█████████▉| 358/362 [00:24<00:00,  7.26it/s]Processing batches:  99%|█████████▉| 359/362 [00:24<00:00,  7.33it/s]Processing batches:  99%|█████████▉| 360/362 [00:25<00:00,  7.28it/s]Processing batches: 100%|█████████▉| 361/362 [00:25<00:00,  7.29it/s]Processing batches: 100%|██████████| 362/362 [00:25<00:00, 14.28it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target EIF4B - DES: 0.0364, MAE_top2k: 0.1126, n_DE: 4342
INFO:ZeroShotPerturbation:Predicting for target: SIX4
INFO:ZeroShotPerturbation:Processing 642 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5315.97it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2940974.07it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   8%|▊         | 28/362 [00:00<00:01, 255.07it/s]Processing batches:  39%|███▉      | 141/362 [00:00<00:00, 749.25it/s]Processing batches:  60%|██████    | 218/362 [00:04<00:03, 37.06it/s] Processing batches:  72%|███████▏  | 261/362 [00:09<00:05, 19.84it/s]Processing batches:  80%|███████▉  | 288/362 [00:12<00:04, 15.86it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:04, 13.98it/s]Processing batches:  88%|████████▊ | 318/362 [00:16<00:03, 12.92it/s]Processing batches:  90%|█████████ | 327/362 [00:17<00:02, 12.17it/s]Processing batches:  92%|█████████▏| 333/362 [00:18<00:02, 11.67it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02, 11.23it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:01, 10.86it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01, 10.58it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01, 10.38it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01, 10.18it/s]Processing batches:  97%|█████████▋| 351/362 [00:20<00:01,  9.86it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:00,  9.63it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  9.45it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  9.32it/s]Processing batches:  99%|█████████▉| 359/362 [00:21<00:00,  9.04it/s]Processing batches:  99%|█████████▉| 360/362 [00:21<00:00,  9.01it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00,  8.99it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.96it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1824.01it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 1819759.46it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  24%|██▍       | 87/362 [00:00<00:00, 868.41it/s]Processing batches:  48%|████▊     | 174/362 [00:00<00:00, 706.83it/s]Processing batches:  68%|██████▊   | 247/362 [00:07<00:05, 22.88it/s] Processing batches:  79%|███████▉  | 287/362 [00:12<00:04, 16.33it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:03, 14.08it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:02, 12.99it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:01, 12.28it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01, 11.73it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:00, 11.33it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00, 10.92it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 10.79it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.25it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target SIX4 - DES: 0.0000, MAE_top2k: 0.0535, n_DE: 96
INFO:ZeroShotPerturbation:Predicting for target: TFAM
INFO:ZeroShotPerturbation:Processing 1105 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4389.64it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2942571.74it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  36%|███▌      | 130/362 [00:00<00:00, 1296.23it/s]Processing batches:  72%|███████▏  | 260/362 [00:10<00:04, 21.25it/s]  Processing batches:  72%|███████▏  | 262/362 [00:10<00:04, 20.74it/s]Processing batches:  87%|████████▋ | 316/362 [00:17<00:03, 13.37it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:01, 11.62it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.38it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2281.37it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2434759.40it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▍        | 54/362 [00:00<00:00, 535.87it/s]Processing batches:  34%|███▍      | 124/362 [00:00<00:00, 622.20it/s]Processing batches:  52%|█████▏    | 187/362 [00:01<00:01, 139.09it/s]Processing batches:  62%|██████▏   | 225/362 [00:05<00:05, 24.72it/s] Processing batches:  69%|██████▊   | 248/362 [00:08<00:06, 17.42it/s]Processing batches:  73%|███████▎  | 263/362 [00:10<00:06, 14.72it/s]Processing batches:  76%|███████▌  | 274/362 [00:12<00:06, 13.16it/s]Processing batches:  78%|███████▊  | 282/362 [00:13<00:06, 12.15it/s]Processing batches:  80%|███████▉  | 288/362 [00:13<00:06, 11.41it/s]Processing batches:  81%|████████  | 292/362 [00:14<00:06, 10.90it/s]Processing batches:  81%|████████▏ | 295/362 [00:14<00:06, 10.52it/s]Processing batches:  82%|████████▏ | 298/362 [00:15<00:06, 10.07it/s]Processing batches:  83%|████████▎ | 300/362 [00:15<00:06,  9.82it/s]Processing batches:  83%|████████▎ | 302/362 [00:15<00:06,  9.52it/s]Processing batches:  84%|████████▍ | 304/362 [00:15<00:06,  9.17it/s]Processing batches:  85%|████████▍ | 306/362 [00:16<00:06,  8.94it/s]Processing batches:  85%|████████▌ | 308/362 [00:16<00:06,  8.70it/s]Processing batches:  85%|████████▌ | 309/362 [00:16<00:06,  8.60it/s]Processing batches:  86%|████████▌ | 310/362 [00:16<00:06,  8.52it/s]Processing batches:  86%|████████▌ | 311/362 [00:16<00:06,  8.41it/s]Processing batches:  86%|████████▌ | 312/362 [00:16<00:06,  8.32it/s]Processing batches:  86%|████████▋ | 313/362 [00:16<00:05,  8.29it/s]Processing batches:  87%|████████▋ | 314/362 [00:17<00:05,  8.21it/s]Processing batches:  87%|████████▋ | 315/362 [00:17<00:05,  8.03it/s]Processing batches:  87%|████████▋ | 316/362 [00:17<00:05,  8.06it/s]Processing batches:  88%|████████▊ | 317/362 [00:17<00:05,  8.01it/s]Processing batches:  88%|████████▊ | 318/362 [00:17<00:05,  8.00it/s]Processing batches:  88%|████████▊ | 319/362 [00:17<00:05,  8.01it/s]Processing batches:  88%|████████▊ | 320/362 [00:17<00:05,  7.97it/s]Processing batches:  89%|████████▊ | 321/362 [00:17<00:05,  7.98it/s]Processing batches:  89%|████████▉ | 322/362 [00:18<00:05,  7.99it/s]Processing batches:  89%|████████▉ | 323/362 [00:18<00:04,  8.05it/s]Processing batches:  90%|████████▉ | 324/362 [00:18<00:04,  7.95it/s]Processing batches:  90%|████████▉ | 325/362 [00:18<00:04,  7.94it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:04,  7.94it/s]Processing batches:  90%|█████████ | 327/362 [00:18<00:04,  7.94it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:04,  7.89it/s]Processing batches:  91%|█████████ | 329/362 [00:18<00:04,  8.01it/s]Processing batches:  91%|█████████ | 330/362 [00:19<00:04,  7.92it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:03,  7.89it/s]Processing batches:  92%|█████████▏| 332/362 [00:19<00:03,  7.74it/s]Processing batches:  92%|█████████▏| 333/362 [00:19<00:03,  7.76it/s]Processing batches:  92%|█████████▏| 334/362 [00:19<00:03,  7.81it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:03,  7.84it/s]Processing batches:  93%|█████████▎| 336/362 [00:19<00:03,  7.93it/s]Processing batches:  93%|█████████▎| 337/362 [00:19<00:03,  7.91it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:03,  7.91it/s]Processing batches:  94%|█████████▎| 339/362 [00:20<00:02,  7.71it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  7.74it/s]Processing batches:  94%|█████████▍| 341/362 [00:20<00:02,  7.78it/s]Processing batches:  94%|█████████▍| 342/362 [00:20<00:02,  7.88it/s]Processing batches:  95%|█████████▍| 343/362 [00:20<00:02,  7.84it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  7.85it/s]Processing batches:  95%|█████████▌| 345/362 [00:21<00:02,  7.93it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:02,  7.66it/s]Processing batches:  96%|█████████▌| 347/362 [00:21<00:01,  7.67it/s]Processing batches:  96%|█████████▌| 348/362 [00:21<00:01,  7.75it/s]Processing batches:  96%|█████████▋| 349/362 [00:21<00:01,  7.85it/s]Processing batches:  97%|█████████▋| 350/362 [00:21<00:01,  7.84it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  7.85it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  7.89it/s]Processing batches:  98%|█████████▊| 353/362 [00:22<00:01,  7.87it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:01,  7.59it/s]Processing batches:  98%|█████████▊| 355/362 [00:22<00:00,  7.75it/s]Processing batches:  98%|█████████▊| 356/362 [00:22<00:00,  7.74it/s]Processing batches:  99%|█████████▊| 357/362 [00:22<00:00,  7.79it/s]Processing batches:  99%|█████████▉| 358/362 [00:22<00:00,  7.86it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  7.82it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  7.84it/s]Processing batches: 100%|█████████▉| 361/362 [00:23<00:00,  7.80it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.64it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target TFAM - DES: 0.0133, MAE_top2k: 0.1084, n_DE: 3449
INFO:ZeroShotPerturbation:Predicting for target: MAST2
INFO:ZeroShotPerturbation:Processing 1029 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4497.91it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2935509.48it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  39%|███▊      | 140/362 [00:00<00:00, 1392.95it/s]Processing batches:  77%|███████▋  | 280/362 [00:12<00:04, 18.59it/s]  Processing batches:  78%|███████▊  | 282/362 [00:13<00:04, 18.28it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:01, 12.71it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.60it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1681.76it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2053147.86it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  18%|█▊        | 64/362 [00:00<00:00, 614.12it/s]Processing batches:  35%|███▍      | 126/362 [00:00<00:00, 565.15it/s]Processing batches:  51%|█████     | 183/362 [00:00<00:00, 279.07it/s]Processing batches:  61%|██████▏   | 222/362 [00:05<00:05, 25.32it/s] Processing batches:  68%|██████▊   | 246/362 [00:08<00:06, 17.47it/s]Processing batches:  72%|███████▏  | 262/362 [00:10<00:06, 14.63it/s]Processing batches:  75%|███████▌  | 273/362 [00:11<00:06, 13.12it/s]Processing batches:  78%|███████▊  | 281/362 [00:12<00:06, 12.16it/s]Processing batches:  79%|███████▉  | 287/362 [00:13<00:06, 11.46it/s]Processing batches:  80%|████████  | 291/362 [00:14<00:06, 10.96it/s]Processing batches:  81%|████████  | 294/362 [00:14<00:06, 10.56it/s]Processing batches:  82%|████████▏ | 297/362 [00:14<00:06, 10.11it/s]Processing batches:  83%|████████▎ | 299/362 [00:15<00:06,  9.87it/s]Processing batches:  83%|████████▎ | 301/362 [00:15<00:06,  9.51it/s]Processing batches:  84%|████████▎ | 303/362 [00:15<00:06,  9.27it/s]Processing batches:  84%|████████▍ | 305/362 [00:15<00:06,  8.99it/s]Processing batches:  85%|████████▍ | 307/362 [00:16<00:06,  8.69it/s]Processing batches:  85%|████████▌ | 308/362 [00:16<00:06,  8.55it/s]Processing batches:  85%|████████▌ | 309/362 [00:16<00:06,  8.51it/s]Processing batches:  86%|████████▌ | 310/362 [00:16<00:06,  8.36it/s]Processing batches:  86%|████████▌ | 311/362 [00:16<00:06,  8.28it/s]Processing batches:  86%|████████▌ | 312/362 [00:16<00:06,  8.28it/s]Processing batches:  86%|████████▋ | 313/362 [00:16<00:05,  8.21it/s]Processing batches:  87%|████████▋ | 314/362 [00:16<00:05,  8.25it/s]Processing batches:  87%|████████▋ | 315/362 [00:17<00:05,  8.24it/s]Processing batches:  87%|████████▋ | 316/362 [00:17<00:05,  8.29it/s]Processing batches:  88%|████████▊ | 317/362 [00:17<00:05,  8.23it/s]Processing batches:  88%|████████▊ | 318/362 [00:17<00:05,  8.21it/s]Processing batches:  88%|████████▊ | 319/362 [00:17<00:05,  8.21it/s]Processing batches:  88%|████████▊ | 320/362 [00:17<00:05,  8.04it/s]Processing batches:  89%|████████▊ | 321/362 [00:17<00:04,  8.24it/s]Processing batches:  89%|████████▉ | 322/362 [00:17<00:04,  8.17it/s]Processing batches:  89%|████████▉ | 323/362 [00:18<00:04,  8.22it/s]Processing batches:  90%|████████▉ | 324/362 [00:18<00:04,  8.15it/s]Processing batches:  90%|████████▉ | 325/362 [00:18<00:04,  8.18it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:04,  8.23it/s]Processing batches:  90%|█████████ | 327/362 [00:18<00:04,  8.19it/s]Processing batches:  91%|█████████ | 328/362 [00:18<00:04,  8.09it/s]Processing batches:  91%|█████████ | 329/362 [00:18<00:04,  8.09it/s]Processing batches:  91%|█████████ | 330/362 [00:18<00:03,  8.21it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:03,  8.11it/s]Processing batches:  92%|█████████▏| 332/362 [00:19<00:03,  8.20it/s]Processing batches:  92%|█████████▏| 333/362 [00:19<00:03,  8.15it/s]Processing batches:  92%|█████████▏| 334/362 [00:19<00:03,  8.13it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:03,  8.15it/s]Processing batches:  93%|█████████▎| 336/362 [00:19<00:03,  8.24it/s]Processing batches:  93%|█████████▎| 337/362 [00:19<00:03,  7.95it/s]Processing batches:  93%|█████████▎| 338/362 [00:19<00:03,  7.96it/s]Processing batches:  94%|█████████▎| 339/362 [00:19<00:02,  8.05it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  8.14it/s]Processing batches:  94%|█████████▍| 341/362 [00:20<00:02,  8.13it/s]Processing batches:  94%|█████████▍| 342/362 [00:20<00:02,  8.13it/s]Processing batches:  95%|█████████▍| 343/362 [00:20<00:02,  8.10it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  7.87it/s]Processing batches:  95%|█████████▌| 345/362 [00:20<00:02,  7.98it/s]Processing batches:  96%|█████████▌| 346/362 [00:20<00:01,  8.10it/s]Processing batches:  96%|█████████▌| 347/362 [00:20<00:01,  8.12it/s]Processing batches:  96%|█████████▌| 348/362 [00:21<00:01,  8.15it/s]Processing batches:  96%|█████████▋| 349/362 [00:21<00:01,  8.18it/s]Processing batches:  97%|█████████▋| 350/362 [00:21<00:01,  8.30it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  8.28it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  7.93it/s]Processing batches:  98%|█████████▊| 353/362 [00:21<00:01,  8.11it/s]Processing batches:  98%|█████████▊| 354/362 [00:21<00:00,  8.09it/s]Processing batches:  98%|█████████▊| 355/362 [00:21<00:00,  8.14it/s]Processing batches:  98%|█████████▊| 356/362 [00:22<00:00,  8.26it/s]Processing batches:  99%|█████████▊| 357/362 [00:22<00:00,  8.28it/s]Processing batches:  99%|█████████▉| 358/362 [00:22<00:00,  8.29it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.25it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  8.03it/s]Processing batches: 100%|█████████▉| 361/362 [00:22<00:00,  8.09it/s]Processing batches: 100%|██████████| 362/362 [00:22<00:00, 15.90it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MAST2 - DES: 0.0000, MAE_top2k: 0.0384, n_DE: 9
INFO:ZeroShotPerturbation:Predicting for target: SMAGP
INFO:ZeroShotPerturbation:Processing 788 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3880.02it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3064703.21it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  36%|███▋      | 132/362 [00:00<00:00, 1312.41it/s]Processing batches:  73%|███████▎  | 264/362 [00:10<00:04, 22.09it/s]  Processing batches:  73%|███████▎  | 266/362 [00:10<00:04, 21.63it/s]Processing batches:  89%|████████▊ | 321/362 [00:17<00:02, 14.10it/s]Processing batches:  97%|█████████▋| 352/362 [00:20<00:00, 12.28it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.46it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1731.75it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 1554656.12it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  15%|█▍        | 53/362 [00:00<00:00, 525.28it/s]Processing batches:  36%|███▋      | 132/362 [00:00<00:00, 653.31it/s]Processing batches:  55%|█████▍    | 198/362 [00:02<00:02, 67.30it/s] Processing batches:  65%|██████▍   | 235/362 [00:06<00:05, 23.92it/s]Processing batches:  71%|███████▏  | 258/362 [00:09<00:05, 17.75it/s]Processing batches:  75%|███████▌  | 273/362 [00:11<00:05, 15.25it/s]Processing batches:  78%|███████▊  | 284/362 [00:12<00:05, 13.81it/s]Processing batches:  81%|████████  | 292/362 [00:13<00:05, 12.85it/s]Processing batches:  82%|████████▏ | 298/362 [00:13<00:05, 12.14it/s]Processing batches:  83%|████████▎ | 302/362 [00:14<00:05, 11.60it/s]Processing batches:  84%|████████▍ | 305/362 [00:14<00:05, 11.16it/s]Processing batches:  85%|████████▌ | 308/362 [00:15<00:05, 10.78it/s]Processing batches:  86%|████████▌ | 310/362 [00:15<00:04, 10.52it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:04, 10.11it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:04,  9.86it/s]Processing batches:  87%|████████▋ | 316/362 [00:16<00:04,  9.61it/s]Processing batches:  88%|████████▊ | 318/362 [00:16<00:04,  9.25it/s]Processing batches:  88%|████████▊ | 319/362 [00:16<00:04,  9.17it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04,  9.08it/s]Processing batches:  89%|████████▊ | 321/362 [00:16<00:04,  9.03it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  8.93it/s]Processing batches:  89%|████████▉ | 323/362 [00:16<00:04,  8.86it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:04,  8.79it/s]Processing batches:  90%|████████▉ | 325/362 [00:17<00:04,  8.71it/s]Processing batches:  90%|█████████ | 326/362 [00:17<00:04,  8.67it/s]Processing batches:  90%|█████████ | 327/362 [00:17<00:04,  8.63it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03,  8.64it/s]Processing batches:  91%|█████████ | 329/362 [00:17<00:03,  8.62it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  8.61it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  8.69it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  8.72it/s]Processing batches:  92%|█████████▏| 333/362 [00:18<00:03,  8.63it/s]Processing batches:  92%|█████████▏| 334/362 [00:18<00:03,  8.64it/s]Processing batches:  93%|█████████▎| 335/362 [00:18<00:03,  8.58it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:03,  8.54it/s]Processing batches:  93%|█████████▎| 337/362 [00:18<00:02,  8.57it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.60it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.64it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.40it/s]Processing batches:  94%|█████████▍| 341/362 [00:19<00:02,  8.47it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  8.66it/s]Processing batches:  95%|█████████▍| 343/362 [00:19<00:02,  8.61it/s]Processing batches:  95%|█████████▌| 344/362 [00:19<00:02,  8.50it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01,  8.58it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  8.60it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.60it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.48it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  8.40it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  8.32it/s]Processing batches:  97%|█████████▋| 351/362 [00:20<00:01,  8.39it/s]Processing batches:  97%|█████████▋| 352/362 [00:20<00:01,  8.50it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:01,  8.53it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  8.53it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  8.55it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  8.64it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.27it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  8.32it/s]Processing batches:  99%|█████████▉| 359/362 [00:21<00:00,  8.52it/s]Processing batches:  99%|█████████▉| 360/362 [00:21<00:00,  8.52it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00,  8.56it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.86it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target SMAGP - DES: 0.0011, MAE_top2k: 0.0809, n_DE: 878
INFO:ZeroShotPerturbation:Predicting for target: XRCC4
INFO:ZeroShotPerturbation:Processing 591 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5540.69it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3286656.11it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  47%|████▋     | 170/362 [00:00<00:00, 1698.23it/s]Processing batches:  47%|████▋     | 170/362 [00:15<00:00, 1698.23it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:02, 17.28it/s]  Processing batches:  88%|████████▊ | 319/362 [00:15<00:02, 17.20it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.13it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2473.79it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 1958547.90it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 60/362 [00:00<00:00, 597.26it/s]Processing batches:  33%|███▎      | 121/362 [00:00<00:00, 572.24it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 441.86it/s]Processing batches:  64%|██████▎   | 230/362 [00:05<00:04, 27.52it/s] Processing batches:  72%|███████▏  | 259/362 [00:08<00:05, 19.51it/s]Processing batches:  77%|███████▋  | 278/362 [00:10<00:05, 16.65it/s]Processing batches:  80%|████████  | 291/362 [00:11<00:04, 15.10it/s]Processing batches:  83%|████████▎ | 300/362 [00:12<00:04, 14.17it/s]Processing batches:  85%|████████▍ | 307/362 [00:13<00:04, 13.44it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:03, 12.91it/s]Processing batches:  87%|████████▋ | 316/362 [00:14<00:03, 12.43it/s]Processing batches:  88%|████████▊ | 319/362 [00:14<00:03, 12.03it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:03, 11.69it/s]Processing batches:  90%|████████▉ | 324/362 [00:14<00:03, 11.45it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03, 11.09it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03, 10.87it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03, 10.63it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:02, 10.35it/s]Processing batches:  92%|█████████▏| 334/362 [00:15<00:02, 10.23it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02, 10.15it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02, 10.04it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02, 10.00it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:02,  9.98it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01,  9.91it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.94it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.91it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.84it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.85it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.86it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.86it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:01,  9.90it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00,  9.68it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.85it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.87it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.89it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.89it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.84it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.86it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.88it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.33it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target XRCC4 - DES: 0.0000, MAE_top2k: 0.0899, n_DE: 1420
INFO:ZeroShotPerturbation:Predicting for target: HMGN1
INFO:ZeroShotPerturbation:Processing 2004 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3247.62it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3183585.91it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  26%|██▌       | 95/362 [00:00<00:00, 945.59it/s]Processing batches:  52%|█████▏    | 190/362 [00:01<00:01, 115.33it/s]Processing batches:  65%|██████▍   | 234/362 [00:07<00:05, 22.91it/s] Processing batches:  71%|███████▏  | 258/362 [00:10<00:06, 16.76it/s]Processing batches:  75%|███████▌  | 273/362 [00:12<00:06, 14.30it/s]Processing batches:  78%|███████▊  | 283/362 [00:13<00:06, 12.98it/s]Processing batches:  80%|████████  | 290/362 [00:14<00:05, 12.07it/s]Processing batches:  81%|████████▏ | 295/362 [00:15<00:05, 11.39it/s]Processing batches:  83%|████████▎ | 299/362 [00:15<00:05, 10.83it/s]Processing batches:  83%|████████▎ | 302/362 [00:16<00:05, 10.38it/s]Processing batches:  84%|████████▍ | 305/362 [00:16<00:05,  9.91it/s]Processing batches:  85%|████████▍ | 307/362 [00:17<00:05,  9.57it/s]Processing batches:  85%|████████▌ | 309/362 [00:17<00:05,  9.23it/s]Processing batches:  86%|████████▌ | 311/362 [00:17<00:05,  8.82it/s]Processing batches:  86%|████████▋ | 313/362 [00:17<00:05,  8.62it/s]Processing batches:  87%|████████▋ | 314/362 [00:17<00:05,  8.47it/s]Processing batches:  87%|████████▋ | 315/362 [00:18<00:05,  8.32it/s]Processing batches:  87%|████████▋ | 316/362 [00:18<00:05,  8.17it/s]Processing batches:  88%|████████▊ | 317/362 [00:18<00:05,  8.06it/s]Processing batches:  88%|████████▊ | 318/362 [00:18<00:05,  7.84it/s]Processing batches:  88%|████████▊ | 319/362 [00:18<00:05,  7.76it/s]Processing batches:  88%|████████▊ | 320/362 [00:18<00:05,  7.73it/s]Processing batches:  89%|████████▊ | 321/362 [00:18<00:05,  7.67it/s]Processing batches:  89%|████████▉ | 322/362 [00:19<00:05,  7.71it/s]Processing batches:  89%|████████▉ | 323/362 [00:19<00:05,  7.59it/s]Processing batches:  90%|████████▉ | 324/362 [00:19<00:04,  7.61it/s]Processing batches:  90%|████████▉ | 325/362 [00:19<00:04,  7.59it/s]Processing batches:  90%|█████████ | 326/362 [00:19<00:04,  7.64it/s]Processing batches:  90%|█████████ | 327/362 [00:19<00:04,  7.58it/s]Processing batches:  91%|█████████ | 328/362 [00:19<00:04,  7.50it/s]Processing batches:  91%|█████████ | 329/362 [00:19<00:04,  7.30it/s]Processing batches:  91%|█████████ | 330/362 [00:20<00:04,  7.41it/s]Processing batches:  91%|█████████▏| 331/362 [00:20<00:04,  7.29it/s]Processing batches:  92%|█████████▏| 332/362 [00:20<00:04,  7.49it/s]Processing batches:  92%|█████████▏| 333/362 [00:20<00:03,  7.50it/s]Processing batches:  92%|█████████▏| 334/362 [00:20<00:03,  7.48it/s]Processing batches:  93%|█████████▎| 335/362 [00:20<00:03,  7.35it/s]Processing batches:  93%|█████████▎| 336/362 [00:20<00:03,  7.38it/s]Processing batches:  93%|█████████▎| 337/362 [00:21<00:03,  7.43it/s]Processing batches:  93%|█████████▎| 338/362 [00:21<00:03,  7.46it/s]Processing batches:  94%|█████████▎| 339/362 [00:21<00:03,  7.55it/s]Processing batches:  94%|█████████▍| 340/362 [00:21<00:02,  7.56it/s]Processing batches:  94%|█████████▍| 341/362 [00:21<00:02,  7.52it/s]Processing batches:  94%|█████████▍| 342/362 [00:21<00:02,  7.39it/s]Processing batches:  95%|█████████▍| 343/362 [00:21<00:02,  7.58it/s]Processing batches:  95%|█████████▌| 344/362 [00:21<00:02,  7.63it/s]Processing batches:  95%|█████████▌| 345/362 [00:22<00:02,  7.61it/s]Processing batches:  96%|█████████▌| 346/362 [00:22<00:02,  7.56it/s]Processing batches:  96%|█████████▌| 347/362 [00:22<00:01,  7.56it/s]Processing batches:  96%|█████████▌| 348/362 [00:22<00:01,  7.49it/s]Processing batches:  96%|█████████▋| 349/362 [00:22<00:01,  7.60it/s]Processing batches:  97%|█████████▋| 350/362 [00:22<00:01,  7.60it/s]Processing batches:  97%|█████████▋| 351/362 [00:22<00:01,  7.58it/s]Processing batches:  97%|█████████▋| 352/362 [00:23<00:01,  7.58it/s]Processing batches:  98%|█████████▊| 353/362 [00:23<00:01,  7.40it/s]Processing batches:  98%|█████████▊| 354/362 [00:23<00:01,  7.52it/s]Processing batches:  98%|█████████▊| 355/362 [00:23<00:00,  7.59it/s]Processing batches:  98%|█████████▊| 356/362 [00:23<00:00,  7.64it/s]Processing batches:  99%|█████████▊| 357/362 [00:23<00:00,  7.61it/s]Processing batches:  99%|█████████▉| 358/362 [00:23<00:00,  7.54it/s]Processing batches:  99%|█████████▉| 359/362 [00:23<00:00,  7.60it/s]Processing batches:  99%|█████████▉| 360/362 [00:24<00:00,  7.57it/s]Processing batches: 100%|█████████▉| 361/362 [00:24<00:00,  7.65it/s]Processing batches: 100%|██████████| 362/362 [00:24<00:00, 14.89it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2395.38it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2503318.14it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  11%|█▏        | 41/362 [00:00<00:00, 399.17it/s]Processing batches:  24%|██▍       | 87/362 [00:00<00:00, 413.96it/s]Processing batches:  46%|████▌     | 166/362 [00:00<00:00, 579.68it/s]Processing batches:  62%|██████▏   | 225/362 [00:05<00:05, 26.32it/s] Processing batches:  72%|███████▏  | 261/362 [00:10<00:06, 16.56it/s]Processing batches:  79%|███████▊  | 285/362 [00:13<00:05, 13.65it/s]Processing batches:  83%|████████▎ | 301/362 [00:15<00:04, 12.24it/s]Processing batches:  86%|████████▌ | 312/362 [00:16<00:04, 11.42it/s]Processing batches:  88%|████████▊ | 320/362 [00:17<00:03, 10.84it/s]Processing batches:  90%|█████████ | 326/362 [00:18<00:03, 10.39it/s]Processing batches:  91%|█████████▏| 331/362 [00:19<00:03, 10.02it/s]Processing batches:  93%|█████████▎| 335/362 [00:19<00:02,  9.70it/s]Processing batches:  93%|█████████▎| 338/362 [00:20<00:02,  9.42it/s]Processing batches:  94%|█████████▍| 340/362 [00:20<00:02,  9.25it/s]Processing batches:  94%|█████████▍| 342/362 [00:20<00:02,  9.08it/s]Processing batches:  95%|█████████▌| 344/362 [00:20<00:02,  8.86it/s]Processing batches:  96%|█████████▌| 346/362 [00:21<00:01,  8.68it/s]Processing batches:  96%|█████████▌| 348/362 [00:21<00:01,  8.53it/s]Processing batches:  96%|█████████▋| 349/362 [00:21<00:01,  8.49it/s]Processing batches:  97%|█████████▋| 350/362 [00:21<00:01,  8.39it/s]Processing batches:  97%|█████████▋| 351/362 [00:21<00:01,  8.27it/s]Processing batches:  97%|█████████▋| 352/362 [00:21<00:01,  8.18it/s]Processing batches:  98%|█████████▊| 353/362 [00:22<00:01,  8.15it/s]Processing batches:  98%|█████████▊| 354/362 [00:22<00:00,  8.09it/s]Processing batches:  98%|█████████▊| 355/362 [00:22<00:00,  8.08it/s]Processing batches:  98%|█████████▊| 356/362 [00:22<00:00,  8.08it/s]Processing batches:  99%|█████████▊| 357/362 [00:22<00:00,  8.04it/s]Processing batches:  99%|█████████▉| 358/362 [00:22<00:00,  8.04it/s]Processing batches:  99%|█████████▉| 359/362 [00:22<00:00,  8.07it/s]Processing batches:  99%|█████████▉| 360/362 [00:22<00:00,  8.04it/s]Processing batches: 100%|█████████▉| 361/362 [00:23<00:00,  8.06it/s]Processing batches: 100%|██████████| 362/362 [00:23<00:00, 15.65it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target HMGN1 - DES: 0.0000, MAE_top2k: 0.0334, n_DE: 13
INFO:ZeroShotPerturbation:Predicting for target: GSK3B
INFO:ZeroShotPerturbation:Processing 1059 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4440.77it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3327322.90it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 63/362 [00:00<00:00, 620.92it/s]Processing batches:  42%|████▏     | 152/362 [00:00<00:00, 759.78it/s]Processing batches:  63%|██████▎   | 228/362 [00:05<00:04, 30.95it/s] Processing batches:  75%|███████▍  | 270/362 [00:10<00:04, 18.71it/s]Processing batches:  82%|████████▏ | 296/362 [00:13<00:04, 15.48it/s]Processing batches:  86%|████████▋ | 313/362 [00:15<00:03, 13.86it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:02, 12.92it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:02, 12.29it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:01, 11.80it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:01, 11.40it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01, 11.03it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01, 10.77it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:00, 10.55it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00, 10.33it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00, 10.03it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  9.83it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  9.68it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.52it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1923.99it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2263874.86it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  12%|█▏        | 45/362 [00:00<00:00, 411.38it/s]Processing batches:  27%|██▋       | 97/362 [00:00<00:00, 467.88it/s]Processing batches:  40%|███▉      | 144/362 [00:00<00:00, 429.43it/s]Processing batches:  52%|█████▏    | 188/362 [00:01<00:01, 113.14it/s]Processing batches:  60%|█████▉    | 217/362 [00:04<00:05, 28.50it/s] Processing batches:  65%|██████▌   | 236/362 [00:06<00:06, 20.07it/s]Processing batches:  69%|██████▉   | 249/362 [00:07<00:06, 16.80it/s]Processing batches:  71%|███████▏  | 258/362 [00:08<00:06, 15.05it/s]Processing batches:  73%|███████▎  | 265/362 [00:09<00:07, 13.85it/s]Processing batches:  75%|███████▍  | 270/362 [00:10<00:07, 13.03it/s]Processing batches:  76%|███████▌  | 274/362 [00:10<00:07, 12.38it/s]Processing batches:  77%|███████▋  | 277/362 [00:11<00:07, 11.85it/s]Processing batches:  77%|███████▋  | 280/362 [00:11<00:07, 11.36it/s]Processing batches:  78%|███████▊  | 282/362 [00:11<00:07, 11.05it/s]Processing batches:  78%|███████▊  | 284/362 [00:11<00:07, 10.74it/s]Processing batches:  79%|███████▉  | 286/362 [00:11<00:07, 10.41it/s]Processing batches:  80%|███████▉  | 288/362 [00:12<00:07, 10.11it/s]Processing batches:  80%|████████  | 290/362 [00:12<00:07,  9.88it/s]Processing batches:  81%|████████  | 292/362 [00:12<00:07,  9.62it/s]Processing batches:  81%|████████  | 294/362 [00:12<00:07,  9.53it/s]Processing batches:  81%|████████▏ | 295/362 [00:12<00:07,  9.45it/s]Processing batches:  82%|████████▏ | 296/362 [00:13<00:07,  9.36it/s]Processing batches:  82%|████████▏ | 297/362 [00:13<00:06,  9.30it/s]Processing batches:  82%|████████▏ | 298/362 [00:13<00:06,  9.25it/s]Processing batches:  83%|████████▎ | 299/362 [00:13<00:07,  8.89it/s]Processing batches:  83%|████████▎ | 301/362 [00:13<00:06,  9.11it/s]Processing batches:  83%|████████▎ | 302/362 [00:13<00:06,  9.13it/s]Processing batches:  84%|████████▎ | 303/362 [00:13<00:06,  9.11it/s]Processing batches:  84%|████████▍ | 304/362 [00:13<00:06,  9.08it/s]Processing batches:  84%|████████▍ | 305/362 [00:14<00:06,  9.04it/s]Processing batches:  85%|████████▍ | 306/362 [00:14<00:06,  9.08it/s]Processing batches:  85%|████████▍ | 307/362 [00:14<00:06,  8.79it/s]Processing batches:  85%|████████▌ | 308/362 [00:14<00:06,  8.87it/s]Processing batches:  85%|████████▌ | 309/362 [00:14<00:05,  8.98it/s]Processing batches:  86%|████████▌ | 310/362 [00:14<00:05,  9.02it/s]Processing batches:  86%|████████▌ | 311/362 [00:14<00:05,  9.01it/s]Processing batches:  86%|████████▌ | 312/362 [00:14<00:05,  9.04it/s]Processing batches:  86%|████████▋ | 313/362 [00:14<00:05,  8.83it/s]Processing batches:  87%|████████▋ | 314/362 [00:15<00:05,  8.82it/s]Processing batches:  87%|████████▋ | 315/362 [00:15<00:05,  8.96it/s]Processing batches:  87%|████████▋ | 316/362 [00:15<00:05,  9.05it/s]Processing batches:  88%|████████▊ | 317/362 [00:15<00:04,  9.01it/s]Processing batches:  88%|████████▊ | 318/362 [00:15<00:04,  9.05it/s]Processing batches:  88%|████████▊ | 319/362 [00:15<00:04,  8.85it/s]Processing batches:  88%|████████▊ | 320/362 [00:15<00:04,  8.93it/s]Processing batches:  89%|████████▊ | 321/362 [00:15<00:04,  9.04it/s]Processing batches:  89%|████████▉ | 322/362 [00:15<00:04,  9.06it/s]Processing batches:  89%|████████▉ | 323/362 [00:16<00:04,  9.11it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:04,  9.16it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:04,  9.15it/s]Processing batches:  90%|█████████ | 326/362 [00:16<00:03,  9.10it/s]Processing batches:  90%|█████████ | 327/362 [00:16<00:03,  9.11it/s]Processing batches:  91%|█████████ | 328/362 [00:16<00:03,  9.10it/s]Processing batches:  91%|█████████ | 329/362 [00:16<00:03,  9.10it/s]Processing batches:  91%|█████████ | 330/362 [00:16<00:03,  9.14it/s]Processing batches:  91%|█████████▏| 331/362 [00:16<00:03,  9.12it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  9.07it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  9.04it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  8.98it/s]Processing batches:  93%|█████████▎| 335/362 [00:17<00:02,  9.13it/s]Processing batches:  93%|█████████▎| 336/362 [00:17<00:02,  9.12it/s]Processing batches:  93%|█████████▎| 337/362 [00:17<00:02,  9.08it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:02,  9.10it/s]Processing batches:  94%|█████████▎| 339/362 [00:17<00:02,  9.13it/s]Processing batches:  94%|█████████▍| 340/362 [00:17<00:02,  9.11it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  9.12it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  9.11it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  9.13it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:01,  9.11it/s]Processing batches:  95%|█████████▌| 345/362 [00:18<00:01,  9.02it/s]Processing batches:  96%|█████████▌| 346/362 [00:18<00:01,  9.20it/s]Processing batches:  96%|█████████▌| 347/362 [00:18<00:01,  9.13it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01,  9.17it/s]Processing batches:  96%|█████████▋| 349/362 [00:18<00:01,  8.98it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  8.99it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  9.07it/s]Processing batches:  97%|█████████▋| 352/362 [00:19<00:01,  9.05it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:00,  9.07it/s]Processing batches:  98%|█████████▊| 354/362 [00:19<00:00,  9.08it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00,  9.12it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00,  9.08it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00,  9.13it/s]Processing batches:  99%|█████████▉| 358/362 [00:19<00:00,  9.10it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  9.13it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  9.18it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  8.88it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.79it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target GSK3B - DES: 0.0167, MAE_top2k: 0.1114, n_DE: 3169
INFO:ZeroShotPerturbation:Predicting for target: TMBIM6
INFO:ZeroShotPerturbation:Processing 505 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5733.84it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3394494.91it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  22%|██▏       | 78/362 [00:00<00:00, 755.69it/s]Processing batches:  44%|████▍     | 160/362 [00:00<00:00, 772.56it/s]Processing batches:  66%|██████▌   | 238/362 [00:05<00:04, 29.53it/s] Processing batches:  78%|███████▊  | 281/362 [00:10<00:04, 19.52it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:03, 16.48it/s]Processing batches:  90%|█████████ | 326/362 [00:14<00:02, 14.93it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:01, 14.04it/s]Processing batches:  96%|█████████▌| 347/362 [00:16<00:01, 13.39it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00, 12.93it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00, 12.51it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 12.35it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.67it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2347.12it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2933578.97it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  12%|█▏        | 45/362 [00:00<00:00, 397.12it/s]Processing batches:  23%|██▎       | 85/362 [00:00<00:00, 350.33it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 541.42it/s]Processing batches:  65%|██████▌   | 236/362 [00:05<00:04, 28.19it/s] Processing batches:  74%|███████▍  | 269/362 [00:09<00:04, 19.88it/s]Processing batches:  80%|████████  | 291/362 [00:11<00:04, 16.88it/s]Processing batches:  85%|████████▍ | 306/362 [00:12<00:03, 15.26it/s]Processing batches:  88%|████████▊ | 317/362 [00:13<00:03, 14.26it/s]Processing batches:  90%|████████▉ | 325/362 [00:14<00:02, 13.51it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:02, 12.98it/s]Processing batches:  93%|█████████▎| 335/362 [00:15<00:02, 12.62it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:01, 12.23it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:01, 11.91it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01, 11.70it/s]Processing batches:  96%|█████████▌| 346/362 [00:16<00:01, 11.47it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:01, 11.21it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01, 11.00it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:00, 10.66it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00, 10.65it/s]Processing batches:  98%|█████████▊| 356/362 [00:17<00:00, 10.47it/s]Processing batches:  99%|█████████▉| 358/362 [00:17<00:00, 10.28it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00, 10.24it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 10.81it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.77it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target TMBIM6 - DES: 0.0000, MAE_top2k: 0.0668, n_DE: 13
INFO:ZeroShotPerturbation:Predicting for target: PMEL
INFO:ZeroShotPerturbation:Processing 356 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6502.80it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3366466.14it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  24%|██▍       | 87/362 [00:00<00:00, 805.53it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 762.46it/s]Processing batches:  72%|███████▏  | 259/362 [00:07<00:04, 24.35it/s] Processing batches:  83%|████████▎ | 302/362 [00:11<00:03, 18.16it/s]Processing batches:  91%|█████████ | 328/362 [00:14<00:02, 15.94it/s]Processing batches:  95%|█████████▌| 345/362 [00:16<00:01, 14.77it/s]Processing batches:  99%|█████████▊| 357/362 [00:17<00:00, 13.99it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 20.37it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3351.42it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2387163.29it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  16%|█▋        | 59/362 [00:00<00:00, 589.28it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 615.10it/s]Processing batches:  67%|██████▋   | 243/362 [00:06<00:04, 28.99it/s] Processing batches:  77%|███████▋  | 277/362 [00:09<00:04, 20.85it/s]Processing batches:  82%|████████▏ | 298/362 [00:11<00:03, 17.92it/s]Processing batches:  86%|████████▌ | 312/362 [00:12<00:03, 16.33it/s]Processing batches:  89%|████████▉ | 322/362 [00:13<00:02, 15.24it/s]Processing batches:  91%|█████████ | 329/362 [00:14<00:02, 14.48it/s]Processing batches:  92%|█████████▏| 334/362 [00:15<00:02, 13.90it/s]Processing batches:  93%|█████████▎| 338/362 [00:15<00:01, 13.43it/s]Processing batches:  94%|█████████▍| 341/362 [00:15<00:01, 13.07it/s]Processing batches:  95%|█████████▌| 344/362 [00:15<00:01, 12.67it/s]Processing batches:  96%|█████████▌| 346/362 [00:16<00:01, 12.39it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:01, 12.07it/s]Processing batches:  97%|█████████▋| 350/362 [00:16<00:01, 11.70it/s]Processing batches:  97%|█████████▋| 352/362 [00:16<00:00, 11.51it/s]Processing batches:  98%|█████████▊| 354/362 [00:16<00:00, 11.25it/s]Processing batches:  98%|█████████▊| 356/362 [00:17<00:00, 11.00it/s]Processing batches:  99%|█████████▉| 358/362 [00:17<00:00, 10.86it/s]Processing batches:  99%|█████████▉| 360/362 [00:17<00:00, 10.74it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 11.24it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 20.47it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target PMEL - DES: 0.0000, MAE_top2k: 0.0805, n_DE: 34
INFO:ZeroShotPerturbation:Predicting for target: DAXX
INFO:ZeroShotPerturbation:Processing 1332 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4046.60it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3286798.56it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  34%|███▎      | 122/362 [00:00<00:00, 1219.34it/s]Processing batches:  67%|██████▋   | 244/362 [00:07<00:04, 27.17it/s]  Processing batches:  82%|████████▏ | 296/362 [00:13<00:03, 17.14it/s]Processing batches:  90%|████████▉ | 325/362 [00:17<00:02, 14.48it/s]Processing batches:  95%|█████████▍| 343/362 [00:19<00:01, 13.19it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00, 12.37it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.69it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2322.43it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2294285.43it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   7%|▋         | 25/362 [00:00<00:01, 230.90it/s]Processing batches:  21%|██▏       | 77/362 [00:00<00:00, 394.26it/s]Processing batches:  36%|███▌      | 130/362 [00:00<00:00, 437.54it/s]Processing batches:  49%|████▉     | 177/362 [00:00<00:00, 448.08it/s]Processing batches:  61%|██████▏   | 222/362 [00:05<00:05, 26.04it/s] Processing batches:  70%|██████▉   | 252/362 [00:08<00:06, 17.40it/s]Processing batches:  75%|███████▌  | 272/362 [00:10<00:06, 14.62it/s]Processing batches:  79%|███████▉  | 286/362 [00:12<00:05, 13.21it/s]Processing batches:  82%|████████▏ | 296/362 [00:13<00:05, 12.31it/s]Processing batches:  84%|████████▎ | 303/362 [00:14<00:05, 11.70it/s]Processing batches:  85%|████████▌ | 308/362 [00:14<00:04, 11.24it/s]Processing batches:  86%|████████▌ | 312/362 [00:15<00:04, 10.85it/s]Processing batches:  87%|████████▋ | 315/362 [00:15<00:04, 10.54it/s]Processing batches:  88%|████████▊ | 318/362 [00:16<00:04, 10.26it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04, 10.04it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  9.86it/s]Processing batches:  90%|████████▉ | 324/362 [00:16<00:03,  9.68it/s]Processing batches:  90%|█████████ | 326/362 [00:17<00:03,  9.49it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03,  9.32it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  9.18it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  9.03it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  9.04it/s]Processing batches:  92%|█████████▏| 333/362 [00:17<00:03,  8.99it/s]Processing batches:  92%|█████████▏| 334/362 [00:17<00:03,  8.90it/s]Processing batches:  93%|█████████▎| 335/362 [00:18<00:03,  8.89it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:02,  8.84it/s]Processing batches:  93%|█████████▎| 337/362 [00:18<00:02,  8.82it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.74it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.84it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.83it/s]Processing batches:  94%|█████████▍| 341/362 [00:18<00:02,  8.78it/s]Processing batches:  94%|█████████▍| 342/362 [00:18<00:02,  8.81it/s]Processing batches:  95%|█████████▍| 343/362 [00:18<00:02,  8.82it/s]Processing batches:  95%|█████████▌| 344/362 [00:19<00:02,  8.73it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01,  8.67it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  8.70it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.68it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.66it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  8.83it/s]Processing batches:  97%|█████████▋| 350/362 [00:19<00:01,  8.78it/s]Processing batches:  97%|█████████▋| 351/362 [00:19<00:01,  8.83it/s]Processing batches:  97%|█████████▋| 352/362 [00:20<00:01,  8.53it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:01,  8.61it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  8.68it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  8.69it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  8.72it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.64it/s]Processing batches:  99%|█████████▉| 358/362 [00:20<00:00,  8.75it/s]Processing batches:  99%|█████████▉| 359/362 [00:20<00:00,  8.45it/s]Processing batches:  99%|█████████▉| 360/362 [00:20<00:00,  8.66it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00,  8.70it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 17.12it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target DAXX - DES: 0.0013, MAE_top2k: 0.0563, n_DE: 763
INFO:ZeroShotPerturbation:Predicting for target: METTL14
INFO:ZeroShotPerturbation:Processing 468 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6013.34it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3308884.56it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  49%|████▉     | 177/362 [00:00<00:00, 1762.38it/s]Processing batches:  49%|████▉     | 177/362 [00:13<00:00, 1762.38it/s]Processing batches:  88%|████████▊ | 320/362 [00:13<00:02, 19.11it/s]  Processing batches:  89%|████████▉ | 322/362 [00:14<00:02, 18.94it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.94it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3738.24it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2220911.30it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 61/362 [00:00<00:00, 468.17it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 599.65it/s]Processing batches:  67%|██████▋   | 241/362 [00:06<00:04, 28.89it/s] Processing batches:  76%|███████▌  | 274/362 [00:09<00:04, 20.71it/s]Processing batches:  81%|████████  | 294/362 [00:11<00:03, 17.83it/s]Processing batches:  85%|████████▌ | 308/362 [00:12<00:03, 16.18it/s]Processing batches:  88%|████████▊ | 317/362 [00:13<00:02, 15.17it/s]Processing batches:  90%|████████▉ | 324/362 [00:14<00:02, 14.37it/s]Processing batches:  91%|█████████ | 329/362 [00:14<00:02, 13.76it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02, 13.23it/s]Processing batches:  93%|█████████▎| 336/362 [00:15<00:02, 12.84it/s]Processing batches:  94%|█████████▎| 339/362 [00:15<00:01, 12.38it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:01, 12.10it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01, 11.83it/s]Processing batches:  95%|█████████▌| 345/362 [00:16<00:01, 11.53it/s]Processing batches:  96%|█████████▌| 347/362 [00:16<00:01, 11.24it/s]Processing batches:  96%|█████████▋| 349/362 [00:16<00:01, 11.01it/s]Processing batches:  97%|█████████▋| 351/362 [00:16<00:01, 10.83it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00, 10.64it/s]Processing batches:  98%|█████████▊| 355/362 [00:17<00:00, 10.52it/s]Processing batches:  99%|█████████▊| 357/362 [00:17<00:00, 10.40it/s]Processing batches:  99%|█████████▉| 359/362 [00:17<00:00, 10.34it/s]Processing batches: 100%|█████████▉| 361/362 [00:17<00:00, 10.28it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 20.06it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target METTL14 - DES: 0.3775, MAE_top2k: 0.4973, n_DE: 9730
INFO:ZeroShotPerturbation:Predicting for target: MAU2
INFO:ZeroShotPerturbation:Processing 1021 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4510.00it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3174390.57it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  17%|█▋        | 63/362 [00:00<00:00, 627.87it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 837.95it/s]Processing batches:  73%|███████▎  | 264/362 [00:09<00:04, 20.75it/s] Processing batches:  86%|████████▌ | 310/362 [00:14<00:03, 15.49it/s]Processing batches:  93%|█████████▎| 338/362 [00:17<00:01, 13.68it/s]Processing batches:  98%|█████████▊| 356/362 [00:19<00:00, 12.72it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 17.60it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1778.75it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2332605.85it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  13%|█▎        | 48/362 [00:00<00:00, 438.94it/s]Processing batches:  28%|██▊       | 100/362 [00:00<00:00, 481.31it/s]Processing batches:  50%|█████     | 181/362 [00:00<00:00, 583.77it/s]Processing batches:  66%|██████▌   | 239/362 [00:06<00:05, 24.05it/s] Processing batches:  76%|███████▌  | 275/362 [00:10<00:05, 17.13it/s]Processing batches:  82%|████████▏ | 298/362 [00:13<00:04, 14.78it/s]Processing batches:  87%|████████▋ | 314/362 [00:14<00:03, 13.46it/s]Processing batches:  90%|████████▉ | 325/362 [00:16<00:02, 12.68it/s]Processing batches:  92%|█████████▏| 333/362 [00:16<00:02, 12.12it/s]Processing batches:  94%|█████████▎| 339/362 [00:17<00:01, 11.70it/s]Processing batches:  95%|█████████▌| 344/362 [00:18<00:01, 11.33it/s]Processing batches:  96%|█████████▌| 348/362 [00:18<00:01, 11.02it/s]Processing batches:  97%|█████████▋| 351/362 [00:18<00:01, 10.75it/s]Processing batches:  98%|█████████▊| 353/362 [00:19<00:00, 10.57it/s]Processing batches:  98%|█████████▊| 355/362 [00:19<00:00, 10.38it/s]Processing batches:  99%|█████████▊| 357/362 [00:19<00:00, 10.18it/s]Processing batches:  99%|█████████▉| 359/362 [00:19<00:00, 10.01it/s]Processing batches: 100%|█████████▉| 361/362 [00:20<00:00,  9.87it/s]Processing batches: 100%|██████████| 362/362 [00:20<00:00, 18.03it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MAU2 - DES: 0.1926, MAE_top2k: 0.2298, n_DE: 6884
INFO:ZeroShotPerturbation:Predicting for target: NDUFB4
INFO:ZeroShotPerturbation:Processing 1413 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 3919.91it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3279407.38it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  37%|███▋      | 133/362 [00:00<00:00, 1326.84it/s]Processing batches:  73%|███████▎  | 266/362 [00:10<00:04, 21.57it/s]  Processing batches:  74%|███████▍  | 268/362 [00:10<00:04, 21.16it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:02, 13.87it/s]Processing batches:  98%|█████████▊| 355/362 [00:21<00:00, 12.11it/s]Processing batches: 100%|██████████| 362/362 [00:22<00:00, 16.34it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 1816.90it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2310080.61it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  21%|██▏       | 77/362 [00:00<00:00, 686.12it/s]Processing batches:  40%|████      | 146/362 [00:00<00:00, 592.37it/s]Processing batches:  57%|█████▋    | 206/362 [00:03<00:03, 46.53it/s] Processing batches:  66%|██████▋   | 240/362 [00:07<00:05, 22.13it/s]Processing batches:  72%|███████▏  | 261/362 [00:09<00:05, 17.22it/s]Processing batches:  76%|███████▌  | 275/362 [00:11<00:05, 14.96it/s]Processing batches:  79%|███████▊  | 285/362 [00:12<00:05, 13.64it/s]Processing batches:  81%|████████  | 292/362 [00:13<00:05, 12.75it/s]Processing batches:  82%|████████▏ | 297/362 [00:13<00:05, 12.10it/s]Processing batches:  83%|████████▎ | 301/362 [00:14<00:05, 11.56it/s]Processing batches:  84%|████████▍ | 304/362 [00:14<00:05, 11.16it/s]Processing batches:  85%|████████▍ | 307/362 [00:15<00:05, 10.69it/s]Processing batches:  85%|████████▌ | 309/362 [00:15<00:05, 10.42it/s]Processing batches:  86%|████████▌ | 311/362 [00:15<00:05, 10.03it/s]Processing batches:  86%|████████▋ | 313/362 [00:15<00:05,  9.73it/s]Processing batches:  87%|████████▋ | 315/362 [00:16<00:04,  9.49it/s]Processing batches:  88%|████████▊ | 317/362 [00:16<00:04,  9.21it/s]Processing batches:  88%|████████▊ | 318/362 [00:16<00:04,  9.24it/s]Processing batches:  88%|████████▊ | 319/362 [00:16<00:04,  9.12it/s]Processing batches:  88%|████████▊ | 320/362 [00:16<00:04,  9.04it/s]Processing batches:  89%|████████▊ | 321/362 [00:16<00:04,  8.92it/s]Processing batches:  89%|████████▉ | 322/362 [00:16<00:04,  8.83it/s]Processing batches:  89%|████████▉ | 323/362 [00:16<00:04,  8.78it/s]Processing batches:  90%|████████▉ | 324/362 [00:17<00:04,  8.76it/s]Processing batches:  90%|████████▉ | 325/362 [00:17<00:04,  8.72it/s]Processing batches:  90%|█████████ | 326/362 [00:17<00:04,  8.64it/s]Processing batches:  90%|█████████ | 327/362 [00:17<00:04,  8.59it/s]Processing batches:  91%|█████████ | 328/362 [00:17<00:03,  8.61it/s]Processing batches:  91%|█████████ | 329/362 [00:17<00:03,  8.60it/s]Processing batches:  91%|█████████ | 330/362 [00:17<00:03,  8.61it/s]Processing batches:  91%|█████████▏| 331/362 [00:17<00:03,  8.54it/s]Processing batches:  92%|█████████▏| 332/362 [00:17<00:03,  8.56it/s]Processing batches:  92%|█████████▏| 333/362 [00:18<00:03,  8.57it/s]Processing batches:  92%|█████████▏| 334/362 [00:18<00:03,  8.53it/s]Processing batches:  93%|█████████▎| 335/362 [00:18<00:03,  8.62it/s]Processing batches:  93%|█████████▎| 336/362 [00:18<00:03,  8.40it/s]Processing batches:  93%|█████████▎| 337/362 [00:18<00:02,  8.37it/s]Processing batches:  93%|█████████▎| 338/362 [00:18<00:02,  8.51it/s]Processing batches:  94%|█████████▎| 339/362 [00:18<00:02,  8.40it/s]Processing batches:  94%|█████████▍| 340/362 [00:18<00:02,  8.66it/s]Processing batches:  94%|█████████▍| 341/362 [00:19<00:02,  8.60it/s]Processing batches:  94%|█████████▍| 342/362 [00:19<00:02,  8.58it/s]Processing batches:  95%|█████████▍| 343/362 [00:19<00:02,  8.36it/s]Processing batches:  95%|█████████▌| 344/362 [00:19<00:02,  8.38it/s]Processing batches:  95%|█████████▌| 345/362 [00:19<00:01,  8.51it/s]Processing batches:  96%|█████████▌| 346/362 [00:19<00:01,  8.51it/s]Processing batches:  96%|█████████▌| 347/362 [00:19<00:01,  8.54it/s]Processing batches:  96%|█████████▌| 348/362 [00:19<00:01,  8.61it/s]Processing batches:  96%|█████████▋| 349/362 [00:19<00:01,  8.61it/s]Processing batches:  97%|█████████▋| 350/362 [00:20<00:01,  8.41it/s]Processing batches:  97%|█████████▋| 351/362 [00:20<00:01,  8.44it/s]Processing batches:  97%|█████████▋| 352/362 [00:20<00:01,  8.53it/s]Processing batches:  98%|█████████▊| 353/362 [00:20<00:01,  8.56it/s]Processing batches:  98%|█████████▊| 354/362 [00:20<00:00,  8.53it/s]Processing batches:  98%|█████████▊| 355/362 [00:20<00:00,  8.62it/s]Processing batches:  98%|█████████▊| 356/362 [00:20<00:00,  8.58it/s]Processing batches:  99%|█████████▊| 357/362 [00:20<00:00,  8.39it/s]Processing batches:  99%|█████████▉| 358/362 [00:21<00:00,  8.50it/s]Processing batches:  99%|█████████▉| 359/362 [00:21<00:00,  8.50it/s]Processing batches:  99%|█████████▉| 360/362 [00:21<00:00,  8.60it/s]Processing batches: 100%|█████████▉| 361/362 [00:21<00:00,  8.63it/s]Processing batches: 100%|██████████| 362/362 [00:21<00:00, 16.86it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target NDUFB4 - DES: 0.0000, MAE_top2k: 0.0703, n_DE: 1389
INFO:ZeroShotPerturbation:Predicting for target: KDM1A
INFO:ZeroShotPerturbation:Processing 352 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6447.82it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3276007.27it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  11%|█         | 40/362 [00:00<00:00, 371.04it/s]Processing batches:  24%|██▍       | 88/362 [00:00<00:00, 415.94it/s]Processing batches:  36%|███▌      | 130/362 [00:00<00:00, 399.70it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 355.06it/s]Processing batches:  60%|██████    | 219/362 [00:04<00:04, 31.38it/s] Processing batches:  67%|██████▋   | 243/362 [00:06<00:05, 21.60it/s]Processing batches:  72%|███████▏  | 259/362 [00:07<00:05, 18.13it/s]Processing batches:  75%|███████▍  | 271/362 [00:09<00:05, 16.19it/s]Processing batches:  77%|███████▋  | 279/362 [00:09<00:05, 15.10it/s]Processing batches:  79%|███████▊  | 285/362 [00:10<00:05, 14.25it/s]Processing batches:  80%|████████  | 290/362 [00:10<00:05, 13.57it/s]Processing batches:  81%|████████  | 294/362 [00:11<00:05, 13.05it/s]Processing batches:  82%|████████▏ | 297/362 [00:11<00:05, 12.64it/s]Processing batches:  83%|████████▎ | 300/362 [00:11<00:05, 12.23it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:05, 11.95it/s]Processing batches:  84%|████████▍ | 304/362 [00:12<00:04, 11.64it/s]Processing batches:  85%|████████▍ | 306/362 [00:12<00:04, 11.37it/s]Processing batches:  85%|████████▌ | 308/362 [00:12<00:04, 11.01it/s]Processing batches:  86%|████████▌ | 310/362 [00:12<00:04, 10.85it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:04, 10.72it/s]Processing batches:  87%|████████▋ | 314/362 [00:13<00:04, 10.61it/s]Processing batches:  87%|████████▋ | 316/362 [00:13<00:04, 10.37it/s]Processing batches:  88%|████████▊ | 318/362 [00:13<00:04, 10.37it/s]Processing batches:  88%|████████▊ | 320/362 [00:13<00:04, 10.36it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:03, 10.40it/s]Processing batches:  90%|████████▉ | 324/362 [00:14<00:03, 10.25it/s]Processing batches:  90%|█████████ | 326/362 [00:14<00:03, 10.21it/s]Processing batches:  91%|█████████ | 328/362 [00:14<00:03, 10.30it/s]Processing batches:  91%|█████████ | 330/362 [00:14<00:03, 10.15it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:02, 10.18it/s]Processing batches:  92%|█████████▏| 334/362 [00:15<00:02, 10.21it/s]Processing batches:  93%|█████████▎| 336/362 [00:15<00:02, 10.24it/s]Processing batches:  93%|█████████▎| 338/362 [00:15<00:02, 10.27it/s]Processing batches:  94%|█████████▍| 340/362 [00:15<00:02, 10.31it/s]Processing batches:  94%|█████████▍| 342/362 [00:16<00:01, 10.33it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01, 10.35it/s]Processing batches:  96%|█████████▌| 346/362 [00:16<00:01, 10.36it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:01, 10.31it/s]Processing batches:  97%|█████████▋| 350/362 [00:16<00:01, 10.36it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:00, 10.37it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00, 10.29it/s]Processing batches:  98%|█████████▊| 356/362 [00:17<00:00, 10.33it/s]Processing batches:  99%|█████████▉| 358/362 [00:17<00:00, 10.34it/s]Processing batches:  99%|█████████▉| 360/362 [00:17<00:00, 10.33it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 11.03it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 20.17it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6096.37it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3372904.70it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  10%|█         | 38/362 [00:00<00:00, 361.80it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 710.71it/s]Processing batches:  69%|██████▊   | 248/362 [00:06<00:04, 28.46it/s] Processing batches:  79%|███████▊  | 285/362 [00:10<00:03, 20.52it/s]Processing batches:  85%|████████▌ | 308/362 [00:12<00:03, 17.66it/s]Processing batches:  89%|████████▉ | 323/362 [00:13<00:02, 16.13it/s]Processing batches:  92%|█████████▏| 334/362 [00:14<00:01, 15.08it/s]Processing batches:  94%|█████████▍| 342/362 [00:15<00:01, 14.36it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:01, 13.80it/s]Processing batches:  97%|█████████▋| 352/362 [00:16<00:00, 13.40it/s]Processing batches:  98%|█████████▊| 355/362 [00:16<00:00, 13.05it/s]Processing batches:  99%|█████████▉| 358/362 [00:17<00:00, 12.70it/s]Processing batches:  99%|█████████▉| 360/362 [00:17<00:00, 12.42it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 12.50it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 20.59it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target KDM1A - DES: 0.3671, MAE_top2k: 0.4818, n_DE: 10112
INFO:ZeroShotPerturbation:Predicting for target: TXNDC9
INFO:ZeroShotPerturbation:Processing 514 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5687.19it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3391913.78it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  19%|█▉        | 69/362 [00:00<00:00, 679.58it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 631.14it/s]Processing batches:  68%|██████▊   | 247/362 [00:06<00:04, 26.51it/s] Processing batches:  78%|███████▊  | 283/362 [00:10<00:04, 19.31it/s]Processing batches:  84%|████████▍ | 305/362 [00:12<00:03, 16.71it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:02, 15.21it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:02, 14.32it/s]Processing batches:  93%|█████████▎| 337/362 [00:15<00:01, 13.69it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01, 13.12it/s]Processing batches:  96%|█████████▌| 347/362 [00:16<00:01, 12.76it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:00, 12.43it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00, 12.08it/s]Processing batches:  98%|█████████▊| 355/362 [00:17<00:00, 11.80it/s]Processing batches:  99%|█████████▊| 357/362 [00:17<00:00, 11.56it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00, 11.23it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00, 11.01it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.69it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2956.86it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2232549.72it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 50/362 [00:00<00:00, 490.49it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 743.61it/s]Processing batches:  70%|██████▉   | 253/362 [00:07<00:04, 25.97it/s] Processing batches:  81%|████████  | 292/362 [00:11<00:03, 19.01it/s]Processing batches:  87%|████████▋ | 316/362 [00:13<00:02, 16.48it/s]Processing batches:  92%|█████████▏| 332/362 [00:15<00:01, 15.12it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01, 14.26it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:00, 13.61it/s]Processing batches:  99%|█████████▊| 357/362 [00:17<00:00, 13.12it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 12.83it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.87it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target TXNDC9 - DES: 0.0000, MAE_top2k: 0.0707, n_DE: 258
INFO:ZeroShotPerturbation:Predicting for target: CALM3
INFO:ZeroShotPerturbation:Processing 681 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5292.50it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3317279.80it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  45%|████▌     | 163/362 [00:00<00:00, 1627.28it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:01, 18.11it/s]  Processing batches:  91%|█████████ | 328/362 [00:15<00:01, 17.94it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.99it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2710.37it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 1942145.58it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  26%|██▌       | 94/362 [00:00<00:00, 900.97it/s]Processing batches:  51%|█████     | 185/362 [00:00<00:00, 268.44it/s]Processing batches:  64%|██████▍   | 233/362 [00:05<00:04, 29.75it/s] Processing batches:  72%|███████▏  | 260/362 [00:08<00:04, 21.23it/s]Processing batches:  77%|███████▋  | 277/362 [00:10<00:04, 18.07it/s]Processing batches:  80%|███████▉  | 288/362 [00:11<00:04, 16.36it/s]Processing batches:  82%|████████▏ | 296/362 [00:11<00:04, 15.22it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:04, 14.36it/s]Processing batches:  85%|████████▍ | 306/362 [00:12<00:04, 13.73it/s]Processing batches:  86%|████████▌ | 310/362 [00:13<00:03, 13.12it/s]Processing batches:  86%|████████▋ | 313/362 [00:13<00:03, 12.57it/s]Processing batches:  87%|████████▋ | 315/362 [00:13<00:03, 12.25it/s]Processing batches:  88%|████████▊ | 317/362 [00:14<00:03, 11.80it/s]Processing batches:  88%|████████▊ | 319/362 [00:14<00:03, 11.48it/s]Processing batches:  89%|████████▊ | 321/362 [00:14<00:03, 11.15it/s]Processing batches:  89%|████████▉ | 323/362 [00:14<00:03, 10.76it/s]Processing batches:  90%|████████▉ | 325/362 [00:14<00:03, 10.56it/s]Processing batches:  90%|█████████ | 327/362 [00:15<00:03, 10.30it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03, 10.21it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:03, 10.12it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02, 10.04it/s]Processing batches:  93%|█████████▎| 335/362 [00:15<00:02,  9.98it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.92it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.91it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.90it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02,  9.92it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.71it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01,  9.84it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01,  9.87it/s]Processing batches:  95%|█████████▌| 345/362 [00:16<00:01,  9.88it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.80it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.77it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.54it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.92it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.85it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:01,  9.83it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00,  9.83it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00,  9.86it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.82it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.74it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.61it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.67it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.74it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.78it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.83it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.38it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target CALM3 - DES: 0.0000, MAE_top2k: 0.0796, n_DE: 5
INFO:ZeroShotPerturbation:Predicting for target: C1QBP
INFO:ZeroShotPerturbation:Processing 711 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5242.88it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3200920.87it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  36%|███▌      | 129/362 [00:00<00:00, 1264.04it/s]Processing batches:  71%|███████   | 256/362 [00:08<00:03, 27.19it/s]  Processing batches:  85%|████████▌ | 309/362 [00:13<00:02, 18.33it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:01, 15.75it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00, 14.45it/s]Processing batches: 100%|██████████| 362/362 [00:19<00:00, 18.85it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2504.81it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2502161.76it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  16%|█▋        | 59/362 [00:00<00:00, 580.97it/s]Processing batches:  33%|███▎      | 121/362 [00:00<00:00, 598.20it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 433.57it/s]Processing batches:  64%|██████▎   | 230/362 [00:05<00:04, 27.45it/s] Processing batches:  72%|███████▏  | 260/362 [00:08<00:05, 19.24it/s]Processing batches:  77%|███████▋  | 279/362 [00:10<00:05, 16.41it/s]Processing batches:  81%|████████  | 292/362 [00:11<00:04, 14.90it/s]Processing batches:  83%|████████▎ | 301/362 [00:12<00:04, 13.96it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:04, 13.23it/s]Processing batches:  86%|████████▋ | 313/362 [00:13<00:03, 12.69it/s]Processing batches:  88%|████████▊ | 317/362 [00:14<00:03, 12.23it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:03, 11.91it/s]Processing batches:  89%|████████▉ | 323/362 [00:14<00:03, 11.52it/s]Processing batches:  90%|████████▉ | 325/362 [00:15<00:03, 11.29it/s]Processing batches:  90%|█████████ | 327/362 [00:15<00:03, 11.06it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03, 10.79it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:02, 10.57it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02, 10.37it/s]Processing batches:  93%|█████████▎| 335/362 [00:16<00:02, 10.23it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02, 10.14it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.94it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.93it/s]Processing batches:  95%|█████████▍| 343/362 [00:17<00:01,  9.94it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.90it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.82it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.82it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.80it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.81it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.83it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.83it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:01,  9.77it/s]Processing batches:  98%|█████████▊| 353/362 [00:18<00:00,  9.68it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.79it/s]Processing batches:  98%|█████████▊| 356/362 [00:18<00:00,  9.70it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.63it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.67it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.71it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.74it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.78it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.14it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target C1QBP - DES: 0.0129, MAE_top2k: 0.1106, n_DE: 3888
INFO:ZeroShotPerturbation:Predicting for target: MBTPS1
INFO:ZeroShotPerturbation:Processing 626 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/site-packages/anndata/_core/anndata.py:1796: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5596.14it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3256872.37it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  38%|███▊      | 137/362 [00:00<00:00, 1368.98it/s]Processing batches:  76%|███████▌  | 274/362 [00:09<00:03, 23.97it/s]  Processing batches:  92%|█████████▏| 332/362 [00:15<00:01, 17.27it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.27it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 2776.77it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 1815098.89it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  12%|█▏        | 44/362 [00:00<00:00, 414.53it/s]Processing batches:  35%|███▍      | 125/362 [00:00<00:00, 639.54it/s]Processing batches:  52%|█████▏    | 190/362 [00:01<00:01, 119.65it/s]Processing batches:  63%|██████▎   | 228/362 [00:05<00:04, 29.29it/s] Processing batches:  70%|██████▉   | 252/362 [00:07<00:05, 20.96it/s]Processing batches:  74%|███████▍  | 268/362 [00:09<00:05, 17.76it/s]Processing batches:  77%|███████▋  | 279/362 [00:10<00:05, 16.03it/s]Processing batches:  79%|███████▉  | 287/362 [00:11<00:05, 14.92it/s]Processing batches:  81%|████████  | 293/362 [00:11<00:04, 14.09it/s]Processing batches:  82%|████████▏ | 297/362 [00:12<00:04, 13.52it/s]Processing batches:  83%|████████▎ | 301/362 [00:12<00:04, 12.92it/s]Processing batches:  84%|████████▍ | 304/362 [00:12<00:04, 12.45it/s]Processing batches:  85%|████████▍ | 306/362 [00:13<00:04, 12.14it/s]Processing batches:  85%|████████▌ | 308/362 [00:13<00:04, 11.79it/s]Processing batches:  86%|████████▌ | 310/362 [00:13<00:04, 11.38it/s]Processing batches:  86%|████████▌ | 312/362 [00:13<00:04, 11.08it/s]Processing batches:  87%|████████▋ | 314/362 [00:13<00:04, 10.81it/s]Processing batches:  87%|████████▋ | 316/362 [00:14<00:04, 10.45it/s]Processing batches:  88%|████████▊ | 318/362 [00:14<00:04, 10.34it/s]Processing batches:  88%|████████▊ | 320/362 [00:14<00:04, 10.23it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:04,  9.99it/s]Processing batches:  90%|████████▉ | 324/362 [00:14<00:03, 10.00it/s]Processing batches:  90%|█████████ | 326/362 [00:15<00:03,  9.97it/s]Processing batches:  91%|█████████ | 328/362 [00:15<00:03,  9.81it/s]Processing batches:  91%|█████████ | 329/362 [00:15<00:03,  9.82it/s]Processing batches:  91%|█████████ | 330/362 [00:15<00:03,  9.85it/s]Processing batches:  91%|█████████▏| 331/362 [00:15<00:03,  9.86it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02,  9.88it/s]Processing batches:  92%|█████████▏| 334/362 [00:15<00:02,  9.79it/s]Processing batches:  93%|█████████▎| 336/362 [00:16<00:02,  9.91it/s]Processing batches:  93%|█████████▎| 337/362 [00:16<00:02,  9.91it/s]Processing batches:  93%|█████████▎| 338/362 [00:16<00:02,  9.91it/s]Processing batches:  94%|█████████▎| 339/362 [00:16<00:02,  9.93it/s]Processing batches:  94%|█████████▍| 340/362 [00:16<00:02,  9.93it/s]Processing batches:  94%|█████████▍| 341/362 [00:16<00:02,  9.94it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01,  9.91it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01,  9.90it/s]Processing batches:  95%|█████████▌| 345/362 [00:17<00:01,  9.88it/s]Processing batches:  96%|█████████▌| 346/362 [00:17<00:01,  9.89it/s]Processing batches:  96%|█████████▌| 347/362 [00:17<00:01,  9.86it/s]Processing batches:  96%|█████████▌| 348/362 [00:17<00:01,  9.87it/s]Processing batches:  96%|█████████▋| 349/362 [00:17<00:01,  9.90it/s]Processing batches:  97%|█████████▋| 350/362 [00:17<00:01,  9.91it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:01,  9.82it/s]Processing batches:  97%|█████████▋| 352/362 [00:17<00:01,  9.85it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00,  9.90it/s]Processing batches:  98%|█████████▊| 355/362 [00:18<00:00,  9.87it/s]Processing batches:  99%|█████████▊| 357/362 [00:18<00:00,  9.93it/s]Processing batches:  99%|█████████▉| 358/362 [00:18<00:00,  9.93it/s]Processing batches:  99%|█████████▉| 359/362 [00:18<00:00,  9.93it/s]Processing batches:  99%|█████████▉| 360/362 [00:18<00:00,  9.94it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00,  9.72it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 19.31it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target MBTPS1 - DES: 0.0179, MAE_top2k: 0.1764, n_DE: 3694
INFO:ZeroShotPerturbation:Predicting for target: ZNF562
INFO:ZeroShotPerturbation:Processing 418 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6136.51it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3287225.99it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  47%|████▋     | 169/362 [00:00<00:00, 1609.61it/s]Processing batches:  91%|█████████ | 330/362 [00:14<00:01, 18.77it/s]  Processing batches:  92%|█████████▏| 332/362 [00:15<00:01, 18.61it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 20.08it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4785.29it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2656519.87it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:   9%|▊         | 31/362 [00:00<00:01, 238.47it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 685.36it/s]Processing batches:  68%|██████▊   | 247/362 [00:06<00:04, 28.49it/s] Processing batches:  78%|███████▊  | 283/362 [00:10<00:03, 20.56it/s]Processing batches:  85%|████████▍ | 306/362 [00:12<00:03, 17.65it/s]Processing batches:  89%|████████▊ | 321/362 [00:13<00:02, 16.08it/s]Processing batches:  91%|█████████▏| 331/362 [00:14<00:02, 15.06it/s]Processing batches:  93%|█████████▎| 338/362 [00:15<00:01, 14.36it/s]Processing batches:  95%|█████████▌| 344/362 [00:16<00:01, 13.76it/s]Processing batches:  96%|█████████▌| 348/362 [00:16<00:01, 13.33it/s]Processing batches:  97%|█████████▋| 351/362 [00:16<00:00, 12.98it/s]Processing batches:  98%|█████████▊| 354/362 [00:17<00:00, 12.58it/s]Processing batches:  98%|█████████▊| 356/362 [00:17<00:00, 12.31it/s]Processing batches:  99%|█████████▉| 358/362 [00:17<00:00, 12.01it/s]Processing batches:  99%|█████████▉| 360/362 [00:17<00:00, 11.71it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 11.90it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 20.29it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target ZNF562 - DES: 0.0000, MAE_top2k: 0.0499, n_DE: 23
INFO:ZeroShotPerturbation:Predicting for target: PHF10
INFO:ZeroShotPerturbation:Processing 450 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 6056.76it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3339631.67it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  42%|████▏     | 153/362 [00:00<00:00, 1517.73it/s]Processing batches:  84%|████████▍ | 305/362 [00:12<00:02, 20.91it/s]  Processing batches:  85%|████████▍ | 307/362 [00:12<00:02, 20.66it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 20.03it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 4321.80it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2442051.21it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  14%|█▍        | 52/362 [00:00<00:00, 440.90it/s]Processing batches:  40%|████      | 146/362 [00:00<00:00, 705.54it/s]Processing batches:  60%|██████    | 219/362 [00:03<00:03, 42.08it/s] Processing batches:  72%|███████▏  | 260/362 [00:08<00:04, 23.01it/s]Processing batches:  79%|███████▊  | 285/362 [00:10<00:04, 18.62it/s]Processing batches:  83%|████████▎ | 302/362 [00:12<00:03, 16.53it/s]Processing batches:  87%|████████▋ | 314/362 [00:13<00:03, 15.25it/s]Processing batches:  89%|████████▉ | 322/362 [00:14<00:02, 14.41it/s]Processing batches:  91%|█████████ | 328/362 [00:14<00:02, 13.75it/s]Processing batches:  92%|█████████▏| 333/362 [00:15<00:02, 13.16it/s]Processing batches:  93%|█████████▎| 337/362 [00:15<00:01, 12.73it/s]Processing batches:  94%|█████████▍| 340/362 [00:15<00:01, 12.34it/s]Processing batches:  95%|█████████▍| 343/362 [00:16<00:01, 12.01it/s]Processing batches:  95%|█████████▌| 345/362 [00:16<00:01, 11.76it/s]Processing batches:  96%|█████████▌| 347/362 [00:16<00:01, 11.49it/s]Processing batches:  96%|█████████▋| 349/362 [00:16<00:01, 11.30it/s]Processing batches:  97%|█████████▋| 351/362 [00:17<00:00, 11.07it/s]Processing batches:  98%|█████████▊| 353/362 [00:17<00:00, 10.86it/s]Processing batches:  98%|█████████▊| 355/362 [00:17<00:00, 10.69it/s]Processing batches:  99%|█████████▊| 357/362 [00:17<00:00, 10.46it/s]Processing batches:  99%|█████████▉| 359/362 [00:17<00:00, 10.47it/s]Processing batches: 100%|█████████▉| 361/362 [00:18<00:00, 10.40it/s]Processing batches: 100%|██████████| 362/362 [00:18<00:00, 20.03it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target PHF10 - DES: 0.0010, MAE_top2k: 0.1028, n_DE: 982
INFO:ZeroShotPerturbation:Predicting for target: FDPS
INFO:ZeroShotPerturbation:Processing 154 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 7294.44it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3364076.67it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  24%|██▍       | 88/362 [00:00<00:00, 847.97it/s]Processing batches:  48%|████▊     | 173/362 [00:00<00:00, 607.68it/s]Processing batches:  66%|██████▌   | 238/362 [00:05<00:04, 30.77it/s] Processing batches:  76%|███████▌  | 274/362 [00:08<00:04, 21.46it/s]Processing batches:  82%|████████▏ | 297/362 [00:11<00:03, 18.25it/s]Processing batches:  86%|████████▌ | 312/362 [00:12<00:03, 16.64it/s]Processing batches:  89%|████████▉ | 322/362 [00:13<00:02, 15.65it/s]Processing batches:  91%|█████████ | 330/362 [00:14<00:02, 14.85it/s]Processing batches:  93%|█████████▎| 336/362 [00:14<00:01, 14.23it/s]Processing batches:  94%|█████████▍| 340/362 [00:15<00:01, 13.76it/s]Processing batches:  95%|█████████▍| 343/362 [00:15<00:01, 13.36it/s]Processing batches:  96%|█████████▌| 346/362 [00:15<00:01, 13.00it/s]Processing batches:  96%|█████████▌| 348/362 [00:15<00:01, 12.75it/s]Processing batches:  97%|█████████▋| 350/362 [00:15<00:00, 12.38it/s]Processing batches:  97%|█████████▋| 352/362 [00:16<00:00, 12.12it/s]Processing batches:  98%|█████████▊| 354/362 [00:16<00:00, 11.87it/s]Processing batches:  98%|█████████▊| 356/362 [00:16<00:00, 11.65it/s]Processing batches:  99%|█████████▉| 358/362 [00:16<00:00, 11.46it/s]Processing batches:  99%|█████████▉| 360/362 [00:16<00:00, 11.31it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 11.82it/s]Processing batches: 100%|██████████| 362/362 [00:17<00:00, 21.27it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5706.54it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2710451.65it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  37%|███▋      | 133/362 [00:00<00:00, 1311.28it/s]Processing batches:  73%|███████▎  | 265/362 [00:07<00:03, 28.90it/s]  Processing batches:  88%|████████▊ | 320/362 [00:12<00:02, 20.25it/s]Processing batches:  97%|█████████▋| 351/362 [00:15<00:00, 17.57it/s]Processing batches: 100%|██████████| 362/362 [00:16<00:00, 21.65it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target FDPS - DES: 0.0021, MAE_top2k: 0.2557, n_DE: 1903
INFO:ZeroShotPerturbation:Predicting for target: OXA1L
INFO:ZeroShotPerturbation:Processing 63 cells in batches of 16
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
/public/home/wangar2023/.conda/envs/vcc/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 8152.19it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 3324697.11it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  50%|█████     | 182/362 [00:00<00:00, 1040.39it/s]Processing batches:  79%|███████▉  | 287/362 [00:09<00:03, 24.69it/s]  Processing batches:  91%|█████████▏| 331/362 [00:13<00:01, 19.73it/s]Processing batches:  98%|█████████▊| 356/362 [00:15<00:00, 17.73it/s]Processing batches: 100%|██████████| 362/362 [00:16<00:00, 22.50it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/2 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 2/2 [00:00<00:00, 5124.38it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2607379.19it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=36160
INFO:pdex._single_cell:Creating generator of all batches: N=362
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches
Processing batches:   0%|          | 0/362 [00:00<?, ?it/s]Processing batches:  43%|████▎     | 154/362 [00:00<00:00, 1527.89it/s]Processing batches:  85%|████████▍ | 307/362 [00:11<00:02, 23.03it/s]  Processing batches:  85%|████████▌ | 309/362 [00:11<00:02, 22.77it/s]Processing batches: 100%|██████████| 362/362 [00:16<00:00, 22.26it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:ZeroShotPerturbation:Target OXA1L - DES: 0.0000, MAE_top2k: 0.2681, n_DE: 430
INFO:ZeroShotPerturbation:Results saved to results/baseline/perturbation_metrics.csv
INFO:ZeroShotPerturbation:==================================================
INFO:ZeroShotPerturbation:Final Test Metrics (per eval_metrics.md Section 4.2.2):
INFO:ZeroShotPerturbation:--------------------------------------------------
INFO:ZeroShotPerturbation:Three DE Metrics (raw, averaged):
INFO:ZeroShotPerturbation:  pds_nrank:             0.5167
INFO:ZeroShotPerturbation:  mae:                   0.1258
INFO:ZeroShotPerturbation:  des:                   0.0485
INFO:ZeroShotPerturbation:--------------------------------------------------
INFO:ZeroShotPerturbation:Overall Score (0-100, from meaned metrics):
INFO:ZeroShotPerturbation:  overall_score:         0.15
INFO:ZeroShotPerturbation:==================================================
