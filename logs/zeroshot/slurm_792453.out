Activating conda environment 'vcc'...
Starting Zero-Shot Perturbation Experiment...
Date: Mon 01 Dec 2025 11:59:50 PM CST
Config: src/configs/config.yaml
2025-12-01 23:59:59,930 - ZeroShotPerturbation - INFO - Starting Perturbation Pipeline with scgpt model
2025-12-01 23:59:59,930 - ZeroShotPerturbation - INFO - Model directory: model/scGPT
2025-12-01 23:59:59,930 - ZeroShotPerturbation - INFO - Results will be saved to: results/scgpt_zeroshot
2025-12-01 23:59:59,930 - ZeroShotPerturbation - INFO - Initializing scGPT Model Wrapper...
2025-12-02 00:00:00,994 - ZeroShotPerturbation - INFO - Model vocab size: 60697, Saved checkpoint vocab size: 60697
2025-12-02 00:00:01,043 - ZeroShotPerturbation - INFO - Loaded model from model/scGPT/best_model.pt
2025-12-02 00:00:01,106 - ZeroShotPerturbation - INFO - Initializing Data Loader...
2025-12-02 00:00:01,106 - ZeroShotPerturbation - INFO - Loading training data from data/processed/train.h5ad
2025-12-02 00:00:20,019 - ZeroShotPerturbation - INFO - Loading test data from data/processed/test.h5ad
2025-12-02 00:00:23,397 - ZeroShotPerturbation - INFO - Found 38176 control cells.
2025-12-02 00:00:27,378 - ZeroShotPerturbation - INFO - Processing 30 target genes...
2025-12-02 00:00:27,379 - ZeroShotPerturbation - INFO - Predicting for target: AKT2
2025-12-02 00:00:27,382 - ZeroShotPerturbation - INFO - Processing 938 cells in batches of 16
2025-12-02 00:00:48,506 - ZeroShotPerturbation - INFO - Target AKT2 - DES: 0.0265, MAE_top2k: 13.4227, n_DE: 378
2025-12-02 00:00:48,507 - ZeroShotPerturbation - INFO - Predicting for target: MAP3K7
2025-12-02 00:00:48,509 - ZeroShotPerturbation - INFO - Processing 2019 cells in batches of 16
2025-12-02 00:01:34,585 - ZeroShotPerturbation - INFO - Target MAP3K7 - DES: 0.0000, MAE_top2k: 13.3074, n_DE: 67
2025-12-02 00:01:34,585 - ZeroShotPerturbation - INFO - Predicting for target: ZNF426
2025-12-02 00:01:34,588 - ZeroShotPerturbation - INFO - Processing 1132 cells in batches of 16
2025-12-02 00:02:00,481 - ZeroShotPerturbation - INFO - Target ZNF426 - DES: 0.0000, MAE_top2k: 12.8214, n_DE: 14
2025-12-02 00:02:00,481 - ZeroShotPerturbation - INFO - Predicting for target: DNMT1
2025-12-02 00:02:00,483 - ZeroShotPerturbation - INFO - Processing 893 cells in batches of 16
2025-12-02 00:02:21,018 - ZeroShotPerturbation - INFO - Target DNMT1 - DES: 0.5578, MAE_top2k: 13.1464, n_DE: 8189
2025-12-02 00:02:21,018 - ZeroShotPerturbation - INFO - Predicting for target: SRC
2025-12-02 00:02:21,021 - ZeroShotPerturbation - INFO - Processing 2403 cells in batches of 16
2025-12-02 00:03:16,470 - ZeroShotPerturbation - INFO - Target SRC - DES: 0.0235, MAE_top2k: 13.1298, n_DE: 255
2025-12-02 00:03:16,471 - ZeroShotPerturbation - INFO - Predicting for target: MED13
2025-12-02 00:03:16,475 - ZeroShotPerturbation - INFO - Processing 2787 cells in batches of 16
2025-12-02 00:04:20,732 - ZeroShotPerturbation - INFO - Target MED13 - DES: 0.3937, MAE_top2k: 13.2061, n_DE: 4354
2025-12-02 00:04:20,732 - ZeroShotPerturbation - INFO - Predicting for target: KDR
2025-12-02 00:04:20,736 - ZeroShotPerturbation - INFO - Processing 2056 cells in batches of 16
2025-12-02 00:05:07,869 - ZeroShotPerturbation - INFO - Target KDR - DES: 0.0000, MAE_top2k: 14.1099, n_DE: 32
2025-12-02 00:05:07,869 - ZeroShotPerturbation - INFO - Predicting for target: EIF4B
2025-12-02 00:05:07,872 - ZeroShotPerturbation - INFO - Processing 1585 cells in batches of 16
2025-12-02 00:05:44,358 - ZeroShotPerturbation - INFO - Target EIF4B - DES: 0.4543, MAE_top2k: 13.8249, n_DE: 4475
2025-12-02 00:05:44,359 - ZeroShotPerturbation - INFO - Predicting for target: SIX4
2025-12-02 00:05:44,362 - ZeroShotPerturbation - INFO - Processing 642 cells in batches of 16
2025-12-02 00:05:59,208 - ZeroShotPerturbation - INFO - Target SIX4 - DES: 0.0000, MAE_top2k: 12.7929, n_DE: 67
2025-12-02 00:05:59,208 - ZeroShotPerturbation - INFO - Predicting for target: TFAM
2025-12-02 00:05:59,211 - ZeroShotPerturbation - INFO - Processing 1105 cells in batches of 16
2025-12-02 00:06:24,794 - ZeroShotPerturbation - INFO - Target TFAM - DES: 0.4944, MAE_top2k: 13.7111, n_DE: 4211
2025-12-02 00:06:24,795 - ZeroShotPerturbation - INFO - Predicting for target: MAST2
2025-12-02 00:06:24,798 - ZeroShotPerturbation - INFO - Processing 1029 cells in batches of 16
2025-12-02 00:06:48,535 - ZeroShotPerturbation - INFO - Target MAST2 - DES: 0.0000, MAE_top2k: 13.5777, n_DE: 12
2025-12-02 00:06:48,537 - ZeroShotPerturbation - INFO - Predicting for target: SMAGP
2025-12-02 00:06:48,539 - ZeroShotPerturbation - INFO - Processing 788 cells in batches of 16
2025-12-02 00:07:06,810 - ZeroShotPerturbation - INFO - Target SMAGP - DES: 0.0765, MAE_top2k: 13.4582, n_DE: 850
2025-12-02 00:07:06,811 - ZeroShotPerturbation - INFO - Predicting for target: XRCC4
2025-12-02 00:07:06,813 - ZeroShotPerturbation - INFO - Processing 591 cells in batches of 16
2025-12-02 00:07:20,523 - ZeroShotPerturbation - INFO - Target XRCC4 - DES: 0.3068, MAE_top2k: 14.4396, n_DE: 2324
2025-12-02 00:07:20,524 - ZeroShotPerturbation - INFO - Predicting for target: HMGN1
2025-12-02 00:07:20,527 - ZeroShotPerturbation - INFO - Processing 2004 cells in batches of 16
2025-12-02 00:08:06,618 - ZeroShotPerturbation - INFO - Target HMGN1 - DES: 0.0000, MAE_top2k: 13.0708, n_DE: 16
2025-12-02 00:08:06,618 - ZeroShotPerturbation - INFO - Predicting for target: GSK3B
2025-12-02 00:08:06,620 - ZeroShotPerturbation - INFO - Processing 1059 cells in batches of 16
2025-12-02 00:08:31,141 - ZeroShotPerturbation - INFO - Target GSK3B - DES: 0.2032, MAE_top2k: 13.2338, n_DE: 2313
2025-12-02 00:08:31,142 - ZeroShotPerturbation - INFO - Predicting for target: TMBIM6
2025-12-02 00:08:31,144 - ZeroShotPerturbation - INFO - Processing 505 cells in batches of 16
2025-12-02 00:08:42,927 - ZeroShotPerturbation - INFO - Target TMBIM6 - DES: 0.0000, MAE_top2k: 14.9170, n_DE: 39
2025-12-02 00:08:42,927 - ZeroShotPerturbation - INFO - Predicting for target: PMEL
2025-12-02 00:08:42,929 - ZeroShotPerturbation - INFO - Processing 356 cells in batches of 16
2025-12-02 00:08:51,267 - ZeroShotPerturbation - INFO - Target PMEL - DES: 0.0000, MAE_top2k: 13.5148, n_DE: 63
2025-12-02 00:08:51,267 - ZeroShotPerturbation - INFO - Predicting for target: DAXX
2025-12-02 00:08:51,269 - ZeroShotPerturbation - INFO - Processing 1332 cells in batches of 16
2025-12-02 00:09:22,365 - ZeroShotPerturbation - INFO - Target DAXX - DES: 0.0926, MAE_top2k: 13.4340, n_DE: 940
2025-12-02 00:09:22,366 - ZeroShotPerturbation - INFO - Predicting for target: METTL14
2025-12-02 00:09:22,369 - ZeroShotPerturbation - INFO - Processing 468 cells in batches of 16
2025-12-02 00:09:33,361 - ZeroShotPerturbation - INFO - Target METTL14 - DES: 0.7081, MAE_top2k: 11.4023, n_DE: 9622
2025-12-02 00:09:33,362 - ZeroShotPerturbation - INFO - Predicting for target: MAU2
2025-12-02 00:09:33,364 - ZeroShotPerturbation - INFO - Processing 1021 cells in batches of 16
2025-12-02 00:09:56,923 - ZeroShotPerturbation - INFO - Target MAU2 - DES: 0.5357, MAE_top2k: 12.5597, n_DE: 6853
2025-12-02 00:09:56,923 - ZeroShotPerturbation - INFO - Predicting for target: NDUFB4
2025-12-02 00:09:56,926 - ZeroShotPerturbation - INFO - Processing 1413 cells in batches of 16
2025-12-02 00:10:29,792 - ZeroShotPerturbation - INFO - Target NDUFB4 - DES: 0.0906, MAE_top2k: 14.6282, n_DE: 993
2025-12-02 00:10:29,793 - ZeroShotPerturbation - INFO - Predicting for target: KDM1A
2025-12-02 00:10:29,795 - ZeroShotPerturbation - INFO - Processing 352 cells in batches of 16
2025-12-02 00:10:37,921 - ZeroShotPerturbation - INFO - Target KDM1A - DES: 0.7344, MAE_top2k: 10.9196, n_DE: 10193
2025-12-02 00:10:37,921 - ZeroShotPerturbation - INFO - Predicting for target: TXNDC9
2025-12-02 00:10:37,924 - ZeroShotPerturbation - INFO - Processing 514 cells in batches of 16
2025-12-02 00:10:49,875 - ZeroShotPerturbation - INFO - Target TXNDC9 - DES: 0.0766, MAE_top2k: 14.6261, n_DE: 862
2025-12-02 00:10:49,875 - ZeroShotPerturbation - INFO - Predicting for target: CALM3
2025-12-02 00:10:49,877 - ZeroShotPerturbation - INFO - Processing 681 cells in batches of 16
2025-12-02 00:11:05,626 - ZeroShotPerturbation - INFO - Target CALM3 - DES: 0.0000, MAE_top2k: 17.1549, n_DE: 4
2025-12-02 00:11:05,627 - ZeroShotPerturbation - INFO - Predicting for target: C1QBP
2025-12-02 00:11:05,629 - ZeroShotPerturbation - INFO - Processing 711 cells in batches of 16
2025-12-02 00:11:22,174 - ZeroShotPerturbation - INFO - Target C1QBP - DES: 0.4076, MAE_top2k: 14.1853, n_DE: 3221
2025-12-02 00:11:22,175 - ZeroShotPerturbation - INFO - Predicting for target: MBTPS1
2025-12-02 00:11:22,178 - ZeroShotPerturbation - INFO - Processing 626 cells in batches of 16
2025-12-02 00:11:36,818 - ZeroShotPerturbation - INFO - Target MBTPS1 - DES: 0.3835, MAE_top2k: 13.1771, n_DE: 3452
2025-12-02 00:11:36,818 - ZeroShotPerturbation - INFO - Predicting for target: ZNF562
2025-12-02 00:11:36,820 - ZeroShotPerturbation - INFO - Processing 418 cells in batches of 16
2025-12-02 00:11:46,557 - ZeroShotPerturbation - INFO - Target ZNF562 - DES: 0.0400, MAE_top2k: 13.5239, n_DE: 25
2025-12-02 00:11:46,558 - ZeroShotPerturbation - INFO - Predicting for target: PHF10
2025-12-02 00:11:46,560 - ZeroShotPerturbation - INFO - Processing 450 cells in batches of 16
2025-12-02 00:11:57,002 - ZeroShotPerturbation - INFO - Target PHF10 - DES: 0.0991, MAE_top2k: 13.5459, n_DE: 858
2025-12-02 00:11:57,002 - ZeroShotPerturbation - INFO - Predicting for target: FDPS
2025-12-02 00:11:57,004 - ZeroShotPerturbation - INFO - Processing 154 cells in batches of 16
2025-12-02 00:12:00,584 - ZeroShotPerturbation - INFO - Target FDPS - DES: 0.3851, MAE_top2k: 14.5775, n_DE: 2607
2025-12-02 00:12:00,584 - ZeroShotPerturbation - INFO - Predicting for target: OXA1L
2025-12-02 00:12:00,586 - ZeroShotPerturbation - INFO - Processing 63 cells in batches of 16
2025-12-02 00:12:02,019 - ZeroShotPerturbation - INFO - Target OXA1L - DES: 0.0952, MAE_top2k: 12.8622, n_DE: 735
2025-12-02 00:12:02,068 - ZeroShotPerturbation - INFO - Results saved to results/scgpt_zeroshot/perturbation_metrics.csv
2025-12-02 00:12:02,069 - ZeroShotPerturbation - INFO - ==================================================
2025-12-02 00:12:02,069 - ZeroShotPerturbation - INFO - Overall Metrics:
2025-12-02 00:12:02,069 - ZeroShotPerturbation - INFO -   nPDS (normalized):     0.5167
2025-12-02 00:12:02,069 - ZeroShotPerturbation - INFO -   Mean DES:              0.2062
2025-12-02 00:12:02,069 - ZeroShotPerturbation - INFO -   Mean MAE_top2k:        13.5427
2025-12-02 00:12:02,069 - ZeroShotPerturbation - INFO - ==================================================
Experiment complete. Results saved to paths defined in config.
