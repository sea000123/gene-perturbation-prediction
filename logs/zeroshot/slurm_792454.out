Activating conda environment 'vcc'...
Starting Zero-Shot Perturbation Experiment...
Date: Tue 02 Dec 2025 12:06:24 AM CST
Config: src/configs/config.yaml
2025-12-02 00:06:35,550 - ZeroShotPerturbation - INFO - Starting Perturbation Pipeline with baseline model
2025-12-02 00:06:35,550 - ZeroShotPerturbation - INFO - Model directory: model/scGPT
2025-12-02 00:06:35,550 - ZeroShotPerturbation - INFO - Results will be saved to: results/baseline
2025-12-02 00:06:35,550 - ZeroShotPerturbation - INFO - Initializing Baseline Model Wrapper...
2025-12-02 00:06:35,675 - ZeroShotPerturbation - INFO - Loaded vocab from model/scGPT/vocab.json
2025-12-02 00:06:35,675 - ZeroShotPerturbation - INFO - Initializing Data Loader...
2025-12-02 00:06:35,675 - ZeroShotPerturbation - INFO - Loading training data from data/processed/train.h5ad
2025-12-02 00:06:54,209 - ZeroShotPerturbation - INFO - Loading test data from data/processed/test.h5ad
2025-12-02 00:06:57,343 - ZeroShotPerturbation - INFO - Found 38176 control cells.
2025-12-02 00:07:01,411 - ZeroShotPerturbation - INFO - Processing 30 target genes...
2025-12-02 00:07:01,412 - ZeroShotPerturbation - INFO - Predicting for target: AKT2
2025-12-02 00:07:01,414 - ZeroShotPerturbation - INFO - Processing 938 cells in batches of 16
2025-12-02 00:07:13,201 - ZeroShotPerturbation - INFO - Target AKT2 - DES: 0.0000, MAE_top2k: 0.5517, n_DE: 376
2025-12-02 00:07:13,201 - ZeroShotPerturbation - INFO - Predicting for target: MAP3K7
2025-12-02 00:07:13,204 - ZeroShotPerturbation - INFO - Processing 2019 cells in batches of 16
2025-12-02 00:07:39,477 - ZeroShotPerturbation - INFO - Target MAP3K7 - DES: 0.0000, MAE_top2k: 0.2434, n_DE: 79
2025-12-02 00:07:39,477 - ZeroShotPerturbation - INFO - Predicting for target: ZNF426
2025-12-02 00:07:39,479 - ZeroShotPerturbation - INFO - Processing 1132 cells in batches of 16
2025-12-02 00:07:54,169 - ZeroShotPerturbation - INFO - Target ZNF426 - DES: 0.0000, MAE_top2k: 0.2389, n_DE: 14
2025-12-02 00:07:54,169 - ZeroShotPerturbation - INFO - Predicting for target: DNMT1
2025-12-02 00:07:54,172 - ZeroShotPerturbation - INFO - Processing 893 cells in batches of 16
2025-12-02 00:08:05,710 - ZeroShotPerturbation - INFO - Target DNMT1 - DES: 0.0000, MAE_top2k: 2.3406, n_DE: 8249
2025-12-02 00:08:05,711 - ZeroShotPerturbation - INFO - Predicting for target: SRC
2025-12-02 00:08:05,713 - ZeroShotPerturbation - INFO - Processing 2403 cells in batches of 16
2025-12-02 00:08:36,756 - ZeroShotPerturbation - INFO - Target SRC - DES: 0.0000, MAE_top2k: 0.3432, n_DE: 273
2025-12-02 00:08:36,756 - ZeroShotPerturbation - INFO - Predicting for target: MED13
2025-12-02 00:08:36,759 - ZeroShotPerturbation - INFO - Processing 2787 cells in batches of 16
2025-12-02 00:09:12,634 - ZeroShotPerturbation - INFO - Target MED13 - DES: 0.0000, MAE_top2k: 0.9132, n_DE: 4275
2025-12-02 00:09:12,635 - ZeroShotPerturbation - INFO - Predicting for target: KDR
2025-12-02 00:09:12,638 - ZeroShotPerturbation - INFO - Processing 2056 cells in batches of 16
2025-12-02 00:09:38,981 - ZeroShotPerturbation - INFO - Target KDR - DES: 0.0000, MAE_top2k: 0.2010, n_DE: 20
2025-12-02 00:09:38,981 - ZeroShotPerturbation - INFO - Predicting for target: EIF4B
2025-12-02 00:09:38,984 - ZeroShotPerturbation - INFO - Processing 1585 cells in batches of 16
2025-12-02 00:09:59,497 - ZeroShotPerturbation - INFO - Target EIF4B - DES: 0.0000, MAE_top2k: 1.1665, n_DE: 4546
2025-12-02 00:09:59,498 - ZeroShotPerturbation - INFO - Predicting for target: SIX4
2025-12-02 00:09:59,500 - ZeroShotPerturbation - INFO - Processing 642 cells in batches of 16
2025-12-02 00:10:07,907 - ZeroShotPerturbation - INFO - Target SIX4 - DES: 0.0000, MAE_top2k: 0.4926, n_DE: 114
2025-12-02 00:10:07,908 - ZeroShotPerturbation - INFO - Predicting for target: TFAM
2025-12-02 00:10:07,910 - ZeroShotPerturbation - INFO - Processing 1105 cells in batches of 16
2025-12-02 00:10:22,263 - ZeroShotPerturbation - INFO - Target TFAM - DES: 0.0000, MAE_top2k: 1.3606, n_DE: 3927
2025-12-02 00:10:22,263 - ZeroShotPerturbation - INFO - Predicting for target: MAST2
2025-12-02 00:10:22,266 - ZeroShotPerturbation - INFO - Processing 1029 cells in batches of 16
2025-12-02 00:10:35,547 - ZeroShotPerturbation - INFO - Target MAST2 - DES: 0.0000, MAE_top2k: 0.3315, n_DE: 22
2025-12-02 00:10:35,547 - ZeroShotPerturbation - INFO - Predicting for target: SMAGP
2025-12-02 00:10:35,550 - ZeroShotPerturbation - INFO - Processing 788 cells in batches of 16
2025-12-02 00:10:45,843 - ZeroShotPerturbation - INFO - Target SMAGP - DES: 0.0000, MAE_top2k: 0.8473, n_DE: 879
2025-12-02 00:10:45,843 - ZeroShotPerturbation - INFO - Predicting for target: XRCC4
2025-12-02 00:10:45,846 - ZeroShotPerturbation - INFO - Processing 591 cells in batches of 16
2025-12-02 00:10:53,360 - ZeroShotPerturbation - INFO - Target XRCC4 - DES: 0.0000, MAE_top2k: 1.0009, n_DE: 1031
2025-12-02 00:10:53,360 - ZeroShotPerturbation - INFO - Predicting for target: HMGN1
2025-12-02 00:10:53,363 - ZeroShotPerturbation - INFO - Processing 2004 cells in batches of 16
2025-12-02 00:11:19,308 - ZeroShotPerturbation - INFO - Target HMGN1 - DES: 0.0000, MAE_top2k: 0.3157, n_DE: 13
2025-12-02 00:11:19,309 - ZeroShotPerturbation - INFO - Predicting for target: GSK3B
2025-12-02 00:11:19,311 - ZeroShotPerturbation - INFO - Processing 1059 cells in batches of 16
2025-12-02 00:11:32,986 - ZeroShotPerturbation - INFO - Target GSK3B - DES: 0.0000, MAE_top2k: 1.0076, n_DE: 2119
2025-12-02 00:11:32,986 - ZeroShotPerturbation - INFO - Predicting for target: TMBIM6
2025-12-02 00:11:32,989 - ZeroShotPerturbation - INFO - Processing 505 cells in batches of 16
2025-12-02 00:11:39,444 - ZeroShotPerturbation - INFO - Target TMBIM6 - DES: 0.0000, MAE_top2k: 0.5069, n_DE: 21
2025-12-02 00:11:39,445 - ZeroShotPerturbation - INFO - Predicting for target: PMEL
2025-12-02 00:11:39,447 - ZeroShotPerturbation - INFO - Processing 356 cells in batches of 16
2025-12-02 00:11:44,133 - ZeroShotPerturbation - INFO - Target PMEL - DES: 0.0000, MAE_top2k: 0.5432, n_DE: 32
2025-12-02 00:11:44,133 - ZeroShotPerturbation - INFO - Predicting for target: DAXX
2025-12-02 00:11:44,136 - ZeroShotPerturbation - INFO - Processing 1332 cells in batches of 16
2025-12-02 00:12:01,466 - ZeroShotPerturbation - INFO - Target DAXX - DES: 0.0000, MAE_top2k: 0.5702, n_DE: 694
2025-12-02 00:12:01,466 - ZeroShotPerturbation - INFO - Predicting for target: METTL14
2025-12-02 00:12:01,468 - ZeroShotPerturbation - INFO - Processing 468 cells in batches of 16
2025-12-02 00:12:07,464 - ZeroShotPerturbation - INFO - Target METTL14 - DES: 0.0000, MAE_top2k: 4.9792, n_DE: 9350
2025-12-02 00:12:07,464 - ZeroShotPerturbation - INFO - Predicting for target: MAU2
2025-12-02 00:12:07,467 - ZeroShotPerturbation - INFO - Processing 1021 cells in batches of 16
2025-12-02 00:12:20,515 - ZeroShotPerturbation - INFO - Target MAU2 - DES: 0.0000, MAE_top2k: 2.3998, n_DE: 6903
2025-12-02 00:12:20,515 - ZeroShotPerturbation - INFO - Predicting for target: NDUFB4
2025-12-02 00:12:20,517 - ZeroShotPerturbation - INFO - Processing 1413 cells in batches of 16
2025-12-02 00:12:38,466 - ZeroShotPerturbation - INFO - Target NDUFB4 - DES: 0.0000, MAE_top2k: 0.6864, n_DE: 950
2025-12-02 00:12:38,466 - ZeroShotPerturbation - INFO - Predicting for target: KDM1A
2025-12-02 00:12:38,468 - ZeroShotPerturbation - INFO - Processing 352 cells in batches of 16
2025-12-02 00:12:42,811 - ZeroShotPerturbation - INFO - Target KDM1A - DES: 0.0000, MAE_top2k: 6.0293, n_DE: 10354
2025-12-02 00:12:42,811 - ZeroShotPerturbation - INFO - Predicting for target: TXNDC9
2025-12-02 00:12:42,814 - ZeroShotPerturbation - INFO - Processing 514 cells in batches of 16
2025-12-02 00:12:49,457 - ZeroShotPerturbation - INFO - Target TXNDC9 - DES: 0.0000, MAE_top2k: 1.2640, n_DE: 967
2025-12-02 00:12:49,457 - ZeroShotPerturbation - INFO - Predicting for target: CALM3
2025-12-02 00:12:49,460 - ZeroShotPerturbation - INFO - Processing 681 cells in batches of 16
2025-12-02 00:12:58,141 - ZeroShotPerturbation - INFO - Target CALM3 - DES: 0.0000, MAE_top2k: 0.8808, n_DE: 116
2025-12-02 00:12:58,142 - ZeroShotPerturbation - INFO - Predicting for target: C1QBP
2025-12-02 00:12:58,144 - ZeroShotPerturbation - INFO - Processing 711 cells in batches of 16
2025-12-02 00:13:07,302 - ZeroShotPerturbation - INFO - Target C1QBP - DES: 0.0000, MAE_top2k: 1.4214, n_DE: 3227
2025-12-02 00:13:07,302 - ZeroShotPerturbation - INFO - Predicting for target: MBTPS1
2025-12-02 00:13:07,305 - ZeroShotPerturbation - INFO - Processing 626 cells in batches of 16
2025-12-02 00:13:15,417 - ZeroShotPerturbation - INFO - Target MBTPS1 - DES: 0.0000, MAE_top2k: 2.2770, n_DE: 4567
2025-12-02 00:13:15,417 - ZeroShotPerturbation - INFO - Predicting for target: ZNF562
2025-12-02 00:13:15,419 - ZeroShotPerturbation - INFO - Processing 418 cells in batches of 16
2025-12-02 00:13:20,748 - ZeroShotPerturbation - INFO - Target ZNF562 - DES: 0.0000, MAE_top2k: 0.4248, n_DE: 18
2025-12-02 00:13:20,748 - ZeroShotPerturbation - INFO - Predicting for target: PHF10
2025-12-02 00:13:20,751 - ZeroShotPerturbation - INFO - Processing 450 cells in batches of 16
2025-12-02 00:13:26,596 - ZeroShotPerturbation - INFO - Target PHF10 - DES: 0.0000, MAE_top2k: 1.0968, n_DE: 1022
2025-12-02 00:13:26,596 - ZeroShotPerturbation - INFO - Predicting for target: FDPS
2025-12-02 00:13:26,598 - ZeroShotPerturbation - INFO - Processing 154 cells in batches of 16
2025-12-02 00:13:28,575 - ZeroShotPerturbation - INFO - Target FDPS - DES: 0.0000, MAE_top2k: 3.1995, n_DE: 1787
2025-12-02 00:13:28,575 - ZeroShotPerturbation - INFO - Predicting for target: OXA1L
2025-12-02 00:13:28,577 - ZeroShotPerturbation - INFO - Processing 63 cells in batches of 16
2025-12-02 00:13:29,334 - ZeroShotPerturbation - INFO - Target OXA1L - DES: 0.0000, MAE_top2k: 3.4834, n_DE: 1174
2025-12-02 00:13:29,368 - ZeroShotPerturbation - INFO - Results saved to results/baseline/perturbation_metrics.csv
2025-12-02 00:13:29,369 - ZeroShotPerturbation - INFO - ==================================================
2025-12-02 00:13:29,369 - ZeroShotPerturbation - INFO - Overall Metrics:
2025-12-02 00:13:29,369 - ZeroShotPerturbation - INFO -   nPDS (normalized):     0.4489
2025-12-02 00:13:29,369 - ZeroShotPerturbation - INFO -   Mean DES:              0.0000
2025-12-02 00:13:29,369 - ZeroShotPerturbation - INFO -   Mean MAE_top2k:        1.3706
2025-12-02 00:13:29,369 - ZeroShotPerturbation - INFO - ==================================================
Experiment complete. Results saved to paths defined in config.
