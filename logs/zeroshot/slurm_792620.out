2025-12-02 21:59:49,484 - ZeroShotPerturbation - INFO - Starting Perturbation Pipeline with baseline model
2025-12-02 21:59:49,484 - ZeroShotPerturbation - INFO - Model directory: model/scGPT
2025-12-02 21:59:49,484 - ZeroShotPerturbation - INFO - Results will be saved to: results/baseline
2025-12-02 21:59:49,484 - ZeroShotPerturbation - INFO - Initializing Baseline Model Wrapper...
2025-12-02 21:59:49,644 - ZeroShotPerturbation - INFO - Loaded vocab from model/scGPT/vocab.json
2025-12-02 21:59:49,644 - ZeroShotPerturbation - INFO - Initializing Data Loader...
2025-12-02 21:59:49,644 - ZeroShotPerturbation - INFO - Loading training data from data/processed/train.h5ad
2025-12-02 22:00:03,522 - ZeroShotPerturbation - INFO - Loading test data from data/processed/test.h5ad
2025-12-02 22:00:06,371 - ZeroShotPerturbation - INFO - Found 38176 control cells.
2025-12-02 22:00:06,372 - ZeroShotPerturbation - INFO - Fitting baseline model on training data...
2025-12-02 22:00:06,372 - ZeroShotPerturbation - INFO - Fitting baseline from AnnData: computing mean perturbed expression...
2025-12-02 22:00:26,981 - ZeroShotPerturbation - INFO - Baseline fitted: mean expression computed from 153002 perturbed samples, 18080 genes
2025-12-02 22:00:35,233 - ZeroShotPerturbation - INFO - Processing 30 target genes...
2025-12-02 22:00:35,234 - ZeroShotPerturbation - INFO - Predicting for target: AKT2
2025-12-02 22:00:35,240 - ZeroShotPerturbation - INFO - Processing 938 cells in batches of 16
2025-12-02 22:00:51,671 - ZeroShotPerturbation - INFO - Target AKT2 - DES: 0.0000, MAE_top2k: 0.0631, n_DE: 300
2025-12-02 22:00:51,671 - ZeroShotPerturbation - INFO - Predicting for target: MAP3K7
2025-12-02 22:00:51,674 - ZeroShotPerturbation - INFO - Processing 2019 cells in batches of 16
2025-12-02 22:01:24,254 - ZeroShotPerturbation - INFO - Target MAP3K7 - DES: 0.0000, MAE_top2k: 0.0356, n_DE: 55
2025-12-02 22:01:24,254 - ZeroShotPerturbation - INFO - Predicting for target: ZNF426
2025-12-02 22:01:24,257 - ZeroShotPerturbation - INFO - Processing 1132 cells in batches of 16
2025-12-02 22:01:40,420 - ZeroShotPerturbation - INFO - Target ZNF426 - DES: 0.0000, MAE_top2k: 0.0284, n_DE: 14
2025-12-02 22:01:40,420 - ZeroShotPerturbation - INFO - Predicting for target: DNMT1
2025-12-02 22:01:40,423 - ZeroShotPerturbation - INFO - Processing 893 cells in batches of 16
2025-12-02 22:01:54,894 - ZeroShotPerturbation - INFO - Target DNMT1 - DES: 0.3414, MAE_top2k: 0.2786, n_DE: 8485
2025-12-02 22:01:54,894 - ZeroShotPerturbation - INFO - Predicting for target: SRC
2025-12-02 22:01:54,898 - ZeroShotPerturbation - INFO - Processing 2403 cells in batches of 16
2025-12-02 22:02:37,604 - ZeroShotPerturbation - INFO - Target SRC - DES: 0.0000, MAE_top2k: 0.0275, n_DE: 240
2025-12-02 22:02:37,605 - ZeroShotPerturbation - INFO - Predicting for target: MED13
2025-12-02 22:02:37,609 - ZeroShotPerturbation - INFO - Processing 2787 cells in batches of 16
2025-12-02 22:03:36,518 - ZeroShotPerturbation - INFO - Target MED13 - DES: 0.0596, MAE_top2k: 0.0838, n_DE: 4393
2025-12-02 22:03:36,518 - ZeroShotPerturbation - INFO - Predicting for target: KDR
2025-12-02 22:03:36,525 - ZeroShotPerturbation - INFO - Processing 2056 cells in batches of 16
2025-12-02 22:04:19,254 - ZeroShotPerturbation - INFO - Target KDR - DES: 0.0000, MAE_top2k: 0.0329, n_DE: 22
2025-12-02 22:04:19,255 - ZeroShotPerturbation - INFO - Predicting for target: EIF4B
2025-12-02 22:04:19,260 - ZeroShotPerturbation - INFO - Processing 1585 cells in batches of 16
2025-12-02 22:04:44,480 - ZeroShotPerturbation - INFO - Target EIF4B - DES: 0.0285, MAE_top2k: 0.1126, n_DE: 4353
2025-12-02 22:04:44,481 - ZeroShotPerturbation - INFO - Predicting for target: SIX4
2025-12-02 22:04:44,484 - ZeroShotPerturbation - INFO - Processing 642 cells in batches of 16
2025-12-02 22:04:53,987 - ZeroShotPerturbation - INFO - Target SIX4 - DES: 0.0000, MAE_top2k: 0.0535, n_DE: 90
2025-12-02 22:04:53,988 - ZeroShotPerturbation - INFO - Predicting for target: TFAM
2025-12-02 22:04:53,990 - ZeroShotPerturbation - INFO - Processing 1105 cells in batches of 16
2025-12-02 22:05:10,736 - ZeroShotPerturbation - INFO - Target TFAM - DES: 0.0095, MAE_top2k: 0.1084, n_DE: 3379
2025-12-02 22:05:10,736 - ZeroShotPerturbation - INFO - Predicting for target: MAST2
2025-12-02 22:05:10,740 - ZeroShotPerturbation - INFO - Processing 1029 cells in batches of 16
2025-12-02 22:05:26,299 - ZeroShotPerturbation - INFO - Target MAST2 - DES: 0.0000, MAE_top2k: 0.0384, n_DE: 23
2025-12-02 22:05:26,300 - ZeroShotPerturbation - INFO - Predicting for target: SMAGP
2025-12-02 22:05:26,303 - ZeroShotPerturbation - INFO - Processing 788 cells in batches of 16
2025-12-02 22:05:38,143 - ZeroShotPerturbation - INFO - Target SMAGP - DES: 0.0000, MAE_top2k: 0.0809, n_DE: 1037
2025-12-02 22:05:38,143 - ZeroShotPerturbation - INFO - Predicting for target: XRCC4
2025-12-02 22:05:38,146 - ZeroShotPerturbation - INFO - Processing 591 cells in batches of 16
2025-12-02 22:05:46,801 - ZeroShotPerturbation - INFO - Target XRCC4 - DES: 0.0005, MAE_top2k: 0.0899, n_DE: 1853
2025-12-02 22:05:46,801 - ZeroShotPerturbation - INFO - Predicting for target: HMGN1
2025-12-02 22:05:46,804 - ZeroShotPerturbation - INFO - Processing 2004 cells in batches of 16
2025-12-02 22:06:20,235 - ZeroShotPerturbation - INFO - Target HMGN1 - DES: 0.0000, MAE_top2k: 0.0334, n_DE: 15
2025-12-02 22:06:20,236 - ZeroShotPerturbation - INFO - Predicting for target: GSK3B
2025-12-02 22:06:20,239 - ZeroShotPerturbation - INFO - Processing 1059 cells in batches of 16
2025-12-02 22:06:36,243 - ZeroShotPerturbation - INFO - Target GSK3B - DES: 0.0068, MAE_top2k: 0.1114, n_DE: 2637
2025-12-02 22:06:36,244 - ZeroShotPerturbation - INFO - Predicting for target: TMBIM6
2025-12-02 22:06:36,247 - ZeroShotPerturbation - INFO - Processing 505 cells in batches of 16
2025-12-02 22:06:43,800 - ZeroShotPerturbation - INFO - Target TMBIM6 - DES: 0.0000, MAE_top2k: 0.0668, n_DE: 6
2025-12-02 22:06:43,801 - ZeroShotPerturbation - INFO - Predicting for target: PMEL
2025-12-02 22:06:43,804 - ZeroShotPerturbation - INFO - Processing 356 cells in batches of 16
2025-12-02 22:06:49,207 - ZeroShotPerturbation - INFO - Target PMEL - DES: 0.0000, MAE_top2k: 0.0805, n_DE: 111
2025-12-02 22:06:49,208 - ZeroShotPerturbation - INFO - Predicting for target: DAXX
2025-12-02 22:06:49,211 - ZeroShotPerturbation - INFO - Processing 1332 cells in batches of 16
2025-12-02 22:07:09,126 - ZeroShotPerturbation - INFO - Target DAXX - DES: 0.0000, MAE_top2k: 0.0563, n_DE: 780
2025-12-02 22:07:09,126 - ZeroShotPerturbation - INFO - Predicting for target: METTL14
2025-12-02 22:07:09,129 - ZeroShotPerturbation - INFO - Processing 468 cells in batches of 16
2025-12-02 22:07:16,249 - ZeroShotPerturbation - INFO - Target METTL14 - DES: 0.3173, MAE_top2k: 0.4973, n_DE: 9588
2025-12-02 22:07:16,250 - ZeroShotPerturbation - INFO - Predicting for target: MAU2
2025-12-02 22:07:16,252 - ZeroShotPerturbation - INFO - Processing 1021 cells in batches of 16
2025-12-02 22:07:31,568 - ZeroShotPerturbation - INFO - Target MAU2 - DES: 0.1666, MAE_top2k: 0.2298, n_DE: 6763
2025-12-02 22:07:31,568 - ZeroShotPerturbation - INFO - Predicting for target: NDUFB4
2025-12-02 22:07:31,571 - ZeroShotPerturbation - INFO - Processing 1413 cells in batches of 16
2025-12-02 22:07:52,990 - ZeroShotPerturbation - INFO - Target NDUFB4 - DES: 0.0000, MAE_top2k: 0.0703, n_DE: 1191
2025-12-02 22:07:52,991 - ZeroShotPerturbation - INFO - Predicting for target: KDM1A
2025-12-02 22:07:52,993 - ZeroShotPerturbation - INFO - Processing 352 cells in batches of 16
2025-12-02 22:07:58,028 - ZeroShotPerturbation - INFO - Target KDM1A - DES: 0.3577, MAE_top2k: 0.4818, n_DE: 10125
2025-12-02 22:07:58,029 - ZeroShotPerturbation - INFO - Predicting for target: TXNDC9
2025-12-02 22:07:58,031 - ZeroShotPerturbation - INFO - Processing 514 cells in batches of 16
2025-12-02 22:08:05,791 - ZeroShotPerturbation - INFO - Target TXNDC9 - DES: 0.0015, MAE_top2k: 0.0707, n_DE: 2734
2025-12-02 22:08:05,791 - ZeroShotPerturbation - INFO - Predicting for target: CALM3
2025-12-02 22:08:05,794 - ZeroShotPerturbation - INFO - Processing 681 cells in batches of 16
2025-12-02 22:08:15,827 - ZeroShotPerturbation - INFO - Target CALM3 - DES: 0.0000, MAE_top2k: 0.0796, n_DE: 3
2025-12-02 22:08:15,827 - ZeroShotPerturbation - INFO - Predicting for target: C1QBP
2025-12-02 22:08:15,830 - ZeroShotPerturbation - INFO - Processing 711 cells in batches of 16
2025-12-02 22:08:26,498 - ZeroShotPerturbation - INFO - Target C1QBP - DES: 0.0242, MAE_top2k: 0.1106, n_DE: 4549
2025-12-02 22:08:26,499 - ZeroShotPerturbation - INFO - Predicting for target: MBTPS1
2025-12-02 22:08:26,502 - ZeroShotPerturbation - INFO - Processing 626 cells in batches of 16
2025-12-02 22:08:35,797 - ZeroShotPerturbation - INFO - Target MBTPS1 - DES: 0.0097, MAE_top2k: 0.1764, n_DE: 3289
2025-12-02 22:08:35,798 - ZeroShotPerturbation - INFO - Predicting for target: ZNF562
2025-12-02 22:08:35,800 - ZeroShotPerturbation - INFO - Processing 418 cells in batches of 16
2025-12-02 22:08:42,086 - ZeroShotPerturbation - INFO - Target ZNF562 - DES: 0.0000, MAE_top2k: 0.0499, n_DE: 18
2025-12-02 22:08:42,086 - ZeroShotPerturbation - INFO - Predicting for target: PHF10
2025-12-02 22:08:42,089 - ZeroShotPerturbation - INFO - Processing 450 cells in batches of 16
2025-12-02 22:08:48,714 - ZeroShotPerturbation - INFO - Target PHF10 - DES: 0.0009, MAE_top2k: 0.1028, n_DE: 1130
2025-12-02 22:08:48,715 - ZeroShotPerturbation - INFO - Predicting for target: FDPS
2025-12-02 22:08:48,718 - ZeroShotPerturbation - INFO - Processing 154 cells in batches of 16
2025-12-02 22:08:50,842 - ZeroShotPerturbation - INFO - Target FDPS - DES: 0.0009, MAE_top2k: 0.2557, n_DE: 2346
2025-12-02 22:08:50,842 - ZeroShotPerturbation - INFO - Predicting for target: OXA1L
2025-12-02 22:08:50,844 - ZeroShotPerturbation - INFO - Processing 63 cells in batches of 16
2025-12-02 22:08:51,716 - ZeroShotPerturbation - INFO - Target OXA1L - DES: 0.0000, MAE_top2k: 0.2681, n_DE: 626
2025-12-02 22:08:51,764 - ZeroShotPerturbation - INFO - Results saved to results/baseline/perturbation_metrics.csv
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO - ==================================================
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO - Final Test Metrics (per eval_metrics.md Section 4.3.1):
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO -   pds_mean_rank:         15.50
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO -   pds_nrank:             0.5167
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO -   mae_top2000:           0.1258
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO -   des:                   0.0442
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-02 22:08:51,765 - ZeroShotPerturbation - INFO - Normalized Sub-Scores:
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO -   s_pds:                 0.5000
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO -   s_mae:                 0.3907
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO -   s_des:                 0.0442
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO - --------------------------------------------------
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO - Composite Metrics:
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO -   s_geo:                 0.2051
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO -   l_geo:                 0.7949
2025-12-02 22:08:51,766 - ZeroShotPerturbation - INFO - ==================================================
